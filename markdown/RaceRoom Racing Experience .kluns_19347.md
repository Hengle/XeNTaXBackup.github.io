## Post #1
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-18T22:14:45+00:00
- Post Title: RaceRoom Racing Experience .kluns

Hi! I extract .public file of RaceRoom Racing Experience  by this scirpt [https://aluigi.altervista.org/bms/raceroom.bms](https://aluigi.altervista.org/bms/raceroom.bms) . I unpacked and I saw .kluns file but I don't know how extract from this model and textures. Old script for Quick BMS only 2 file extracted. Anybody can help me?
[https://mega.nz/#!6kUDCYqC!mpGNwAporQUc ... XIZmAgXWnA](https://mega.nz/#!6kUDCYqC!mpGNwAporQUceQ7WfYUIfqzLUJjKCctuJXIZmAgXWnA)
## Post #2
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-18T22:56:36+00:00
- Post Title: RaceRoom Racing Experience .kluns

maybe tomorrow;



steeringWheel.png (65.38 KiB) Viewed 610 times
## Post #3
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-19T10:19:02+00:00
- Post Title: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> maybe tomorrow;
steeringWheel.png
awesome news!
## Post #4
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-20T08:22:21+00:00
- Post Title: RaceRoom Racing Experience .kluns

about 85 single parts - I'll create a tool for it sooner or later:



bumper.png (33.95 KiB) Viewed 592 times
## Post #5
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-20T08:33:29+00:00
- Post Title: RaceRoom Racing Experience .kluns

chassis:



chassis.png (68.37 KiB) Viewed 592 times



some strings:

/specialfx/default_gravel_particle_emitter*
/specialfx/default_tarmac_particle_emitter)
/specialfx/default_grass_particle_emitter'
/specialfx/car/front_waterspray_emitter,
/specialfx/default_tarmac_tiremark_generator+
/specialfx/default_grass_tiremark_generator,
/specialfx/default_gravel_tiremark_generator)
/specialfx/default_wet_tiremark_generator2
/specialfx/default_tarmac_particle_wheel_attractor 

front_left, front_right
rear_left, rear_right

/cars/car_models/porsche/porsche_934turborsr/banger_spawnerJ
- /high_detail/rotatable_manager@
- /backfire_controllerC
- /car_effects_controller)

/specialfx/default_gravel_particle_system)
/specialfx/default_tarmac_particle_system
/specialfx/car/debris_system
/specialfx/car/spark_system&
/specialfx/car/front_waterspray_system%
/specialfx/car/rear_waterspray_system(
/specialfx/default_grass_particle_system#
/specialfx/car/exhaust_smoke_system!
/specialfx/car/black_smoke_system!
/specialfx/car/white_smoke_system
/specialfx/car/debris_emitter
/specialfx/car/spark_emitter#
/specialfx/car/exhaust_left_emitter$
/specialfx/car/exhaust_right_emitter)
/specialfx/car/engine_white_smoke_emitter)
/specialfx/car/engine_black_smoke_emitter>
/specialfx/default_tarmac_particle_turbulent_airflow_attractor

/cars/car_models/porsche/porsche_934turborsr/contact_shadow
- /high_detail/one_model
/cars/lod/lod_manager_type1d

engine

exhaust_left, exhaust_right
wiperl_locator, wiperr_locator

/animation/models/drivers/porsche_934turborsr_lp_driver9
/animation/sequencers/drivers/outside_view/default_paddle=
/cars/car_models/porsche/porsche_934turborsr/car_generic_data
## Post #6
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-20T17:23:14+00:00
- Post Title: RaceRoom Racing Experience .kluns

Brilliant news! Here is other files (interior, skins and template) in .kluns files: [https://mega.nz/#!CwVAkaAT!ViGA6SvVhufu ... Twv5Z-akR0](https://mega.nz/#!CwVAkaAT!ViGA6SvVhufueDaWfQY68_gFSw6P1L-wgTwv5Z-akR0)
## Post #7
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T04:06:00+00:00
- Post Title: RaceRoom Racing Experience .kluns

some news?
## Post #8
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-23T12:21:06+00:00
- Post Title: RaceRoom Racing Experience .kluns

need another kluns sample (I won't download 350 MB for it, sorry)



kluns wip.jpg (170.38 KiB) Viewed 557 times
## Post #9
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-23T17:28:47+00:00
- Post Title: RaceRoom Racing Experience .kluns

Okay I understood. Other exaples (I uploaded on Mediafire and Mega this same files):
BMW 635:
[http://www.mediafire.com/file/w33sazw6a ... 5.rar/file](http://www.mediafire.com/file/w33sazw6aiahzk2/635.rar/file)
[https://mega.nz/#!PssgQKJR!uWkOyTLhTXRf ... JsEsq4dZ-w](https://mega.nz/#!PssgQKJR!uWkOyTLhTXRfKkM1k2dbYZAx4wDFOExJDJsEsq4dZ-w)
Citroen C-Elysee:
[http://www.mediafire.com/file/f1vj8ozv0 ... e.rar/file](http://www.mediafire.com/file/f1vj8ozv0nclg5h/c-elysee.rar/file)
[https://mega.nz/#!Sw1X2CJS!EPgCz9qOA506 ... V_GwLQrghQ](https://mega.nz/#!Sw1X2CJS!EPgCz9qOA506smUh9GyyrpOBZi84iiYEWV_GwLQrghQ)
Porsche 934 (Interior and some skins)
[http://www.mediafire.com/file/w2m41f9p3 ... terior.rar](http://www.mediafire.com/file/w2m41f9p3r9mlpt/934+interior.rar)
[https://mega.nz/#!jwlzCC7b!MHaBf_0PUP-I ... NDqVPfv_VM](https://mega.nz/#!jwlzCC7b!MHaBf_0PUP-ImuTuDE9jF3mr58RBoaerINDqVPfv_VM)
[http://www.mediafire.com/file/4bjdukr8p ... +skins.rar](http://www.mediafire.com/file/4bjdukr8pt18y5c/934+skins.rar)
[https://mega.nz/#!P1l3DCzD!Q7hORrd0lMjb ... 7TQokOa0VY](https://mega.nz/#!P1l3DCzD!Q7hORrd0lMjb9kBHd5iqjR3fSMQLk6NV_7TQokOa0VY)
RUF CTR3:
[http://www.mediafire.com/file/1k461939w ... 3.rar/file](http://www.mediafire.com/file/1k461939wpmbneb/ctr3.rar/file)
[https://mega.nz/#!uot10KgS!qHJsxXpLZD7b ... F9K_8h0tdU](https://mega.nz/#!uot10KgS!qHJsxXpLZD7bIyOGvZ4Rg2t3rp_Y16DkrF9K_8h0tdU)
Fabcar 935:
[http://www.mediafire.com/file/gxyhgn42l ... ar+935.rar](http://www.mediafire.com/file/gxyhgn42lhjqupc/fabcar+935.rar)
[https://mega.nz/#!v1tT0azb!xfu82AQvIS0O ... LuwbeTu8nk](https://mega.nz/#!v1tT0azb!xfu82AQvIS0OiW8iO2_W54j47YiI-0lCeLuwbeTu8nk)
## Post #10
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2019-01-23T18:51:27+00:00
- Post Title: RaceRoom Racing Experience .kluns

here is bms script to scan and rip the dds files from the *.kluns samples.  

```

get FOLDER basename
math i = 1 
findloc OFFSET binary "\x44\x44\x53\x20"
do
    math OFFSET - 4
    goto OFFSET
    get SIZE long
    savepos OFFSET
    string NAME p "%s\%d.dds" FOLDER i
    log NAME OFFSET SIZE
    math i + 1
    math OFFSET + SIZE
    goto OFFSET
    findloc OFFSET binary "\x44\x44\x53\x20" 0 ""
while OFFSET != ""

```

they are named in the order they are ripped, the names are actually stored
in the kluns files but i have not figured out how to find and link them all together.
## Post #11
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T19:39:42+00:00
- Post Title: RaceRoom Racing Experience .kluns

> Reply from Acewell
>
> here is bms script to scan and rip the dds files from the *.kluns samples.  
Code: Select all# script for QuickBMS http://aluigi.altervista.org/quickbms.htm

get FOLDER basename
math i = 1 
findloc OFFSET binary "\x44\x44\x53\x20"
do
    math OFFSET - 4
    goto OFFSET
    get SIZE long
    savepos OFFSET
    string NAME p "%s\%d.dds" FOLDER i
    log NAME OFFSET SIZE
    math i + 1
    math OFFSET + SIZE
    goto OFFSET
    findloc OFFSET binary "\x44\x44\x53\x20" 0 ""
while OFFSET != ""

they are named in the order they are ripped, the names are actually stored
in the kluns files but i have not figured out how to find and link them all together.

Sorry...work With all file.kluns?
## Post #12
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T19:51:35+00:00
- Post Title: RaceRoom Racing Experience .kluns

> Reply from Acewell
>
> here is bms script to scan and rip the dds files from the *.kluns samples.  
Code: Select all# script for QuickBMS http://aluigi.altervista.org/quickbms.htm

get FOLDER basename
math i = 1 
findloc OFFSET binary "\x44\x44\x53\x20"
do
    math OFFSET - 4
    goto OFFSET
    get SIZE long
    savepos OFFSET
    string NAME p "%s\%d.dds" FOLDER i
    log NAME OFFSET SIZE
    math i + 1
    math OFFSET + SIZE
    goto OFFSET
    findloc OFFSET binary "\x44\x44\x53\x20" 0 ""
while OFFSET != ""

they are named in the order they are ripped, the names are actually stored
in the kluns files but i have not figured out how to find and link them all together.

Ok work...i tested...but 3d model? Sorry for my english
## Post #13
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-23T19:54:34+00:00
- Post Title: RaceRoom Racing Experience .kluns

here's a poorely tested mesh tool, .public files not supported.
(Driver, steering wheel and driver's seat are mirrored for some unknown reason.)

Enjoy or report bugs, if any:


 Make_obj-RR RacExp.zip
(46.54 KiB) Downloaded 81 times



update:
[viewtopic.php?f=16&t=19347&p=147985&hil ... rs#p147985](http://forum.xentax.com/viewtopic.php?f=16&t=19347&p=147985&hilit=+interiors#p147985)
## Post #14
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T20:04:52+00:00
- Post Title: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> here's a poorely tested mesh tool, .public files not supported.
(Driver, steering wheel and driver's seat are mirrored for some unknown reason.)

Enjoy or report bugs, if any:
Make_obj-RR RacExp.zip

thanks for your work man  ...but don t work with biggest file...(600 mb .kluns file don t work)
## Post #15
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-23T20:27:01+00:00
- Post Title: RaceRoom Racing Experience .kluns

> Reply from Franc23
>
>  ...but don t work with biggest file...(600 mb .kluns file don t work)I won't download such big files, sry, so I can't test them. (Don't be too greedy, hehehe. )



citr1.jpg (192.64 KiB) Viewed 522 times



btw: I didn't care for the materialnames, there are too many strings to find and check in the .kluns file. I'm too busy with other projects.
## Post #16
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T20:42:49+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> Franc23 wrote: ...but don t work with biggest file...(600 mb .kluns file don t work)I won't download such big files, sry, so I can't test them. (Don't be too greedy, hehehe. )
citr1.jpg

btw: I didn't care for the materialnames, there are too many strings to find and check in the .kluns file. I'm too busy with other projects.

Ok man  ....
Is there a way to change to make it work?
## Post #17
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-23T20:45:42+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Franc23
>
> shakotay2 wrote:Franc23 wrote: ...but don t work with biggest file...(600 mb .kluns file don t work)I won't download such big files, sry, so I can't test them. (Don't be too greedy, hehehe. )
citr1.jpg

btw: I didn't care for the materialnames, there are too many strings to find and check in the .kluns file. I'm too busy with other projects.

Ok man  ....
Is there a way to change some value in file of tool to make it work?
## Post #18
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-23T21:07:08+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> here's a poorely tested mesh tool, .public files not supported.
(Driver, steering wheel and driver's seat are mirrored for some unknown reason.)

Enjoy or report bugs, if any:
Make_obj-RR RacExp.zip
What a great day in game modding! Thanks guys! I hope will soon decompre Project Cars 2, Need For Speed No Limits and export game files from FH4 will be possible.
## Post #19
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-24T09:22:14+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Franc23
>
> Is there a way to change to make it work?If, and only if, the file contains "system" at its file offset 0x000010 you can cut the first 50 MB block from your 600 MB file using a hex editor: start offset 0x000000 to 0x2FAF080, size: 50000000 bytes
and try to load it into make_obj.
## Post #20
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-24T11:26:39+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> Franc23 wrote:Is there a way to change to make it work? If, and only if, the file contains "system" at its file offset 0x000010 you can cut the first 50 MB block from your 600 MB file using a hex editor: start offset 0x000000 to 0x2FAF080, size: 50000000 bytes
and try to load it into make_obj.

Ok thanks ,
I have hex editor but o don t have experience  
I try to load when go to my home
## Post #21
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-24T12:03:49+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> Franc23 wrote:Is there a way to change to make it work? If, and only if, the file contains "system" at its file offset 0x000010 you can cut the first 50 MB block from your 600 MB file using a hex editor: start offset 0x000000 to 0x2FAF080, size: 50000000 bytes
and try to load it into make_obj.

I tried ... message: too Many FI blocks....
## Post #22
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-24T13:31:04+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

try less MBs, start with 10 MB then try 20 MB.
## Post #23
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-24T14:59:06+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> try less MBs, start with 10 MB then try 20 MB.

ok when i can load, cut off remaining files? now i'm at work ... i try later ...
## Post #24
- Username: djibsone2
- Rank: beginner
- Number of posts: 21
- Joined date: Wed Dec 21, 2016 10:15 am
- Post datetime: 2019-01-24T17:25:34+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25
>
> Okay I understood. Other exaples (I uploaded on Mediafire and Mega this same files):
BMW 635:
http://www.mediafire.com/file/w33sazw6a ... 5.rar/file
https://mega.nz/#!PssgQKJR!uWkOyTLhTXRf ... JsEsq4dZ-w
Citroen C-Elysee:
http://www.mediafire.com/file/f1vj8ozv0 ... e.rar/file
https://mega.nz/#!Sw1X2CJS!EPgCz9qOA506 ... V_GwLQrghQ
Porsche 934 (Interior and some skins)
http://www.mediafire.com/file/w2m41f9p3 ... terior.rar
https://mega.nz/#!jwlzCC7b!MHaBf_0PUP-I ... NDqVPfv_VM
http://www.mediafire.com/file/4bjdukr8p ... +skins.rar
https://mega.nz/#!P1l3DCzD!Q7hORrd0lMjb ... 7TQokOa0VY
RUF CTR3:
http://www.mediafire.com/file/1k461939w ... 3.rar/file
https://mega.nz/#!uot10KgS!qHJsxXpLZD7b ... F9K_8h0tdU
Fabcar 935:



big thanks amazing guy please upload the nissan silvia s110 gr5  1000  thx thx 
http://www.mediafire.com/file/gxyhgn42l ... ar+935.rar
https://mega.nz/#!v1tT0azb!xfu82AQvIS0O ... LuwbeTu8nk
## Post #25
- Username: djibsone2
- Rank: beginner
- Number of posts: 21
- Joined date: Wed Dec 21, 2016 10:15 am
- Post datetime: 2019-01-24T17:26:25+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

big thanks amazing guy please upload the nissan silvia s110 gr5 1000 thank s
## Post #26
- Username: Franc23
- Rank: n00b
- Number of posts: 11
- Joined date: Tue Jan 23, 2018 4:54 am
- Post datetime: 2019-01-24T17:52:15+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2
>
> try less MBs, start with 10 MB then try 20 MB.

I try 40,20,10, 5 , 2 mb but don t work...i don t know...i’m not experience with hex etc....i try...
## Post #27
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-24T18:27:42+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from djibsone2
>
> big thanks amazing guy please upload the nissan silvia s110 gr5 1000 thank s
I will upload all models from RaceRoom on my fan page but on this moment I didn't have time for this.
## Post #28
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-01-25T23:17:17+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Great tool.
Unfortunately some files give error and the resulting obj file can not be imported,
you have an example here, can you take a look?

[https://mega.nz/#!gBl0nYiZ!7EvTqr91b3B2 ... RCn15zGsdE](https://mega.nz/#!gBl0nYiZ!7EvTqr91b3B2-ITaDEa9RHCcJj2-HcVpfRCn15zGsdE)
## Post #29
- Username: djibsone2
- Rank: beginner
- Number of posts: 21
- Joined date: Wed Dec 21, 2016 10:15 am
- Post datetime: 2019-01-26T00:03:33+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25
>
> djibsone2 wrote:big thanks amazing guy please upload the nissan silvia s110 gr5 1000 thank s
I will upload all models from RaceRoom on my fan page but on this moment I didn't have time for this.

ok no problem gut thx
## Post #30
- Username: triebie
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Jan 23, 2019 8:15 am
- Post datetime: 2019-01-26T02:14:30+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

been waiting for this a long time, thanky you so much for this great tool!
extracting the files work like charm with all the cars i tested so far.
one thing though:
the UV mapping has to be restored manually and some parts of the cockpits are distorted 
and the UV mapping is broken.
If you could take look at that would be highly appreciated.
Keep up your amazing work!!!

Thanks again
## Post #31
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-26T08:14:22+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I've updated the zip in the post as of Wed Jan 23, 2019 8:54 pm
@portoalto: thanks for reporting; some uvs for the cockpit are missing; need to care for it when I have more time

> Reply from triebie
>
> one thing though:
the UV mapping has to be restored manuallyWhat is the problem exactly? Concerning mirrored uvs: I usually don't touch them.
There might be some scaling required for the tx coords of some submeshes, but it's always annoying to find them in data, if any.

> and some parts of the cockpits are distorted 
>
> and the UV mapping is broken.If you uploaded a sample with that error I could have a look at, but not too soon.
## Post #32
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-01-26T11:01:02+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I downloaded the version you posted on the 23rd and the errors disappeared.

Take your time.
Before you did this tool we had nothing of this game, now we have something.

Thank you
## Post #33
- Username: triebie
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Jan 23, 2019 8:15 am
- Post datetime: 2019-01-26T14:04:58+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

@Shakotay2

sorry, my fault, it´s not the UV mapping.
only some cockpit parts are distorted(see photo)

[](https://servimg.com/view/16918760/668)

what i mean is, that all faces are are shown up.
If you use some cube shaders, you have to manually adjust the lightnig angle to see the shaders correctly.
i will post some photos later to show it.
## Post #34
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-26T15:02:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

But UV mapper is destroyed in Porsche 934 interior. Check the seat. It is line.
## Post #35
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-26T16:19:36+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

yep, there's different FVFsizes, from 8 to 32 (n x 8 ), 48, 56 and 60 bytes
and for sake of simplicity I used 20 as an uv offset only (very ugly!)

But there's another caveat of different uv formats.

This is a workaround for uvs of interiors, submeshes with an FVFsize of 16 or 60 bytes:


 Make_obj-RR RacExp.zip
(67.83 KiB) Downloaded 89 times


(2nd exe fixes submeshes of Ferrari P4_5 Competizione, some uvs still broken)

Porsche 935, interior, steeringwheel uvs still broken (FVFsize=8)
## Post #36
- Username: triebie
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Jan 23, 2019 8:15 am
- Post datetime: 2019-01-26T18:16:55+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

that did the trick, perfect !!!!
THX a ton!

[](https://servimg.com/view/16918760/669)
## Post #37
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-01-30T15:51:18+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I found bug. When I tried open kluns of P4/5 I saw this message: [https://imgur.com/qqy0ljT](https://imgur.com/qqy0ljT) When I click "ok", Make_obj has been stoped. This is kluns files of P4/5: [http://www.mediafire.com/file/0643ip52d ... izione.rar](http://www.mediafire.com/file/0643ip52d5pkw8d/Ferrari+P4_5+Competizione.rar)
## Post #38
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-01-30T21:25:33+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

yeah, after submesh 26 the trouble begins 



Ferrari P4_5.jpg (206.61 KiB) Viewed 202 times


This will take some time to fix.

I don't have a clue how to detect the issue automatically.

edit: Ferrari P4_5 submeshes fixed: [viewtopic.php?f=16&t=19347&p=147985&hil ... ri#p147985](http://forum.xentax.com/viewtopic.php?f=16&t=19347&p=147985&hilit=+ferrari#p147985)
## Post #39
- Username: triebie
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Jan 23, 2019 8:15 am
- Post datetime: 2019-02-01T00:46:09+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

just to give another quick feedback.
all the cars i extracted are working perfectly!
one small bug though, the uv mapping of the lightglow meshes are distorted like the cockpit i posted earlier above.

and one question from my side:
are you further working on optimizing that tool?
it would be great to be able to rip the tracks as well, but that only makes sense if you can assign the materials and textures accordingly.

anyway, thanks again for this great little tool!
## Post #40
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-02-01T09:15:24+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from triebie
>
> all the cars i extracted are working perfectly!thanks! Good to hear. 

> one small bug though, the uv mapping of the lightglow meshes are distorted like the cockpit i posted earlier above.Which car, which submesh (SM_xx)?
(For meshes with an FVFsize of 8 or 12 didn't find the uv data so far.)

> are you further working on optimizing that tool?I'll try to fix severe bugs if any.

> it would be great to be able to rip the tracks as well,Seems tracks are too big to download for me. But maybe you could cut of the first block of about 50 MB and upload it?
## Post #41
- Username: triebie
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Jan 23, 2019 8:15 am
- Post datetime: 2019-02-02T07:33:59+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

[https://www.dropbox.com/s/7awzizy7n20dp ... 78.7z?dl=0](https://www.dropbox.com/s/7awzizy7n20dpak/peugeot308_lightglow_left_sm78.7z?dl=0)
here you have a sample from the TCR car Peufeot 308.
but it is the same for every other car.
those meshes should have the lights texture uv mapped for getting the lightglows.

about the tracks, sorry, don´t know how to cut a track into pieces and/or using a hex editor??
## Post #42
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-02-02T10:35:37+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from triebie
>
> 
those meshes should have the lights texture uv mapped for getting the lightglows.yeah, but I don't know how to solve it atm:



sm_78.png (12.07 KiB) Viewed 166 times



> about the tracks, sorry, don´t know how to cut a track into pieces and/or using a hex editor??It's simple: use a hexeditor, HxD for example, load the file, edit
select block
copy

File new
edit, paste write
then File save

or look here: [viewtopic.php?f=16&t=19347&p=147857&hil ... ck#p147857](http://forum.xentax.com/viewtopic.php?f=16&t=19347&p=147857&hilit=+block#p147857)
(ignore the "try to load it into make_obj")
## Post #43
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-22T01:40:34+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hey guys
how to decompress dds files?
## Post #44
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-22T01:42:50+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

i´m joining in this journey too......
trying to remap the dds files in 3d models


how to decompress textures files
## Post #45
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-02-23T19:20:18+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from felixthecat ↑Fri Feb 22, 2019 9:40 am at Fri Feb 22, 2019 9:40 am
>
> 
Hey guys
how to decompress dds files?

Use PVRTexTool, 3dSimEd or Photoshop with .dds plugin.
## Post #46
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-23T21:13:35+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I use
Quickbms
to decompress kluns.public files
and
X-Ripper_1.5
to search for files into kluns.public decompressed
some dds files was okay, but the most important Picture was cut about 70%
take a look and there´s a way to fix this
## Post #47
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-02-24T10:47:54+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

There is a script to use with quickbms with which you can extract the DDS textures from the kluns files. 
It works fine for me
## Post #48
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-24T20:03:41+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

yeah

i use the script...

# RaceRoom PUBLIC/IBL/JCA files (script 0.2.1)


please send me your script maybe something diferente happens this time
thx.....
## Post #49
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-02-24T23:18:22+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Here you have

[https://www.mediafire.com/file/a393ecsk ... s.bms/file](https://www.mediafire.com/file/a393ecskne57e39/Public_to_kluns.bms/file)

[https://www.mediafire.com/file/x52i577u ... s.bms/file](https://www.mediafire.com/file/x52i577ud08bttw/To_extract_DDS_from_kluns.bms/file)

Some of the textures you have to open in a program editor, such as Photoshop, and save again as DDS
## Post #50
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-26T02:55:49+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thanks
Works perfect now..........
great........
## Post #51
- Username: SinkreZ
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Thu Jan 12, 2017 11:43 pm
- Post datetime: 2019-02-26T10:34:24+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

so is it already possible to extract models from RRRE? I would love to rip one model
## Post #52
- Username: felixthecat
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Feb 22, 2019 7:38 am
- Post datetime: 2019-02-26T22:50:18+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I ripped
and save as 3ds




download 

[https://drive.google.com/open?id=1BikH6 ... SRsYkl_gpo](https://drive.google.com/open?id=1BikH6wMXSh62p05SctOqYrSRsYkl_gpo)
## Post #53
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-17T15:59:16+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Brilliant,

There is any chance to get the obj make for tracks?

i have split the track in diferent part by using hex, but without no succes to get meshes

Thanks a lot.
## Post #54
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-17T16:52:30+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I have upload a sample of the track splited and the full track.

here the links

Track splited: [https://mega.nz/#!mxUmjayZ!CmWGnTi5bstx ... 5GbhiiJ2wg](https://mega.nz/#!mxUmjayZ!CmWGnTi5bstx3kSrcgvWTCBEoePpJxFJc5GbhiiJ2wg)
Track full: [https://mega.nz/#!TwViFQhY!WhQDt84iSSln ... LSUfFZWorI](https://mega.nz/#!TwViFQhY!WhQDt84iSSlnBmQm8PClAKPdGF2lvHN0_LSUfFZWorI)

When i open the file with the make_obj, i get a message with the splited file : " This doesn't seem to be a RR racing expo .kluns file? (no ´system´at 0x10)

and with the full: error. unk file > 124 MB nicht akzeptiert...

Thank you
## Post #55
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-17T17:21:57+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Now i add the system hex to the editor and save the file again. now is don't show the system problem, but the model is not created correclty.

i get this shape.



2019-03-17_18-20.jpg (133.47 KiB) Viewed 116 times



i guess is the SM Count and FIs block count are different error message.
## Post #56
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-03-17T20:23:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from linamza ↑Sun Mar 17, 2019 11:59 pm at Sun Mar 17, 2019 11:59 pm
>
> There is any chance to get the obj make for tracks?tracks (01 at file offset 0008 in .kluns file) are not supported and I don't have the time to care for them. 

You may search for 00000000 01000000 02000000 in mid_ohio.kluns (to be found 498 times iirc), I checked one vertex/FI block:



mid_ohio_kluns.png (63.1 KiB) Viewed 114 times


FVFsize is 56 here (doesn't apply to all v blocks; found 40, too)
## Post #57
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-18T09:58:00+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi shakotay2,

I just search but I can't find any. from the original one is say the side is big.
## Post #58
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-18T10:50:47+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Mon Mar 18, 2019 4:23 am at Mon Mar 18, 2019 4:23 am
>
> 
You may search for 00000000 01000000 02000000 in mid_ohio.kluns (to be found 498 times iirc), I checked one vertex/FI block:
mid_ohio_kluns.png
FVFsize is 56 here (doesn't apply to all v blocks; found 40, too)

When you say search for 00000000 01000000 02000000, how i can do it with HxD?

When i save the .kluns for example from offset 0x0000 to 0x0007 just to save, or any others i get this error 



error_1.jpg (6.25 KiB) Viewed 100 times



Thank you
## Post #59
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-03-18T19:32:51+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from linamza ↑Mon Mar 18, 2019 6:50 pm at Mon Mar 18, 2019 6:50 pm
>
> When you say search for 00000000 01000000 02000000, how i can do it with HxD?Search/Find (Datatype: Hex-values)

> When i save the .kluns for example from offset 0x0000 to 0x0007 just to save, or any others i get this errorThe Make_obj tool does NOT support (.kluns) tracks.
## Post #60
- Username: linamza
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Fri Jun 12, 2015 7:57 am
- Post datetime: 2019-03-19T00:29:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Tue Mar 19, 2019 3:32 am at Tue Mar 19, 2019 3:32 am
>
> 
When i save the .kluns for example from offset 0x0000 to 0x0007 just to save, or any others i get this error The Make_obj tool does NOT support (.kluns) tracks.

Any chance to get them work? just the meshes for example.no Uv's for the first instance so can see how are etc...?
## Post #61
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-04-06T12:46:39+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

.kluns files was change. Bms script for textures and kluns to obj doesn't work. [https://imgur.com/Bh54eJk](https://imgur.com/Bh54eJk)
New samples:
[https://mega.nz/#!jkl03IZb!hj51LYulvFyd ... WcNCCySQt0](https://mega.nz/#!jkl03IZb!hj51LYulvFydbo1HIsIlvZ8exlOjd6ATNWcNCCySQt0)
[https://mega.nz/#!P1smnISA!Tiq1GFUQx_oR ... DwFR93gZgY](https://mega.nz/#!P1smnISA!Tiq1GFUQx_oR2iIKZWCghlmPCBS-7c_S3DwFR93gZgY)
## Post #62
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-08T10:38:12+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Atm I don't have time to fix because it's not a 5-minutes-job:



962_kluns.png (199.89 KiB) Viewed 320 times

(Got the chassis, the driver and the steering wheel only.)
## Post #63
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-04-08T18:09:51+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Mon Apr 08, 2019 6:38 pm at Mon Apr 08, 2019 6:38 pm
>
> 
Atm I don't have time to fix because it's not a 5-minutes-job:
962_kluns.png(Got the chassis, the driver and the steering wheel only.)

Excellent! I can't wait for this update.
## Post #64
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-08T21:57:45+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

okay, here i was looking for the silvia, ended up downloading the game and buying the silvia, just to realise you dont need to buy any car whatsoever, but its fine, the car folders have the .public ones, i can provide the silvia models and skins  in .public formats, gonna work on that, planning to make a port to assetto

here a sample .public from the silvia
[https://www.mediafire.com/file/3gn35nqm ... a.zip/file](https://www.mediafire.com/file/3gn35nqmtr6asn7/silvia.zip/file)

file uploaded, will check the sounds if i can found anything whatsoever, there are around 7 gbs of sound, dont think thats possible to upload that easy, for all the folks wanting to do the same, you can download the game for free in steam, in the root folder of the game(steam preferences of the game->local files) you will find different folders...

...\Steam\steamapps\common\raceroom racing experience\Game\GameData\General <- sound files here named "sound###.jca" you can unpack with bms plugin from aluigi

...\Steam\steamapps\common\raceroom racing experience\TargetData\Pc\base\cars <- all the models are to be found here, im not sure, havent tried yet, but i guess the geometry is stored in car_model, and the textures in car_skins, there is both the H2O modified by Shako-Tay2 for the models, and the quickbms script from aluigi for the textures

Hope that is helpful 

Edit:just tried and getting the same error as the other guy, gotta wait for an update on the make obj importer!

edit2: checking the converted .kluns with hxd i seem to find the strings for the parts of the car, would it be too much to ask how the h20 make-obj works?

Edit3: for the sound files you need to first decrypt the files using wtcced, then the raceroom.bms, now the question is, you get cfx files...
here a test file if anyone wants to look into it, this is from the 1st sound_1.jca file
[https://www.mediafire.com/file/edcwtan0 ... 1.cfx/file](https://www.mediafire.com/file/edcwtan05w7yx16/00000001.cfx/file)

edit4: here i upload the kluns from all the files i found to be public in the silvia files
[https://www.mediafire.com/file/id5pkp5n ... s.zip/file](https://www.mediafire.com/file/id5pkp5n55ph7b2/kluns.zip/file)
## Post #65
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-09T16:23:59+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

so, after checking a shako tay2 tutorial on how to export vertex data from models, have started checking the silvia kluns file and actually narrowed about 11 instances of data that does look like vertex data... wii i be able to export it? xD
[vertex.JPG](https://xentaxbackup.github.io/file/16012_vertex.JPG)
## Post #66
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-04-09T18:40:31+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Tue Apr 09, 2019 5:57 am at Tue Apr 09, 2019 5:57 am
>
> 
okay, here i was looking for the silvia, ended up downloading the game and buying the silvia, just to realise you dont need to buy any car whatsoever, but its fine, the car folders have the .public ones, i can provide the silvia models and skins  in .public formats, gonna work on that, planning to make a port to assetto

here a sample .public from the silvia
https://www.mediafire.com/file/3gn35nqm ... a.zip/file

file uploaded, will check the sounds if i can found anything whatsoever, there are around 7 gbs of sound, dont think thats possible to upload that easy, for all the folks wanting to do the same, you can download the game for free in steam, in the root folder of the game(steam preferences of the game->local files) you will find different folders...

...\Steam\steamapps\common\raceroom racing experience\Game\GameData\General <- sound files here named "sound###.jca" you can unpack with bms plugin from aluigi

...\Steam\steamapps\common\raceroom racing experience\TargetData\Pc\base\cars <- all the models are to be found here, im not sure, havent tried yet, but i guess the geometry is stored in car_model, and the textures in car_skins, there is both the H2O modified by Shako-Tay2 for the models, and the quickbms script from aluigi for the textures

Hope that is helpful 

Edit:just tried and getting the same error as the other guy, gotta wait for an update on the make obj importer!

edit2: checking the converted .kluns with hxd i seem to find the strings for the parts of the car, would it be too much to ask how the h20 make-obj works?

Edit3: for the sound files you need to first decrypt the files using wtcced, then the raceroom.bms, now the question is, you get cfx files...
here a test file if anyone wants to look into it, this is from the 1st sound_1.jca file
https://www.mediafire.com/file/edcwtan0 ... 1.cfx/file

edit4: here i upload the kluns from all the files i found to be public in the silvia files
https://www.mediafire.com/file/id5pkp5n ... s.zip/file
If you want 3d model of Silvia, go to my fan page to download this car.
## Post #67
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-09T19:33:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25 ↑Wed Apr 10, 2019 2:40 am at Wed Apr 10, 2019 2:40 am
>
> 

If you want 3d model of Silvia, go to my fan page to download this car.
mind to share a link?
## Post #68
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-09T19:55:00+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Tue Apr 09, 2019 5:57 am at Tue Apr 09, 2019 5:57 am
>
> Edit:just tried and getting the same error as the other guy, gotta wait for an update on the make obj importer!Atm I don't know how to fix it other than manually:



Sylvia.png (231.25 KiB) Viewed 270 times



> edit2: checking the converted .kluns with hxd i seem to find the strings for the parts of the car, would it be too much to ask how the h20 make-obj works?You need to be more specific. Concerning the strings: they are not handled. Feel free to make a plan (for a working sample) which strings belongs to which submesh (number).
## Post #69
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-09T20:23:17+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Wed Apr 10, 2019 3:55 am at Wed Apr 10, 2019 3:55 am
>
> 
Machinedramon wrote: ↑Tue Apr 09, 2019 5:57 amEdit:just tried and getting the same error as the other guy, gotta wait for an update on the make obj importer!Atm I don't know how to fix it other than manually:
Sylvia.png
edit2: checking the converted .kluns with hxd i seem to find the strings for the parts of the car, would it be too much to ask how the h20 make-obj works?You need to be more specific. Concerning the strings: they are not handled. Feel free to make a plan (for a working sample) which strings belongs to which submesh (number).

Thank you very much for the reply! what i meant is if you would be kind to share more or less the logical steps to make it work, i would do the steps and all thats required, i looked through your tutorial on hex2obj, and after that kinda started to search in the silvia model, not sure if the kluns was properly exported, its not even that problematic about uvs or normals, as long as i am able to get the vertex position and faces i will work it on 3d max, so, what am i doing right or wrong if you dont mind asking? like, i started to see some kind of pattern in the kluns when looking for the face indexes.... what i found out is that most of the meshes have like a header where it says "/vdecl/.../vdecl..." then afterwards i would guess the vertex position comes, and lastly the vertex face indexes, am i right?... like in this example, 4 submeshes and 20 uv map size?(took this little mesh for learning purposes, its pretty small so not to be much of a hussle)
i stripped it from the converted kluns, if i was wrong to do so... the offset within the car_template.kluns is 69BE65

[https://www.mediafire.com/file/u684uh0u ... kluns/file](https://www.mediafire.com/file/u684uh0u426gqic/car_template_-_Selecci%F3n.kluns/file)

thanks for the help!!!!
## Post #70
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-09T22:23:18+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Wed Apr 10, 2019 4:23 am at Wed Apr 10, 2019 4:23 am
>
> like, i started to see some kind of pattern in the kluns when looking for the face indexes.... what i found out is that most of the meshes have like a header where it says "/vdecl/.../vdecl..." then afterwards i would guess the vertex position comes, and lastly the vertex face indexes, am i right?yep, that's it how it works, more or less: searching for "vdecl/", then comes the FVFsize and the counts. For the start of FI blocks it's just searching for 00000000 01000000 02000000. The problem is how to properly combine the blocks (v and FI).
(Your sample lacks a proper header so I can't create a map automatically.)

edit: slow progress:



962-interiors.png (169.08 KiB) Viewed 231 times
## Post #71
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-04-12T13:53:42+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Acewell ↑Thu Jan 24, 2019 2:51 am at Thu Jan 24, 2019 2:51 am
>
> 
here is bms script to scan and rip the dds files from the *.kluns samples.  
Code: Select all# script for QuickBMS http://aluigi.altervista.org/quickbms.htm

get FOLDER basename
math i = 1 
findloc OFFSET binary "\x44\x44\x53\x20"
do
    math OFFSET - 4
    goto OFFSET
    get SIZE long
    savepos OFFSET
    string NAME p "%s\%d.dds" FOLDER i
    log NAME OFFSET SIZE
    math i + 1
    math OFFSET + SIZE
    goto OFFSET
    findloc OFFSET binary "\x44\x44\x53\x20" 0 ""
while OFFSET != ""

they are named in the order they are ripped, the names are actually stored
in the kluns files but i have not figured out how to find and link them all together.
Any chance for update? This script doesn't' work now.
## Post #72
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-13T15:49:50+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I'm continuing with the models:

You'll need Make_obj-kluns_redux.exe and dlls from Make_obj-RR RacExp.zip
and
Hex2obj_0.24e.exe AND the files in hex2obj_0.24c.zip:
[viewtopic.php?f=29&t=10894&p=142434&hil ... al#p142434](https://forum.xentax.com/viewtopic.php?f=29&t=10894&p=142434&hilit=+actual#p142434)
edit, 2 years later!
not tested but I assume this version should do better (for lynkco car at least, used as an example there):

> Reply from shakotay2 ↑Sat Jul 13, 2019 7:37 pm at Sat Jul 13, 2019 7:37 pm
>
> 
There's some trouble with the counts in newer kluns and I don't have a clue how to solve it properly.
I'm too busy with RL concerns atm so here's a workaround - you may hate it.
(If so then don't use it, please.  )

I'm referring to the 962 car_template.kluns which was uploaded to this thread:

> Reply from zimex25 ↑Sat Apr 06, 2019 8:46 pm at Sat Apr 06, 2019 8:46 pm
>
> 
(well, link expired after 2 years, surprise  , so you need to own the game)

Here we go (caveat with wrong face indices)
-------------------------------------------

- start Make_obj-kluns_redux.exe and load said kluns file
- H2O files 0 to 83 are being created (not obj as told in first line)
- close the app

------------------------------
- start Hex2obj_0.24e.exe and load kluns as before
- File SaveAs Mmesh
(it reads "Mmesh", not "mesh", well)
- read the pop window's text and do as you're told

- you will be experiencing a bad crash, yeah, sorry for that  
- close hex2obj

- open the kluns folder
- search for car_template_67.objx, the file that caused the crash
(I'd suggest to move all other .obj to a subfolder)

- drag'n drop it to a hexeditor, such as HxD for example
- first ASCII lines contain: car_template.kluns_7.h2o
(keep in mind that the numbers (67 and 7 here) are different, sorry for that)

##### you could simply erase that H2O file and continue at "importing to blender"
but there's good reasons to fix the problem:
------------------------------------------------------
- start Hex2obj_0.24e.exe and load kluns
- File/Open H2O: car_template.kluns_7.h2o

- press go1, scroll down left list box 'til
  face indices "go nuts": d0f833

-subtract: d0f833 - d00497= 0xf39c -> dec. 62364
- divide by 4 -> 15591
- replace face indices count 23583 by that fixed count
- press go1, scroll down listbox, find 15348 as new vertex count

- correct actual vertex count 15349 to 15348
- press 'mesh' to view the chassis

- File/save H20

- view kluns folder and rename created car_template_0.h2o to
car_template_7.h2o (you'll get nuts sooner or later in case you don't do so)

- File/SaveAs mesh (complains that car_template_0.obj exists if not moved as told above)
- rename created car_template_0.obj to car_template_67.obj

#############################################

Workaround for second caveat with wrong vertex sizes
----------------------------------------------------

- sort created .obj by size
- inspecting *_34.obj doesn't reveal problems but
- car_template_45.obj is a troubles candidate!

- open in notepad, first lines says: car_template.kluns_5.h2o

- scroll down to 2nd half of file with
 v -5372.000000 -0.000170 -247.750000
- place cursor, edit/goto says: line is 24311
- subtract 2, divide by 2 -> 12154
that's the correct vertex count

- delete said trouble obj

- start Hex2obj_0.24e.exe and load kluns
- File/Open H2O: car_template.kluns_5.h2o
- change face indices count from 17589 to 12154
(yes, it's vertex count, but we need a point to start)
- press go1, scroll down left listbox: 12154
- replace actual vertex count 17588 by 12154
- press 'mesh', view cockpit

- save mesh and H2O file, rename then to *_45.obj and *_5.h2o

HTH
shak-otay

(there's about 23 .obj files with a size of > 100kB, so some work left)

"importing to blender"
----------------------

import single obj with wavefront importer
or use .py script

When executing load_multi_obj_blender2.69.py in a blender Text Editor window 
make sure to have set "path_to_obj_dir" to YOUR kluns directory.

(obj files in a maybe contained subdirectory are being loaded, too)



 Make_obj-RR RacExp.zip
(111.9 KiB) Downloaded 68 times



(In case there's missing faces after fixing you could try out the -kluns_raw.exe, untested.
The -kluns_redux.exe starts with pre-reduced FI counts, x11/12)

edit: correction for 6.h2o (56.obj):
0xBE1276 4896
Vb1
44 20
0xB49A70 4889
040200
0x0 255
## Post #73
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-13T20:08:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

found it a little bit tricky to combine the suiting submeshes for correct uv map:



962_uvs.jpg (193.94 KiB) Viewed 218 times
## Post #74
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-13T20:13:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Wonderfull! thank you very much for the workaround, this is good news, already working on the silvia checking the broken models and the ones that i could rework in 3d!!! Man you are really awesome! thanks for all the progress!!!! cheers
## Post #75
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2019-04-13T23:00:44+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25 ↑Fri Apr 12, 2019 9:53 pm at Fri Apr 12, 2019 9:53 pm
>
> Any chance for update?
not by me right now, looks too chaotic, maybe i'll circle around 
back to this at a later time if no one else has it figured out.
## Post #76
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-14T21:05:18+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

it worked! sure the model needs some repairs but so far, lovely, at last some silvia!!!
[mostly.JPG](https://xentaxbackup.github.io/file/16038_mostly.JPG)
## Post #77
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2019-04-21T11:30:12+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

took some time and work but check this out! im very thankful!
## Post #78
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-21T15:11:22+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Sun Apr 21, 2019 7:30 pm at Sun Apr 21, 2019 7:30 pm
>
> 
took some time and workcool!  
(Remember to try out the *-kluns_raw.exe for producing H2O files in case some submeshes are missing too many faces.)
## Post #79
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-04-22T17:47:01+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Many object have crazy smooth or broken mesh. I just wait for better version like previous version.
## Post #80
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-04-22T19:21:50+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25 ↑Tue Apr 23, 2019 1:47 am at Tue Apr 23, 2019 1:47 am
>
> 
Many object have crazy smooth or broken mesh. I just wait for better version like previous version.I'm sorry to tell that a better version is very unlikely to be created since I don't have any clue about the unfitting counts in "newer" kluns files.
That's the reason why I created this workaround:

> Reply from shakotay2 ↑Sat Apr 13, 2019 11:49 pm at Sat Apr 13, 2019 11:49 pm
>
> 
You might try out to reduce the counts in the H2O files created by *-kluns_redux.exe.

Or use *-kluns_raw.exe to avoid broken meshes ("raw" means the created H2O files contain original counts (which may be uncorrect for unknown reasons)).

Or you might upload one of the problematic kluns files.
## Post #81
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2019-05-01T15:10:55+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Tue Apr 23, 2019 3:21 am at Tue Apr 23, 2019 3:21 am
>
> 
zimex25 wrote: ↑Tue Apr 23, 2019 1:47 am
Many object have crazy smooth or broken mesh. I just wait for better version like previous version.
I'm sorry to tell that a better version is very unlikely to be created since I don't have any clue about the unfitting counts in "newer" kluns files.
That's the reason why I created this workaround:
shakotay2 wrote: ↑Sat Apr 13, 2019 11:49 pm
You might try out to reduce the counts in the H2O files created by *-kluns_redux.exe.

Or use *-kluns_raw.exe to avoid broken meshes ("raw" means the created H2O files contain original counts (which may be uncorrect for unknown reasons)).

Or you might upload one of the problematic kluns files.

Porsche 964 Cup, hood: [https://imgur.com/rJ151XQ](https://imgur.com/rJ151XQ) Many objects have issue like this. I hope for better tools for this game   [https://mega.nz/#!P1smnISA!Tiq1GFUQx_oR ... DwFR93gZgY](https://mega.nz/#!P1smnISA!Tiq1GFUQx_oR2iIKZWCghlmPCBS-7c_S3DwFR93gZgY)
## Post #82
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-05-01T20:24:24+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hoods are okay for me; I used Make_obj-kluns_raw.exe to create
 



hoods.png (246.61 KiB) Viewed 356 times


It was required to delete these submeshes (and some more) in blender:
3 7 8 14 15 46 48 67 68 83 86 89
[https://www.mediafire.com/file/lc1pape6 ... 4.zip/file](https://www.mediafire.com/file/lc1pape6vcsb9ua/964.zip/file)
(link has expired after a year, surprise, so you need to recreate those submeshes for yourself - don't have the time to do it again, sorry)

To handle the missing/buggy submeshes you could try Make_obj-kluns_redux.exe. (It might be required to decrease face indices counts in the H2O files.)
## Post #83
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-11T13:36:07+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi
Are you still working on the tool to improve it?
## Post #84
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-11T14:19:38+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi,
nope. But "you might upload [...] problematic kluns files".
## Post #85
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-12T12:31:22+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi
Thanks for the answer

With the old tool, before the new encryption, it was much easier to get an .obj file to work with.
I now, with Make_obj-kluns_raw, also get the models but with much more work and time.

My biggest problem is with your tutorial on page 5:

"- H2O files 0 to 83 are being created (not obj as told in first line)"
- I usually get 95 to 96 H2O files

"- search for car_template_67.objx, the file that caused the crash"
- I do not have any files with the extension .objx

"- press go1, scroll down left list box 'til
face indices "go nuts": d0f833!"
- I do not have this expression or value

"-subtract: d0f833 - d00497= 0xf39c -> "
- I do not have any of these values

From this moment I am completely lost.

If I do not do any of this and try to import the obj files, I got (no changes), I get whats in the image
In the middle of all that confusion is the model I want. (I "just" have to delete the "junk")
[Sem Título.jpg](https://xentaxbackup.github.io/file/16462_Sem Título.jpg)
## Post #86
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-12T13:39:46+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from portoalto ↑Fri Jul 12, 2019 8:31 pm at Fri Jul 12, 2019 8:31 pm
>
> 
Hi
Thanks for the answer

With the old tool, before the new encryption, it was much easier to get an .obj file to work with.
I now, with Make_obj-kluns_raw, also get the models but with much more work and time.I don't understand what you mean. Some newer kluns required another treatment. I'm sorry to say that I don't have the time to create an easier workaround for those.


> My biggest problem is with your tutorial on page 5:
>
> 
>
> "- H2O files 0 to 83 are being created (not obj as told in first line)"
>
> - I usually get 95 to 96 H2O files
>
> 
>
> "- search for car_template_67.objx, the file that caused the crash"
>
> - I do not have any files with the extension .objx
>
> 
>
> "- press go1, scroll down left list box 'til
>
> face indices "go nuts": d0f833!"
>
> - I do not have this expression or value
>
> 
>
> "-subtract: d0f833 - d00497= 0xf39c -> "
>
> - I do not have any of these values
>
> 
>
> From this moment I am completely lost.I wrote:

> I'm referring to the 962 car_template.kluns
I showed it AS AN EXAMPLE!

(You can't seriously expect that any kluns has the same values, do you?  )

You need to get the idea from that example and adapt it for other kluns.
## Post #87
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-12T15:33:43+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

" I don't understand what you mean. Some newer kluns required another treatment. I'm sorry to say that I don't have the time to create an easier workaround for those."

The only thing I wanted to say is that it was pity the new kluns files have a new and more difficult encryption and the tool does not work with this encryption so forward as before and that it's a shame you do not have time to improve it, but real life is like that and it's in the first place
I did not want to say anything else.

"I showed it AS AN EXAMPLE!
(You can't seriously expect that any kluns has the same values, do you?  )
You need to get the idea from that example and adapt it for other kluns.

I know it was just an example, but in that case you get a file with the extension objx in my case I only get files with the extension obj.
I can import these directly into the blender without further workarounds?

If yes I get what is in the image that I posted before, I do not understand how users previously showed images with the clean mesh
## Post #88
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-12T17:31:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from portoalto ↑Fri Jul 12, 2019 11:33 pm at Fri Jul 12, 2019 11:33 pm
>
> I know it was just an example, but in that case you get a file with the extension objx in my case I only get files with the extension obj.
I can import these directly into the blender without further workarounds?
Nope. Things should be easier if there's no .objx to be found but you still have to do the counts reducing thingie.
Doing it manually requires some experience in 3D models, doing it automatically:

> The -kluns_redux.exe starts with pre-reduced FI counts, x11/12)
is just a wild guess which could make things worse than before.
.

> , I do not understand how users previously showed images with the clean meshI didn't say that it's easy   - best thing would be if you uploaded the .kluns which you named Sem Título.

edit: for the second tool involved I had to create a modified hex2obj version (see my next post) to get this from the lynkco:
.



lynkco_chassis_and_cockpit.jpg (252.15 KiB) Viewed 245 times
## Post #89
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-12T21:10:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I'm trying to figure out how things work so I'm not dependent on the help of other people, but I appreciate your availability

Here are two examples where I do not get any .objx files

[https://www.mediafire.com/file/l910c6v1 ... e.rar/file](https://www.mediafire.com/file/l910c6v11y55az3/giuliettatcr2019_car_template.rar/file)
[https://www.mediafire.com/file/auy7hjy1 ... e.rar/file](https://www.mediafire.com/file/auy7hjy14ocexwh/lynkco_car_template.rar/file)

And here are two examples where I get a file with the extension .objx

[https://www.mediafire.com/file/e9p19nfw ... e.rar/file](https://www.mediafire.com/file/e9p19nfwbrxbqbu/giuliettatcr2019_cockpit_template.rar/file)
[https://www.mediafire.com/file/ln0imtmi ... e.rar/file](https://www.mediafire.com/file/ln0imtmi5wcal4z/lynkco_cockpit_template.rar/file)
## Post #90
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-13T11:37:01+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from portoalto ↑Sat Jul 13, 2019 5:10 am at Sat Jul 13, 2019 5:10 am
>
> 
I'm trying to figure out how things work so I'm not dependent on the help of other people,That's great so then let's have a go. You need Make_obj-kluns_raw.exe from some above post and a special version hex2obj for the "RaceR Racing Exp" project:


 Hex2obj-RRRExp.zip
(201.81 KiB) Downloaded 63 times



After creation of H2O files using Make_obj-kluns_raw.exe you're required to do a multimesh/obj creation using Hex2obj-RRRExp.exe.

(For details read WorkaroundForNewerKluns.txt from a zip some post up or read my concerning post above.)
And 'yes', Hex2obj_0.24e.exe doesn't work here so use the special version, please.

What it does is create obj AND H2O_multiMesh_rename.cmd which renames some ugly .obj to .obj~ (when executed  ) .

So you can do your multi obj import to blender using load_multi_obj_blender2.69.py and care for those .obj~ later.


As an example, lynkco car:  car_template_3.obj~

H2O file (car_template.kluns_11.h2o) for the following obj~ file:
0xa744e1 23283 <- FI count, wrong
Vb1
44 20
0xa130d3 9065 <- vertex count, wrong
040200
0x0 255

```
# 0xa130d3: verts= 9065

[...]
vt 0.108398 1.472656  
v -0.534180 1.049805 1.781250 
vt 0.108337 1.473633  
v -0.501953 1.048828 1.797852 
vt 0.111511 1.472656  
v -0.501953 1.051758 1.795898 
vt 0.111389 1.473633  
v -0.104126 1.051758 1.864258 
vt 0.147217 1.472656  
v -0.104187 1.054688 1.862305 
vt 0.147217 1.472656  
v -0.216309 1.051758 1.857422 
vt 0.137329 1.472656  
v -0.216431 1.054688 1.855469 
vt 0.137329 1.472656  
v -0.324463 1.050781 -0.132690     line 14879 in notepad, subtract 2, then divide by 2 -> 7438 valid vertices
-----    here is where the spoiled vertices begin ---------
vt -27600.000000 40096.000000  
v -27600.000000 40096.000000 399.750000 
vt 26.953125 29488.000000  
v 26.953125 29488.000000 -799.500000 
vt 0.002802 25088.000000  
v 0.002802 25088.000000 -0.003538 
vt -3.869141 25008.000000  
v -3.869141 25008.000000 -0.040985 
vt 0.000036 26096.000000  
v 0.000036 26096.000000 -5.246094 
vt 5872.000000 26864.000000  
v 5872.000000 26864.000000 -0.000040 
vt -0.011200 27680.000000  
v -0.011200 27680.000000 0.000762 
vt -0.000287 28144.000000  
v -0.000287 28144.000000 6.246094 
[...]


```

- load kluns and H2O file into Hex2obj-RRRExp.exe
- press go1
- in the lower left listbox scroll down to last valid FI (=vertex count)

a87e49 7437 7436 7438

getting size of face indices block (0x13968= )
endaddress from line above minus FI start address, see H2O file above ---- (divide by 4 because we've DWord FIs here):

0xa87e49 - 0xa744e1 = 0x13968  / 4 = 20058 dec.

(add the 3 FIs which we didn't count -> 20061   )

This is the new FI count -> change in hex2obj, press go1 -> vertsCount is 7438 then.

btw: yeah, this is the most horrible explanation/tool I ever wrote but bear with me, please, I'm in a real hurry.

Maybe another useful post:

> Reply from shakotay2 ↑Sun Nov 08, 2020 5:41 am at Sun Nov 08, 2020 5:41 am
>
>
## Post #91
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-13T12:36:07+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thank you.
I'll try it then.
## Post #92
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-13T20:23:09+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

fixing lynkco car_template obj~
.



lynkco_4-obj~_12-H2O.png (105.57 KiB) Viewed 385 times
## Post #93
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-13T20:38:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

For giulietta tcr2019 car_template 29 of 99 submeshes need a special treatment like above.

```
car_template_3.obj~
car_template_4.obj~
car_template_5.obj~
car_template_6.obj~
car_template_8.obj~
car_template_18.obj~
car_template_19.obj~
car_template_24.obj~
car_template_33.obj~
car_template_37.obj~
car_template_51.obj~
car_template_52.obj~
car_template_54.obj~
car_template_55.obj~
car_template_57.obj~
car_template_58.obj~
car_template_62.obj~
car_template_67.obj~
car_template_72.obj~
car_template_75.obj~
car_template_76.obj~
car_template_78.obj~
car_template_89.obj~
car_template_94.obj~
car_template_96.obj~
car_template_97.obj~
car_template_98.obj~
car_template_99.obj~
```

Correction for _7.H2O (_67.obj~):

0xADCEBE 13053
Vb1
92 20
0x861EB3 8951
040200
0x0 255


The other 70 submeshes look like this.



giulietta tcr2019.jpg (215.03 KiB) Viewed 384 times
## Post #94
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-14T19:17:24+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

In first place, I appreciate and thank you very much for the availability you showed in trying to help.

However I have never been able to learn or understand the Hexa values and their edition.

For example in the middle of so many lines that appear in the lower left listbox how can you find out which line is wrong?
As in the example of lynkco car which is the line with the value a87e49 7437 7436 7438?

Another thing is the value 0x13968 to which you arrive?
/  0xa87e49
-  0xa744e1
/  0x/13968
//////  Î Î
//////  ? ?
How do you subtract a number from a letter (or vice versa) do you get those numbers?

As I said I am a total noob in matters of Hexa values.  

But now with the new version of the tool I can already identify the obj files with problems and I can work individually in the 3d program.
Only pity not to happen the same with the cockpits
But as I say: "It is always better to have little than nothing!" 

I know it's not your area but with the new encryption you can no longer extract the textures.
Do you or anyone else know of any new script or how to extract the DDS files?
## Post #95
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2019-07-14T20:20:28+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from portoalto ↑Mon Jul 15, 2019 3:17 am at Mon Jul 15, 2019 3:17 am
>
> For example in the middle of so many lines that appear in the lower left listbox how can you find out which line is wrong?
As in the example of lynkco car which is the line with the value a87e49 7437 7436 7438?Guess you didn't check the "code" in my concerning post?

Find the lines in the obj file (here: lynkco car, car_template_3.obj~) where the spoiled vertices begin (very obvious, imho):
[...]
vt 0.137329 1.472656  
v -0.324463 1.050781 -0.132690     line 14879 in notepad, subtract 2, then divide by 2 -> 7438 valid vertices
-----    here is where the spoiled vertices begin ---------
v -27600.000000 40096.000000 399.750000 
vt 26.953125 29488.000000  

----------------------------------------
There's several face indices lines in the lower left list box of hex2obj which contain the face index 7438.
You need to get the line which doesn't have predecessors with higher FIs than 7438 in it.
(Simply scroll down from a744e1 1 2 3 to the first hit of 7438 -> a87e49 7437 7436 7438)

> Another thing is the value 0x13968 to which you arrive?
>
> /  0xa87e49
>
> -  0xa744e1
>
> /  0x/13968
>
> //////  Î Î
>
> //////  ? ?
>
> How do you subtract a number from a letter (or vice versa) do you get those numbers?
I can't give math lessons here but the hexadecimal system has 16 as a base (instead of 10 in decimal system).
So hex is required to use a, b, c, d, e, f which stand for 10, 11, ..., 15.
(Another idea would have been to use parentheses for example 0x(10)(11)(12) instead of 0xabc but using letters is the better solution.)

You could try out some online hex calculators, for example: [https://www.calculator.net/hex-calculator.html](https://www.calculator.net/hex-calculator.html)

> Only pity not to happen the same with the cockpits
>
> But as I say: "It is always better to have little than nothing!""Little", yeah, covering 70% of a mesh is far from being "little".  
(edit: well, I see, for giulietta cockpit I used a debug version which I didn't release, upps...)
I've updated the zip in the concerning post: [viewtopic.php?f=16&t=19347&p=154697&hil ... ip#p154697](https://forum.xentax.com/viewtopic.php?f=16&t=19347&p=154697&hilit=Hex2obj+RRRExp.zip#p154697)
(Always remember to excute H2O_multiMesh_rename.cmd and handle the *.obj~ separately then.)
.



giulietta_cockpit.png (204.69 KiB) Viewed 356 times

(some vt in the .obj~ files look a little bit strange to me -> todo list 2020  )

> I know it's not your area but with the new encryption you can no longer extract the textures.
>
> Do you or anyone else know of any new script or how to extract the DDS files?Usually Acewell cares for the textures - but for encrypted ones you could open a thread in the Graphic file formats section.
## Post #96
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2019-07-14T21:32:23+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Guess you didn't check the "code" in my concerning post?
>
> Find the lines in the obj file (here: lynkco car, car_template_3.obj~) where the spoiled vertices begin (very obvious, imho):
>
> [...]
>
> vt 0.137329 1.472656  
>
> v -0.324463 1.050781 -0.132690     line 14879 in notepad, subtract 2, then divide by 2 -> 7438 valid vertices
>
> -----    here is where the spoiled vertices begin ---------
>
> vt -27600.000000 40096.000000  
>
> There's several face indices lines in the lower left list box of hex2obj which contain the face index 7438.
>
> You need to get the line which doesn't have predecessors with higher FIs than 7438 in it.
>
> (Simply scroll down from a744e1 1 2 3 to the first hit of 7438 -> a87e49 7437 7436 7438)

I saw but for me it did not make sense. Now it does.

> I can't give math lessons here but the hexadecimal system has 16 as a base (instead of 10 in decimal system).
>
> So hex is required to use a, b, c, d, e, f which stand for 10, 11, ..., 15.
>
> (Another idea would have been to use parantheses for example 0x(10)(11)(12) instead of 0xabc but using letters is the better solution.)
>
> You could try out some online hex calculators, for example: https://www.calculator.net/hex-calculator.html

I was not expecting math lessons and you were not obliged to do so, but you clarified me a lot with the explanation. Thank you

> "Little", yeah, covering 70% of a mesh is far from being "little".

Do not get me wrong.
I'm happy with what you've done. Before we had absolutely nothing for this game.

> Usually Acewell cares for the textures - but for encrypted ones you could open a thread in the Graphic file formats section.

I'll do that. Thank you.
## Post #97
- Username: djibsone2
- Rank: beginner
- Number of posts: 21
- Joined date: Wed Dec 21, 2016 10:15 am
- Post datetime: 2019-08-22T21:55:39+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

hello everybody any news about ripping of the porsche 962c imsa gtp and nissan r90cp thank you
## Post #98
- Username: ELEMENT
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Thu Mar 19, 2020 9:29 pm
- Post datetime: 2020-03-20T05:51:58+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Sun Jul 14, 2019 4:23 am at Sun Jul 14, 2019 4:23 am
>
> 
fixing lynkco car_template obj~
.
lynkco_4-obj~_12-H2O.png

Can you send me all lynkco tcr model files？Thank you
[wqy9182010@126.com](mailto:wqy9182010@126.com)
## Post #99
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-03-20T14:31:13+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

This is what I have:
[lynkco_part1.zip](http://www.uploadmb.com/dw.php?id=1584713782)

In case you want more you need to engage in it:  
.
spoiled H2O files (see appended zip) whose params/counts need corrections

(lynkco) car_template.kluns_xx.h2o, where xx is one of:
11,12,15
17,18,19
21,23,29
30,32,33
41,43,44,46
55,56,57,59
60,61,63
72,74,75,77
88,89,90,91
-----------------------------------------

requirements:
copy Hex2obj_0.24e2.exe (in appended zip) to your hex2obj directory (full zip with dlls view link in my sig)
 (lynkco) car_template.kluns
 notepad.exe (copy it to your directoy where Hex2obj_0.24e2.exe resides)
 spoiled H2O files, see list above

actions
start Hex2obj_0.24e2.exe
load car_template.kluns
load one of said H2O files, car_template.kluns_11.h2o here
check checkbox right to 'table'-button
toggle 'noPtc' button to 'PtCld'
press 'mesh' button (spoiled point cloud, yeah)
press 'test' button
scroll down in the test.obj file till the vertices go bogus:
...
v -0.324463 1.050781 -0.132690 
v -27600.000000 40096.000000 399.750000 
...

- place cursor, edit/goto says: line is 7440
- subtract 1 -> 7439
  use it as vertex count (step 3)
(press 'mesh' button, you should see a decent point cloud now)

toggle 'PtCld' button back to 'noPtC'

```
  (well, trial 'n error) ->  19283 

- press go1, scroll down left listbox, max face index is 7135
  (after several attempts:)
  use FI count of 20656 to get the 7439 as vertex count

- replace actual vertex count 9065 by 7439
- press 'mesh' for control
```


last vt line still bogus then! So finally use 20062/7438

- save mesh and H2O file (result see next post)

Another 30 H2O files to be handled, yeah, sorry, I don't have the time to write code for it.
I'd start with these:

88 (vCount: 9965, FIs: 14300 -> vCount 9933)
90 (vCount: 4170, FIs:  9199 -> vCount 4135)

23 29 30
55 56
60


 car_template.kluns_xx-H2Os-correctMe.zip
(209.79 KiB) Downloaded 30 times
## Post #100
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-03-20T14:35:40+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

face index (FI) count: 20062 -> 6687 faces
.



car_template_3-(H2O_11)-obj.png (101.29 KiB) Viewed 213 times



Some corrected H2O files for lynkco:

0xA744E1 20062
Vb1
44 20
0xA130D3 7438
040200
0x0 255

0xCA09B4 5610
Vb1
92 20
0xA8B117 2165
040200
0x0 255

0x156BE6F 14348
Vb1
92 20
0x146F575 9965
040200
0x0 255

0x15FD59E 9258
Vb1
92 20
0x1581732 4170
040200
0x0 255

0x10D1969 2979
Vb1
92 20
0x10AD4DB 877
040200
0x0 255

0x11565BA 546
Vb1
44 20
0x1100EB3 346
040200
0x0 255

0x118D9F7 1015
Vb1
44 20
0x11605AE 487
040200
0x0 255

0x12F5CB1 245
Vb1
92 20
0x1297B5D 167
040200
0x0 255

0x130FA3D 482
Vb1
92 20
0x12FBD1B 354
040200
0x0 255

0x1320F42 1421
Vb1
20 14
0x131D6DA 722
040200
0x0 255

---------------------------------

How to create the H2O files

Make_obj-RR RacExp.zip:

> Reply from shakotay2 ↑Sat Apr 13, 2019 11:49 pm at Sat Apr 13, 2019 11:49 pm
>
> 

for the hoods, read:

> Reply from shakotay2 ↑Thu May 02, 2019 4:24 am at Thu May 02, 2019 4:24 am
>
> 

special version hex2obj (Hex2obj-RRRExp.zip):

> Reply from shakotay2 ↑Sat Jul 13, 2019 7:37 pm at Sat Jul 13, 2019 7:37 pm
>
> 

And, always remember  :
"yeah, this is the most horrible explanation/tool I ever wrote but bear with me, please, I'm in a real hurry."
## Post #101
- Username: Ricardog
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Wed Mar 11, 2020 8:34 pm
- Post datetime: 2020-05-08T07:37:36+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi, anyone managed to extract the WTCR Lync.co original textures / skins and would like to share?
## Post #102
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-03T22:34:36+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

First of all: Thank you for all your work, shakotay2! A very exciting topic and I have managed to familiarise myself with it.

I have tried to extract some kluns files for the last 2 days. I was able to create some kluns-files with your instructions, but I encountered problems and I can't get any further.

It is about the "Audi RS5 DTM 2020". Here is a preview of the obj-files that worked so far.



For example, if I want to correct car_template_89.obj~, I look for the wrong vertices. Actually I should take the line 5284, but after wrong vertices, the list will show correct ones again. Is there a solution or any hint how to solve this problem?



At the same time I would not get a correct face indices count for line 5284.




Apparently there are many vertices missing at the end in the extracted obj-file. 


I would really like to extract the models and textures of Audi and BMW. Hopefully you can help me.

Attached you can find an archive with the kluns and h20 files for the Audi.
[https://mega.nz/file/8eRhlK5Z#QggZrKEkB ... RS957zuqGs](https://mega.nz/file/8eRhlK5Z#QggZrKEkBy4XVcVqnnKDBY-m7BBSqWlHeRS957zuqGs)
## Post #103
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-11-04T09:23:50+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Zangano ↑Wed Nov 04, 2020 6:34 am at Wed Nov 04, 2020 6:34 am
>
> For example, if I want to correct car_template_89.obj~, I look for the wrong vertices. Actually I should take the line 5284, but after wrong vertices, the list will show correct ones again. Is there a solution or any hint how to solve this problem?
well, I see the problem. This would require some research but I don't have the time for it atm.

As a simple workaround you could replace the bad vertices by v 0.0 0.0 0.0. You might try out this with a hundred v x y z lines but I assume the underlying problem (change of FVFsize?, whatever) won't be solved by this.

In the H2O_multiMesh_rename.cmd there's a list of spoiled obj files - maybe search those to find more intact vertices after having done some corrections?

```
ren car_template_7.obj car_template_7.obj~
ren car_template_8.obj car_template_8.obj~
ren car_template_9.objx car_template_9.objx~
ren car_template_16.obj car_template_16.obj~
ren car_template_17.obj car_template_17.obj~
ren car_template_20.obj car_template_20.obj~
ren car_template_30.obj car_template_30.obj~
ren car_template_33.obj car_template_33.obj~
ren car_template_34.obj car_template_34.obj~
ren car_template_37.obj car_template_37.obj~
ren car_template_47.obj car_template_47.obj~
ren car_template_48.obj car_template_48.obj~
ren car_template_49.obj car_template_49.obj~
ren car_template_50.obj car_template_50.obj~
ren car_template_51.obj car_template_51.obj~
ren car_template_52.obj car_template_52.obj~
ren car_template_55.obj car_template_55.obj~
ren car_template_65.obj car_template_65.obj~
ren car_template_67.obj car_template_67.obj~
ren car_template_69.obj car_template_69.obj~
ren car_template_72.obj car_template_72.obj~
ren car_template_87.obj car_template_87.obj~
ren car_template_89.obj car_template_89.obj~
ren car_template_90.obj car_template_90.obj~
ren car_template_93.obj car_template_93.obj~
ren car_template_95.obj car_template_95.obj~
ren car_template_96.obj car_template_96.obj~
```


From the current result it doesn't look that bad to me, good chance that there's some missing lods but I dunno which.
.



Audi.png (102.92 KiB) Viewed 118 times
## Post #104
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-04T19:58:31+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thanks for your quick reply, shakotay2! Such a shame that you are too busy at the moment. 

I will try my best on the next weekend getting a good base model. Maybe a kind of script can filter the deviations and replace them in the list a way faster.
## Post #105
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-06T21:58:32+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

I couldn't keep my hands off it and had to try it out directly tonight. Unfortunately I can't get it right. I tried a small file (car_template_96.obj~) but no chance to extract the required vertices.

May I ask you if the hood (car_template_9.obj) has missing faces on your side too, shakotay2?



hood_prob.png (172.56 KiB) Viewed 95 times



Besides the 3D stuff: Is it possible to extract the textures at all with the current Raceroom version? I was able to decompress the .kluns.public-file to a .kluns-file (size from 7.836 kb to 60.845 kb) but extracting the textures was not possible for me. All scripts I was able to find for quickbms are unfortunately not working, the mentioned ripping progs cannot find any textures too.
## Post #106
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-11-07T17:49:08+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Zangano ↑Sat Nov 07, 2020 5:58 am at Sat Nov 07, 2020 5:58 am
>
> 
I couldn't keep my hands off it and had to try it out directly tonight.well, keep up that spirit! 

> May I ask you if the hood (car_template_9.obj) has missing faces on your side too, shakotay2?You may - and 'yes', but it doesn't look like "missing faces" to me because the misses are symmetrical/mirrored and too "regular". I guess there should exist further sub meshes that will fill the gaps.

> Besides the 3D stuff: Is it possible to extract the textures at all with the current Raceroom version?The only bms script for RRR Exp textures I have just searches for the DDS signature: 
findloc OFFSET binary "\x44\x44\x53\x20"
In car_template.kluns from the Audi there's no findings.
## Post #107
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-11-07T21:41:58+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

yeah, there's spoiler bytes in the FIs' block, what the heck.
Here's the missing sub mesh I spoke of in the post before:
.



kluns_FIs_spoilerbytes.png (55.27 KiB) Viewed 330 times



So you have to make two corrections to the FI count here!
From car_template.kluns_17.h2o, FIs start address and (assumed) count:
0xf5c6da 29664

spoiler bytes address -(FIs start address) / 4 = FIs' count
0xF74098 - 0xf5c6da = 24175 FIs, valid count

assumed count - valid count:
29664 - 24175 = 5498, missing FIs

For some unknown reason the assumed FIs count (29664) is 74 too big. (As I wrote, no time to solve this, atm.)
-> second correction of FIs' count: 5498 - 74 = 5424.
## Post #108
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-07T23:01:00+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thanks for your additional information, shakotay2! 
I try my best with your new feedback hoping to get something to work.
## Post #109
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-08T01:07:06+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thank you for your help! It worked - without your information I would have been lost. 




audi_hood_complete.png (164.94 KiB) Viewed 321 times



Now I will try to get some of the .obj~ files corrected. Hopefully no mission impossible.
## Post #110
- Username: Zangano
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Tue Nov 03, 2020 7:19 am
- Post datetime: 2020-11-10T20:32:36+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Wed Nov 04, 2020 5:23 pm at Wed Nov 04, 2020 5:23 pm
>
> 
As a simple workaround you could replace the bad vertices by v 0.0 0.0 0.0. You might try out this with a hundred v x y z lines but I assume the underlying problem (change of FVFsize?, whatever) won't be solved by this.

Maybe cause I am an "ultra-n00b" or it's a sudden loss of any talent... I am not able to produce any good mesh.  

By trying your workaround, e.g. car_template_7.obj~ with its car_template.kluns_15.h2o, I get this result:




car_template-kluns_15-h2o_workaround.png (51.31 KiB) Viewed 305 times
## Post #111
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2020-11-10T20:51:20+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

that's weird but if you look at the test.obj, it's not surprising:

```
v 0.527344 1.035156 1.232422 
v 0.559082 1.032227 1.224609 
v 0.552246 1.058594 1.142578 
v 0.274902 1.058594 1.283203 
v 0.408691 1.047852 1.262695 
v 0.274902 1.086914 1.200195 
v 0.406494 1.075195 1.179688 
v 0.142334 1.065430 1.293945 
v 0.274902 1.058594 1.283203 
v 0.142334 1.092773 1.210938 
v 0.274902 1.086914 1.200195 
v 0.000031 1.067383 1.297852 
v 0.142334 1.065430 1.293945 
v 0.000031 1.095703 1.214844 
v 0.142334 1.092773 1.210938 
v 0.419434 0.987305 1.437500 
v 0.542480 0.978027 1.407227 
v 0.413818 1.017578 1.350586 
v 0.535645 1.005859 1.321289 
v 0.276855 0.999512 1.458984 
v -1.309570 13048.000000 -0.000095 
v 99.812500 11048.000000 463.750000 
v 14.382813 13640.000000 0.000111 
v 463.250000 12968.000000 -0.001769 
v 0.649414 13640.000000 5372.000000 
v -1.309570 13048.000000 -0.000095 
v 0.265137 12904.000000 1343.000000 
v -1.060547 11200.000000 0.000048 
v -0.001524 9352.000000 1.311523 
v 0.000320 9096.000000 -4348.000000 
v -4340.000000 16200.000000 0.006100 
v 0.265137 12904.000000 1343.000000 
v -1597.000000 11728.000000 0.000762 
v -0.001524 9352.000000 1.311523 
v -42912.000000 20576.000000 20.984375 
v -4340.000000 16200.000000 0.006100 
v -0.003534 14752.000000 7420.000000 
v -1597.000000 11728.000000 0.000762 
v 0.000317 21520.000000 -20.984375 
v -42912.000000 20576.000000 20.984375 
v -0.001513 15712.000000 0.000762 
v -0.003534 14752.000000 7420.000000 
v -0.000065 9912.000000 -69568.000000 
v -671.000000 2070.000000 -0.000095 
v 0.000442 5180.000000 8696.000000 
v 99.812500 11048.000000 463.750000 
v 1.058594 1.283203 1.000000 
v 1.038086 1.386719 1.000000 
v 1.035156 1.382813 1.000000 
v 1.067383 1.297852 1.000000 
v 1.065430 1.293945 1.000000 
v 0.959473 1.514648 1.000000 
v 0.951660 1.485352 1.000000 
v 0.987305 1.437500 1.000000 
v 0.978027 1.407227 1.000000 
v 0.972656 1.538086 1.000000 
v 0.959473 1.514648 1.000000 
...
```
After 20 vertices everything goes bogus... will require more research.
.



test_20verts.png (19.23 KiB) Viewed 302 times



Using 0xd73a87 as a new vertex start you get a point cloud of about 1600 "good" vertices but finding the belonging FIs is hard.
## Post #112
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2021-06-18T21:35:38+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi
As the last post is already 6 months old, I would like to know if the work on the tool is still continuing 
in order to facilitate the extraction of models with the new encryption, or if, on the contrary, 
this development has ended completely?
I apologize in advance for reviving this old theme and thank you
## Post #113
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2021-06-18T22:06:34+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from portoalto ↑Sat Jun 19, 2021 5:35 am at Sat Jun 19, 2021 5:35 am
>
> 
Hi
As the last post is already 6 months old, I would like to know if the work on the tool is still continuing 
in order to facilitate the extraction of models with the new encryption, or if, on the contrary, 
this development has ended completely?Hi.
If you are talking about the Make_obj tool from here:

> Reply from shakotay2 ↑Sat Apr 13, 2019 11:49 pm at Sat Apr 13, 2019 11:49 pm
>
> you can see it's 2 years old, so no, I don't think about touching that again, sry.

(You'll need the special Hex2obj version from here, btw:)

> Reply from shakotay2 ↑Sat Jul 13, 2019 7:37 pm at Sat Jul 13, 2019 7:37 pm
>
> 
The progress from half a year ago (driven by Zangano) was achieved by corrections of .H2O and .obj~ files, afair.

Plus some fiddling with "spoiler bytes" in the face indices' blocks, see here:

> Reply from shakotay2 ↑Sun Nov 08, 2020 5:41 am at Sun Nov 08, 2020 5:41 am
>
> 

(Maybe not the best solution, but a solution.)

And, well, from this last post:

> Reply from shakotay2 ↑Wed Nov 11, 2020 4:51 am at Wed Nov 11, 2020 4:51 am
>
> you may see I'd lost the motivation to fiddle around with some weird sub meshes. And it's just lack of time to dig into this again.
I think > 95% of any model is extracted fine, isn't it?

(Or maybe wait until another Zangano "pops" up.  )
## Post #114
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2021-06-19T18:02:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Thanks for the answer. 
It's a shame because this game has one of the hardest encryption to decode and is one that has less interest in ripping models 
despite having interesting cars.
But your choice is perfectly understandable and real life is above all else.
Thanks for what you and Zangano did.
## Post #115
- Username: [SGAN]Jay
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Wed Jun 30, 2021 2:05 am
- Post datetime: 2021-06-29T18:08:07+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25 ↑Wed May 01, 2019 11:10 pm at Wed May 01, 2019 11:10 pm
>
> 
shakotay2 wrote: ↑Tue Apr 23, 2019 3:21 am
zimex25 wrote: ↑Tue Apr 23, 2019 1:47 am
Many object have crazy smooth or broken mesh. I just wait for better version like previous version.
I'm sorry to tell that a better version is very unlikely to be created since I don't have any clue about the unfitting counts in "newer" kluns files.
That's the reason why I created this workaround:
shakotay2 wrote: ↑Sat Apr 13, 2019 11:49 pm
You might try out to reduce the counts in the H2O files created by *-kluns_redux.exe.

Or use *-kluns_raw.exe to avoid broken meshes ("raw" means the created H2O files contain original counts (which may be uncorrect for unknown reasons)).

Or you might upload one of the problematic kluns files.


Porsche 964 Cup, hood: https://imgur.com/rJ151XQ Many objects have issue like this. I hope for better tools for this game   https://mega.nz/#!P1smnISA!Tiq1GFUQx_oR ... DwFR93gZgY

do you still have this 964 model? the link is dead... can you let me have it please?
## Post #116
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2021-10-29T09:30:53+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

so after a review of this game i came to some interesting conclusion, maybe not perfect but still could be a help for many...


first of all the problem lies in the script for bms unpacking the .public files, they still use lzma2 but has some extra parameters that introduces a jump on the files that basically if you don't account it for your verts/textures will get totally ducked up. But, here the workaround for that, just go and grab the steam depot that is from 14 march 2017(google a bit and be careful of the tools you use, given r3e is free, i'd use another steam account to download the old depot; for you cannot use the steam console anymore for that). Once you have the old depot, the files will unpack correctly for that version, although there are not special tools that are able to unpack it from the get go I was able to code in python a script for mrp that works more or less good, this is by no means a final script and only works under my control of variables, if anyone is savvy enough of python and thinks they can modify the code to make it work, be welcome. (Just in case, I wont provide unpacked converted files in here.)


tip: there are 2 functions here I use to parse the file before I even can extract the geometry, one is to search for DDS textures and extract them to a "curfolder"; that you will need to change it(works for car_template, cockpit_template and liveries once all unpacked from .public) the second function that is for the positions will print in console the positions of the meshes in the file and generate the geometry based on the API of MRP.-

tip 2: this doesn't work for tracks for tracks have massive sizes, before being able to process tracks there will be need a better split method or using pure python(I think MRP is not suited to work on such big files).

```
import sys
from nines import *
f = mrp.get_bfile()

flag_array = [0x76 ,0x64 ,0x65 ,0x63 ,0x6C ,0x2F]
dds_array = [0x44 ,0x53 ,0x20]
dds_pos = []
positions = []
meshes = []


f.seek(0,2)
eof = f.tell()



f.seek(0)
def positions_search():
    for i in range(eof):
        try:
            byte_test = f.readByte()
            if byte_test == 0x2f:
                test_array = [f.readByte() for i in range(6)]
                f.seek(-6,1)
                if test_array == flag_array:
                    positions.append(f.tell()-1)
                    
        except:
            pass #end of file
            
    print(positions)
#------------------
#car silvia
#positions = [1054460, 1141186, 1182168, 1206030, 1241211, 2814624, 3583656, 3907010, 4327617, 4491844, 4536153, 4541726, 4560902, 4599182, 4599864, 4615904, 4729584, 4797377, 4815129, 4832881, 4850633, 4850950, 4853883, 4854130, 4858982, 4864270, 4867707, 4979600, 5012269, 5026962, 5063495, 5073563, 5073880, 5076837, 5086905, 5091793, 5095230, 5207243, 5239768, 5254461, 5290778, 5358372, 5387142, 5454736, 5483322, 5483639, 5486500, 5486697, 5491549, 5496837, 5500274, 5612167, 5644116, 5658809, 5695342, 5705410, 5705727, 5708708, 5718776, 5723664, 5727101, 5839090, 5871183, 5885876, 5922193, 7151679, 7154567, 7598201, 7598601, 7601533, 7854963, 8010845]
#cockpit silvia
#positions = [12586361, 12643287, 12839298, 13446622, 13448259, 13777777, 13779158, 13906890, 14082034, 14438510, 14766485, 14782807, 14783844, 14818022, 14819059, 14819976, 14821013, 14822050, 14823087, 14823284, 14824441, 14843166]
#-------------------
#car mustang imsa
positions = [1054468, 1141194, 1182176, 1206038, 1241648, 1286949, 1292109, 1324735, 1328663, 3431297, 3955457, 4644783, 5035256, 5165772, 5415566, 5422351, 5437343, 5453951, 5462387, 5622325, 5628637, 5766067, 5770855, 5908319, 5987404, 6010812, 6034220, 6057628, 6057945, 6064106, 6067123, 6084024, 6170573, 6198358, 6261989, 6264897, 6265214, 6271375, 6274283, 6282363, 6285380, 6286244, 6303145, 6389694, 6418055, 6481276, 6524838, 6557252, 6600814, 6633136, 6663608, 6694080, 6724552, 6724869, 6731030, 6734047, 6750948, 6837497, 6865474, 6928599, 6931507, 6931824, 6937985, 6940893, 6948973, 6951990, 6952854, 6969755, 7056304, 7085049, 7148270, 7160566, 7278224, 7351918, 7362814]




curfolder = "E:\\Escritorio\\silvia\\car_model\\sylvia old\\output\\textures\\cockpit\\"
#curfolder = "E:\\Escritorio\\silvia\\car_model\\sylvia old\\output\\skins\\team a\\"
def dds_search():
    for i in range(eof):
        try:
            byte_test = f.readByte()
            if byte_test == 0x44:
                test_array = [f.readByte() for i in range(3)]
                f.seek(-3,1)
                if test_array == dds_array:
                    dds_pos.append(f.tell()-1)
                    
        except:
            pass #end of file
    for i in range(len(dds_pos)):
        cur = i
        f.seek(dds_pos[cur]-4)
        size = f.readInt()
        buffer = []
        cur_dds = curfolder+"texture_"+str(cur)+".dds"
        for i in range(size):
            buffer.append(f.readByte())
        file = open(cur_dds, 'w+b')
        binary_body = bytearray(buffer)
        file.write(binary_body)
        file.close()

#positions_search()
#dds_search()
#print(len(positions))
#print(hexl(flag_array[:-1]))

#sys.exit()
for i in range(len(positions)):
    cur = i
    f.seek(positions[cur]+7)
    loop = True
    cur_loop = 0
    while loop:
        cur_loop = cur_loop + 1
        try:
            byte_test = f.readByte()
            if byte_test == 0x2f:
                test_array = [f.readByte() for i in range(5)]
                f.seek(-5,1)
                if test_array == flag_array[:-1]:
                    f.seek(5,1)
                    loop = False
                    #print("header size = ", cur_loop+5)
                    #print("current end of header = ",f.tellHex(),"\t int after = ",hex(f.readInt()))
        except:
            print("some fucking error happened in item ", cur, positions[cur])
            pass #end of file
        if cur_loop == 100:
            print("loop limit exceeded")
            loop = False
            break
    #print(hex(f.readInt()))
    stride = f.readInt()
    version = f.readInt()#????
    vc = f.readInt()
    unknown = f.readInt()
    fic = f.readInt()
    verts = []
    faces = []
    uvs = []
    print("mesh "+str(cur),"special flag = "+str(version),f.tellHex(),stride,vc,fic)
    #print(f.tellHex())
    for i in range(vc):
        vert = tuple([round(f.readHalfFloat(),4) for i in range(3)])
        #print(vert)
        verts.append(vert)
        if stride > 20 and stride != 60:
            f.seek(14,1)#20
            uv = tuple([round(f.readHalfFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-24,1)
        elif stride <= 20:
            f.seek(2,1)
            uv = tuple([round(f.readHalfFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-12,1)
        elif stride == 60:
            f.seek(14,1)
            uv = tuple([round(f.readFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-28,1)
        else:
            sys.exit("what the fuck are these uvs?")
    #print(f.tellHex())
    for i in range(fic):
        fi = f.read3Int()
        faces.append(fi)
    curmesh = "Mesh_"+str(cur)
    mrp.create_mesh(curmesh)
    mesh = mrp.get_mesh(curmesh)
    mesh.set_vertices(verts)
    mesh.set_faces(faces)#,fm="TStripFF")
    mesh.set_uvs(uvs)#, tp="Float")
    mesh.set_uvs_indices(faces,fm="Triangles")#,fm="TStripFF")
    #mesh.set_normals(normals)
    mrp.render(curmesh)
    mrp.print_mesh(curmesh)
    meshes.append(curmesh)    
    
mrp.render(meshes)

sys.exit("end of code")

```


finally some screens of final result if done properly...(my script doesn't export materials, so you will have to find textures manually)







lastly another pro tip, the sounds could be theoretically extracted using ram dumps; I haven't tested if the march 2017 build allows to dump the sounds using the old method, it could work, I haven't tried yet.
## Post #117
- Username: portoalto
- Rank: n00b
- Number of posts: 15
- Joined date: Sat Apr 24, 2010 9:28 pm
- Post datetime: 2021-11-17T23:02:08+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Fri Oct 29, 2021 5:30 pm at Fri Oct 29, 2021 5:30 pm
>
> 
so after a review of this game i came to some interesting conclusion, maybe not perfect but still could be a help for many...


first of all the problem lies in the script for bms unpacking the .public files, they still use lzma2 but has some extra parameters that introduces a jump on the files that basically if you don't account it for your verts/textures will get totally ducked up. But, here the workaround for that, just go and grab the steam depot that is from 14 march 2017(google a bit and be careful of the tools you use, given r3e is free, i'd use another steam account to download the old depot; for you cannot use the steam console anymore for that). Once you have the old depot, the files will unpack correctly for that version, although there are not special tools that are able to unpack it from the get go I was able to code in python a script for mrp that works more or less good, this is by no means a final script and only works under my control of variables, if anyone is savvy enough of python and thinks they can modify the code to make it work, be welcome. (Just in case, I wont provide unpacked converted files in here.)


tip: there are 2 functions here I use to parse the file before I even can extract the geometry, one is to search for DDS textures and extract them to a "curfolder"; that you will need to change it(works for car_template, cockpit_template and liveries once all unpacked from .public) the second function that is for the positions will print in console the positions of the meshes in the file and generate the geometry based on the API of MRP.-

tip 2: this doesn't work for tracks for tracks have massive sizes, before being able to process tracks there will be need a better split method or using pure python(I think MRP is not suited to work on such big files).

I got a little lost.
1st - does that mean that your script cannot decrypt the new encryption of the files but only those from that date?
2nd - How can you download and install the version from that date? When you make a new account and try to install the game, you have to install steam and it only installs the latest version of the game
## Post #118
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2021-11-18T15:39:21+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

1st, its not my script, is bms script, the script has an algorithm to unpack all the contents inside the files; after some testing, not only the newer versions but already some of the cars released in 2017 are already compressed in another way, for example the Nissan r90ck, that one has a different type of file, after compression, which doesn't work with the script from bms = the file although can be used more or less, has a problem that there are jumps in the vertex pools that break the method for an automated 3d script.

2nd, you don't download the game per se in steam, steam doesn't allow downloading steam depots anymore, and that is the keyword there, steam depots. If you look up in google more about it, you will see that there are software/scripts made so you can download old depots, but as it is a way to give user/password to a third person you don't know, that's why I said its better to just create a fake account and add R3E to your new account library, before you can use any of those 3rd party software/scripts.
## Post #119
- Username: Foxbody
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Thu Mar 31, 2022 11:48 am
- Post datetime: 2022-03-31T04:02:50+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hello! I apologize if this isn't the right place to write this, but I am having trouble sourcing models and textures from Raceroom using QuickBMS.

I am trying to get the 1985 FORD MUSTANG IMSA GTO . Using the "raceroom.bms" script I am able to convert the files from kluns.public to .kluns. But upon using "raceroom_kluns.bms" to convert either textures or models, I get an error 
"Error: the requested amount of bytes to allocate is negative (0xb6ffbd00)

Last script line before the error or that produced the error:
  64  getdstring DUMMY DUMMYSZ
  coverage file 0     1%   699255     57673253   . offset 000aab79"

This I cannot convert the .kluns to .dds or the models to a usable format. 

I apologize in advance as I am not incredibly savvy with this process. Any help to convert these would be greatly appreciated. Thanks so much.
## Post #120
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2022-03-31T16:42:17+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Foxbody ↑Thu Mar 31, 2022 12:02 pm at Thu Mar 31, 2022 12:02 pm
>
> 
Hello! I apologize if this isn't the right place to write this, but I am having trouble sourcing models and textures from Raceroom using QuickBMS.

I am trying to get the 1985 FORD MUSTANG IMSA GTO . Using the "raceroom.bms" script I am able to convert the files from kluns.public to .kluns. But upon using "raceroom_kluns.bms" to convert either textures or models, I get an error 
"Error: the requested amount of bytes to allocate is negative (0xb6ffbd00)

Last script line before the error or that produced the error:
  64  getdstring DUMMY DUMMYSZ
  coverage file 0     1%   699255     57673253   . offset 000aab79"

This I cannot convert the .kluns to .dds or the models to a usable format. 

I apologize in advance as I am not incredibly savvy with this process. Any help to convert these would be greatly appreciated. Thanks so much.

well, that's exactly what the full post of the forum is meant to explain, next time better have a read first.... The issue is simple, the scripts were probably made somewhere before 2017, after 2017 they changed how the models are packed/compressed and it has some stuff that basically breaks the scripts cause now when unpacking there is data that should not be there that is just some garbage along the way, so yeah, scripts will only work if you get files that are old enough not to have been tampered with on the new game files... before you ask how, read a little bit, I wrote more or less a tutorial that should be useful if you can follow it, the mustan imsa GTO is one of the files that can be obtained (and no, dont bother asking me to share, i will not)
## Post #121
- Username: Foxbody
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Thu Mar 31, 2022 11:48 am
- Post datetime: 2022-04-02T03:23:57+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hi there, first of all I'd like to say thank you for the reply and I apologize for not looking closer. This is a bit overwhelming over my head but I have read these pages many times now trying to wrap my head around it better, digging trying to get some results. I started by using shakotay2's page 5 tutorial. I was able to generate h2o, then to obj's (which has lots of spiky mess in blender, regardless of redux or raw exe). I am just supremely lost at editing the converted data to a format that can be processed via hex editor for clean preview, I've tried the few YT tutorials and the built in tut. I am just struggling big time. 
I then sourced depot 211501 from March 14, 2017 as you listed to get a better operating klun.public/.klun situation. Unfortunately raceroom.bms generates completely empty .klun files. An issue I did not experience on the newer build that I am not sure what to go about, thus creating unusable .klun files. 

I am not going to lie, your attached "mrp" script in the post above I am really struggling to figure out how it plays into the process or how to use it. 

Again, I apologize as this is quite far from my forte, although I am really trying to better grasp the process to get this car and it's accompanying textures for a game project I have been working on for 2 years now. Thanks so much for your time and again I apologize for any ignorance on the topic.
## Post #122
- Username: Machinedramon
- Rank: advanced
- Number of posts: 77
- Joined date: Tue Apr 09, 2019 1:13 am
- Post datetime: 2022-04-03T16:42:54+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Foxbody ↑Sat Apr 02, 2022 11:23 am at Sat Apr 02, 2022 11:23 am
>
> 
Hi there, first of all I'd like to say thank you for the reply and I apologize for not looking closer. This is a bit overwhelming over my head but I have read these pages many times now trying to wrap my head around it better, digging trying to get some results. I started by using shakotay2's page 5 tutorial. I was able to generate h2o, then to obj's (which has lots of spiky mess in blender, regardless of redux or raw exe). I am just supremely lost at editing the converted data to a format that can be processed via hex editor for clean preview, I've tried the few YT tutorials and the built in tut. I am just struggling big time. 
I then sourced depot 211501 from March 14, 2017 as you listed to get a better operating klun.public/.klun situation. Unfortunately raceroom.bms generates completely empty .klun files. An issue I did not experience on the newer build that I am not sure what to go about, thus creating unusable .klun files. 

I am not going to lie, your attached "mrp" script in the post above I am really struggling to figure out how it plays into the process or how to use it. 

Again, I apologize as this is quite far from my forte, although I am really trying to better grasp the process to get this car and it's accompanying textures for a game project I have been working on for 2 years now. Thanks so much for your time and again I apologize for any ignorance on the topic.

The tutorial ShakoTay posted is pretty much a way to try and circumvent the garbage in the files, the MRP script is a script though to work on a program called Moder Researcher Pro, problem is that one is a payed program, I might have a look at it again and try to change the script into a standalone python somewhere along the line, but yeah, the textures and the models will either be broken with newer files, the tutorial of shako I'm not sure if its gonna work on the files of the old cars, and then also there is the problem that even if you had the correct files mrp is not for free...
## Post #123
- Username: saso
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Oct 10, 2014 7:42 pm
- Post datetime: 2023-01-27T17:55:48+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

Hello everyone I'm an Italian modder and I apologize for my English but I'm using the translator.
I know the topic is dated but I want to try to ask for help anyway.
I can't extract the internal textures of the car that I need, a few years ago I used Ninja Ripper but with the change of the hard disk all the files were deleted and now I don't know why Ninja ripper with Raceroom doesn't work anymore "maybe they put a protection"   
Can someone please help me to extract the internal textures of the car or explain me how to do it? I tried with the various Quick Bms scripts but I can't extract anything.
I am attaching the files but I don't know which is the right one of the internal textures of the cockpit and I am uploading all the Public files that are there
Many thanks to anyone who can help me

[https://www.mediafire.com/file/9t9w6ax6 ... me.7z/file](https://www.mediafire.com/file/9t9w6ax68alvcg6/Please+help+me.7z/file)
## Post #124
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2023-07-21T20:33:34+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

bump, somebody making one-click converter?
## Post #125
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2023-07-22T15:52:07+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from zimex25 ↑Sat Jul 22, 2023 4:33 am at Sat Jul 22, 2023 4:33 am
>
> 
bump, somebody making one-click converter?Haha, "one-click converters" for .kluns are out of stock.  

You're better off trying to get the model-of-your-interest the way Zangano did:

> Reply from Zangano ↑Wed Nov 04, 2020 6:34 am at Wed Nov 04, 2020 6:34 am
>
> 

(In case you have an interesting model I might give it a go. But don't expect too much.)
## Post #126
- Username: zimex25
- Rank: veteran
- Number of posts: 143
- Joined date: Fri Feb 05, 2016 4:20 am
- Post datetime: 2023-07-23T10:29:09+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from shakotay2 ↑Sat Jul 22, 2023 11:52 pm at Sat Jul 22, 2023 11:52 pm
>
> 
zimex25 wrote: ↑Sat Jul 22, 2023 4:33 am
bump, somebody making one-click converter?
Haha, "one-click converters" for .kluns are out of stock.  

You're better off trying to get the model-of-your-interest the way Zangano did:
Zangano wrote: ↑Wed Nov 04, 2020 6:34 am

(In case you have an interesting model I might give it a go. But don't expect too much.)

Your work was very important but imo the best converter will be "one click" because in this moment effect is this same like from Ninja Ripper.
## Post #127
- Username: JanB23
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Sun Feb 19, 2023 12:17 am
- Post datetime: 2023-09-26T23:03:09+00:00
- Post Title: Re: RaceRoom Racing Experience .kluns

> Reply from Machinedramon ↑Fri Oct 29, 2021 5:30 pm at Fri Oct 29, 2021 5:30 pm
>
> 
so after a review of this game i came to some interesting conclusion, maybe not perfect but still could be a help for many...


first of all the problem lies in the script for bms unpacking the .public files, they still use lzma2 but has some extra parameters that introduces a jump on the files that basically if you don't account it for your verts/textures will get totally ducked up. But, here the workaround for that, just go and grab the steam depot that is from 14 march 2017(google a bit and be careful of the tools you use, given r3e is free, i'd use another steam account to download the old depot; for you cannot use the steam console anymore for that). Once you have the old depot, the files will unpack correctly for that version, although there are not special tools that are able to unpack it from the get go I was able to code in python a script for mrp that works more or less good, this is by no means a final script and only works under my control of variables, if anyone is savvy enough of python and thinks they can modify the code to make it work, be welcome. (Just in case, I wont provide unpacked converted files in here.)


tip: there are 2 functions here I use to parse the file before I even can extract the geometry, one is to search for DDS textures and extract them to a "curfolder"; that you will need to change it(works for car_template, cockpit_template and liveries once all unpacked from .public) the second function that is for the positions will print in console the positions of the meshes in the file and generate the geometry based on the API of MRP.-

tip 2: this doesn't work for tracks for tracks have massive sizes, before being able to process tracks there will be need a better split method or using pure python(I think MRP is not suited to work on such big files).
Code: Select allimport mrp
import sys
from nines import *
f = mrp.get_bfile()

flag_array = [0x76 ,0x64 ,0x65 ,0x63 ,0x6C ,0x2F]
dds_array = [0x44 ,0x53 ,0x20]
dds_pos = []
positions = []
meshes = []


f.seek(0,2)
eof = f.tell()



f.seek(0)
def positions_search():
    for i in range(eof):
        try:
            byte_test = f.readByte()
            if byte_test == 0x2f:
                test_array = [f.readByte() for i in range(6)]
                f.seek(-6,1)
                if test_array == flag_array:
                    positions.append(f.tell()-1)
                    
        except:
            pass #end of file
            
    print(positions)
#------------------
#car silvia
#positions = [1054460, 1141186, 1182168, 1206030, 1241211, 2814624, 3583656, 3907010, 4327617, 4491844, 4536153, 4541726, 4560902, 4599182, 4599864, 4615904, 4729584, 4797377, 4815129, 4832881, 4850633, 4850950, 4853883, 4854130, 4858982, 4864270, 4867707, 4979600, 5012269, 5026962, 5063495, 5073563, 5073880, 5076837, 5086905, 5091793, 5095230, 5207243, 5239768, 5254461, 5290778, 5358372, 5387142, 5454736, 5483322, 5483639, 5486500, 5486697, 5491549, 5496837, 5500274, 5612167, 5644116, 5658809, 5695342, 5705410, 5705727, 5708708, 5718776, 5723664, 5727101, 5839090, 5871183, 5885876, 5922193, 7151679, 7154567, 7598201, 7598601, 7601533, 7854963, 8010845]
#cockpit silvia
#positions = [12586361, 12643287, 12839298, 13446622, 13448259, 13777777, 13779158, 13906890, 14082034, 14438510, 14766485, 14782807, 14783844, 14818022, 14819059, 14819976, 14821013, 14822050, 14823087, 14823284, 14824441, 14843166]
#-------------------
#car mustang imsa
positions = [1054468, 1141194, 1182176, 1206038, 1241648, 1286949, 1292109, 1324735, 1328663, 3431297, 3955457, 4644783, 5035256, 5165772, 5415566, 5422351, 5437343, 5453951, 5462387, 5622325, 5628637, 5766067, 5770855, 5908319, 5987404, 6010812, 6034220, 6057628, 6057945, 6064106, 6067123, 6084024, 6170573, 6198358, 6261989, 6264897, 6265214, 6271375, 6274283, 6282363, 6285380, 6286244, 6303145, 6389694, 6418055, 6481276, 6524838, 6557252, 6600814, 6633136, 6663608, 6694080, 6724552, 6724869, 6731030, 6734047, 6750948, 6837497, 6865474, 6928599, 6931507, 6931824, 6937985, 6940893, 6948973, 6951990, 6952854, 6969755, 7056304, 7085049, 7148270, 7160566, 7278224, 7351918, 7362814]




curfolder = "E:\\Escritorio\\silvia\\car_model\\sylvia old\\output\\textures\\cockpit\\"
#curfolder = "E:\\Escritorio\\silvia\\car_model\\sylvia old\\output\\skins\\team a\\"
def dds_search():
    for i in range(eof):
        try:
            byte_test = f.readByte()
            if byte_test == 0x44:
                test_array = [f.readByte() for i in range(3)]
                f.seek(-3,1)
                if test_array == dds_array:
                    dds_pos.append(f.tell()-1)
                    
        except:
            pass #end of file
    for i in range(len(dds_pos)):
        cur = i
        f.seek(dds_pos[cur]-4)
        size = f.readInt()
        buffer = []
        cur_dds = curfolder+"texture_"+str(cur)+".dds"
        for i in range(size):
            buffer.append(f.readByte())
        file = open(cur_dds, 'w+b')
        binary_body = bytearray(buffer)
        file.write(binary_body)
        file.close()

#positions_search()
#dds_search()
#print(len(positions))
#print(hexl(flag_array[:-1]))

#sys.exit()
for i in range(len(positions)):
    cur = i
    f.seek(positions[cur]+7)
    loop = True
    cur_loop = 0
    while loop:
        cur_loop = cur_loop + 1
        try:
            byte_test = f.readByte()
            if byte_test == 0x2f:
                test_array = [f.readByte() for i in range(5)]
                f.seek(-5,1)
                if test_array == flag_array[:-1]:
                    f.seek(5,1)
                    loop = False
                    #print("header size = ", cur_loop+5)
                    #print("current end of header = ",f.tellHex(),"\t int after = ",hex(f.readInt()))
        except:
            print("some fucking error happened in item ", cur, positions[cur])
            pass #end of file
        if cur_loop == 100:
            print("loop limit exceeded")
            loop = False
            break
    #print(hex(f.readInt()))
    stride = f.readInt()
    version = f.readInt()#????
    vc = f.readInt()
    unknown = f.readInt()
    fic = f.readInt()
    verts = []
    faces = []
    uvs = []
    print("mesh "+str(cur),"special flag = "+str(version),f.tellHex(),stride,vc,fic)
    #print(f.tellHex())
    for i in range(vc):
        vert = tuple([round(f.readHalfFloat(),4) for i in range(3)])
        #print(vert)
        verts.append(vert)
        if stride > 20 and stride != 60:
            f.seek(14,1)#20
            uv = tuple([round(f.readHalfFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-24,1)
        elif stride <= 20:
            f.seek(2,1)
            uv = tuple([round(f.readHalfFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-12,1)
        elif stride == 60:
            f.seek(14,1)
            uv = tuple([round(f.readFloat(),4) for i in range(2)])
            uvs.append(uv)
            f.seek(stride-28,1)
        else:
            sys.exit("what the fuck are these uvs?")
    #print(f.tellHex())
    for i in range(fic):
        fi = f.read3Int()
        faces.append(fi)
    curmesh = "Mesh_"+str(cur)
    mrp.create_mesh(curmesh)
    mesh = mrp.get_mesh(curmesh)
    mesh.set_vertices(verts)
    mesh.set_faces(faces)#,fm="TStripFF")
    mesh.set_uvs(uvs)#, tp="Float")
    mesh.set_uvs_indices(faces,fm="Triangles")#,fm="TStripFF")
    #mesh.set_normals(normals)
    mrp.render(curmesh)
    mrp.print_mesh(curmesh)
    meshes.append(curmesh)    
    
mrp.render(meshes)

sys.exit("end of code")


finally some screens of final result if done properly...(my script doesn't export materials, so you will have to find textures manually)







lastly another pro tip, the sounds could be theoretically extracted using ram dumps; I haven't tested if the march 2017 build allows to dump the sounds using the old method, it could work, I haven't tried yet.

Excuse me for bump an ancient theme but, MRP gave this error: 

Traceback (most recent call last):
  File "MR", line 3, in 
    from nines import *
ModuleNotFoundError: No module named 'nines'

Afaik i'm installed full phyton; can you help me please? thanks in advance (i'm understand if not, anyway thanks)
