## Post #1
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2015-11-04T18:08:44+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

Hello guys, 

About the game:
develoled by 3G Studios and published by Sierra.
Release date: October 26, 2007.
Special thanks: CarLuver69, shakotay2, Nick W and of course for everybody in XeNTaX forum. 

As you know with CarLuver69, shakotay2, Nick W 's help we can export files from the game's archive, so I've exported some .dob files 
I think these files are models.

Here is some sample file of it:

[http://www.mediafire.com/download/2m81x ... models.rar](http://www.mediafire.com/download/2m81x82uzpoyp2d/models.rar)

Thank you for help.
## Post #2
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2016-01-06T19:36:37+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

point cloud of swatvan looks like this:  (don't have the time to care for face indices)



swatvan_dob.jpg (76.12 KiB) Viewed 650 times
## Post #3
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2016-01-06T20:53:44+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

No problem thanks for help  


> Reply from shakotay2
>
> point cloud of swatvan looks like this:  (don't have the time to care for face indices)
swatvan_dob.jpg
## Post #4
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-01-07T05:52:14+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from shakotay2
>
> point cloud of swatvan looks like this:  (don't have the time to care for face indices)
-snip-
I would love to see how the face data is stored in this dob format, i have seen samples before where i could get a good point cloud but there was no clear face data shown. 

The 22 byte vertex pattern goes the entire length of the file so i guess the face data is inline with the vertex data but i have no idea how to set this in Hex2obj.
## Post #5
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2016-01-07T11:52:36+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

You'll need a fake tristripped face indices list:



fakeFIs-Tris.jpg (96.39 KiB) Viewed 616 times


(It's on my todo list.)
## Post #6
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2016-01-08T08:58:41+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

I just made a test with hr_nypd.dob model  



the vertex data started from: 490 and I used 8000 for count  

update: right count for verts is: 8247
## Post #7
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2016-01-08T19:39:31+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

Try adding tristripped face indices such like these:
f 1 2 3
f 2 4 3
f 3 4 5
f 4 6 5
f 5 6 7
f 6 8 7
f 7 8 9
[...]
f 8240 8242 8241
f 8241 8242 8243
f 8242 8244 8243
f 8243 8244 8245
f 8244 8246 8245
f 8245 8246 8247

to a test.obj file created when pressing the 'mesh' button in point cloud mode. (edit: new pic: Fake mode)



hr_nypd-dob.jpg (89.08 KiB) Viewed 526 times


There's different implementations of the tristripped algo thus it may come that we've some superfluous faces here because I used a very simple scheme:
a b c
b c+1 c

c c+1 c+2 (where you could substitue c:=a, c+1:=b, c+2:=c to gain the next line b c+1 c as above)

didn't check for all faces but seems to work:
8241 8242 8243
8242 8244 8243

8243 8244 8245 (a b c -> next face b c+1 c is 8244 8246 8245)

edit: I've updated hex2obj to version 0.24d to have those tristripped face indices autogenerated.
Since it's scarcely tested find it in a subpost as of 12th of June in the Extracting simple models thread.
## Post #8
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2016-08-15T13:55:27+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from shakotay2
>
> 
edit: I've updated hex2obj to version 0.24d to have those tristripped face indices autogenerated.
Since it's scarcely tested find it in a subpost as of 12th of June in the Extracting simple models thread.

Nice work with it 
I tested it and worked well, there are same faces messed up but it's working
## Post #9
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2017-06-24T20:51:45+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

Hello all,

For this project I opened a Github repo and uploaded the existing code.

[https://github.com/Sleepy93/swat-tl-editor](https://github.com/Sleepy93/swat-tl-editor)

Today I've updated the code with added 3D model exporting support.
It's not the best so every help will be useful and I'll be really glad to get some help about it.

For more information please read the Github Readme.md.

Thanks,

Sleepy
## Post #10
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2017-06-29T11:05:37+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

Hi Sleepy,
nice to see your progress.  
After drive selection your program expects the path "PSP_GAME" to be present.
If not, nothing happens. (Maybe you should check for the folder to exist?)

I created that folder, then copied swatvan.dob to it which could be loaded and exported to obj.

Checking the obj I found vertices for the wheels only, and no face indices.
Am I missing something?
## Post #11
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2017-06-29T11:58:44+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from shakotay2
>
> Hi Sleepy,
nice to see your progress.  
After drive selection your program expects the path "PSP_GAME" to be present.
If not, nothing happens. (Maybe you should check for the folder to exist?)

I created that folder, then copied swatvan.dob to it which could be loaded and exported to obj.

Checking the obj I found vertices for the wheels only, and no face indices.
Am I missing something?

Thanks for your reply  

On the next weekend I'll work on the tool.
Nowadays I'm a bit busy.

Carluver69 helped on re-search so now I understand where and how the data stored.
Now I can calculate the number of verts etc.

Thanks again.
## Post #12
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2017-06-29T13:32:15+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Sleepy
>
> Nowadays I'm a bit busy.no problem. 

I had a deeper look at your project, introduced a vertex count and found that it was ok: 1136 (well, 1135 is better)
(dunno why blender showed the wheels only in a point cloud  )

I added/copypasted tristripped face indices (from hex2obj) and realized a scaling problem (upper part of picture).

did some adaptions to your function void Export_OBJ()

br.BaseStream.Position = 0xCA-1;
(since I didn't understand why you read this byte: br.ReadByte();
and wanted to leave it unchanged, so had to start one byte earlier)

In the while loop while (br.PeekChar() > -1)
I adapted this:

```
		float fx, fy, fz ;

		br.ReadByte();
		x = br.ReadUInt16(); fx = (float)(x / 256.0); if (fx >= 128.0) fx -= (float) 256.0;
		y = br.ReadUInt16(); fy = (float)(y / 256.0); if (fy >= 128.0) fy -= (float) 256.0;
		z = br.ReadUInt16(); fz = (float)(z / 256.0); if (fz >= 128.0) fz -= (float) 256.0;
		sw.WriteLine("v {0} {1} {2}", fx.ToString(System.Globalization.CultureInfo.InvariantCulture), fy.ToString(System.Globalization.CultureInfo.InvariantCulture), fz.ToString(System.Globalization.CultureInfo.InvariantCulture));
```

which resulted in the lower part of the picture.



swatvan-dob-scaling.jpg (227.59 KiB) Viewed 436 times


edit: introduced code for the uvs but as you can see from the picture there's too many connections  

remark: you might replace "(System.Globalization.CultureInfo.InvariantCulture)" by "()"
I had to use it to avoid commas to be logged to the obj file instead of points.
## Post #13
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2017-06-29T20:38:01+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from shakotay2
>
> Sleepy wrote:Nowadays I'm a bit busy.no problem. 

I had a deeper look at your project, introduced a vertex count and found that it was ok: 1136 (well, 1135 is better)
(dunno why blender showed the wheels only in a point cloud  )

I added/copypasted tristripped face indices (from hex2obj) and realized a scaling problem (upper part of picture).

did some adaptions to your function void Export_OBJ()

br.BaseStream.Position = 0xCA-1;
(since I didn't understand why you read this byte: br.ReadByte();
and wanted to leave it unchanged, so had to start one byte earlier)

In the while loop while (br.PeekChar() > -1)
I adapted this:
Code: Select all		ushort x, y, z;
		float fx, fy, fz ;

		br.ReadByte();
		x = br.ReadUInt16(); fx = (float)(x / 256.0); if (fx >= 128.0) fx -= (float) 256.0;
		y = br.ReadUInt16(); fy = (float)(y / 256.0); if (fy >= 128.0) fy -= (float) 256.0;
		z = br.ReadUInt16(); fz = (float)(z / 256.0); if (fz >= 128.0) fz -= (float) 256.0;
		sw.WriteLine("v {0} {1} {2}", fx.ToString(System.Globalization.CultureInfo.InvariantCulture), fy.ToString(System.Globalization.CultureInfo.InvariantCulture), fz.ToString(System.Globalization.CultureInfo.InvariantCulture));
which resulted in the lower part of the picture.
swatvan-dob-scaling.jpg
edit: introduced code for the uvs but as you can see from the picture there's too many connections  

remark: you might replace "(System.Globalization.CultureInfo.InvariantCulture)" by "()"
I had to use it to avoid commas to be logged to the obj file instead of points.

Thanks I replaced in the code the verts coords convertion.
I'll do the next updates at the weekend  

By the way I hope the face generating once will be well.
## Post #14
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2023-01-03T13:18:04+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

Dear all  

Github repo is updated.
summarizes the change of the code:

As shakotay2 advised:
PSP_GAME folder check is added - if it can't find than program throws InvalidDataException("PSP_GAME Folder Does not exists").

Based on my re-search I've added support different type of models (01 - SingleModel, 24 - MAP object, 25 - Character) 
Which model has zeros as the number of animation but has animation offset it means that there is .anm file next to the dob model in the LMP archive.

Carluver69 made some improvements on the code and regarding to it I've done some additional research of the dob files.
Currently working on fixing the export obj function because using the vertex pointer it reads wrong verts coords...
The old exporter is commented out and tried to use that one which carluver69 re-wrote.

[https://github.com/Sleepy93/swat-tl-edi ... xporter.cs](https://github.com/Sleepy93/swat-tl-editor/blob/master/SwatTL-Editor/Exporter.cs)

As I could see in case of swatvan.dob:

The offset of verts regarding to the reading of file is: 0xD0...
however regarding to what works in (hex2obj) the start of the  vertex block is 0xCA

If we read the model from 0xCA than there is a flying vertex and it is connected to the chassis maybe it would be siren.. just not in right position  

 

If i check hr_nypd.dob than:
The verts offset is: 0x480
however in hex2obj we can only read the model well if the offset is 0x490

with hr_nypd.dob checked some options with uv mapping and it is flipped maybe it could caused by the scaling problem which is already mentioned 
hex2obj settings:


UV mapping:


Texture:


I've checked a map level with hex2obj but I didn't find yet how it should show well.
I've uploaded a sample file of it:
[https://www.mediafire.com/file/oi0qngz2 ... a.dob/file](https://www.mediafire.com/file/oi0qngz21tquw9d/lev01mapa.dob/file)
## Post #15
- Username: Durik256
- Rank: ultra-veteran
- Number of posts: 429
- Joined date: Thu Nov 22, 2018 2:26 am
- Post datetime: 2023-01-04T03:09:39+00:00
- Post Title: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Sleepy ↑Tue Jan 03, 2023 9:18 pm at Tue Jan 03, 2023 9:18 pm
>
> 
Dear all   I've uploaded a sample file
I quickly made a plugin for Noesis:

there are "zero" invisible faces:

[fmt_dob.zip](https://xentaxbackup.github.io/file/23252_fmt_dob.zip)
## Post #16
- Username: Durik256
- Rank: ultra-veteran
- Number of posts: 429
- Joined date: Thu Nov 22, 2018 2:26 am
- Post datetime: 2023-01-05T01:20:11+00:00
- Post Title: Re: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Sleepy ↑Tue Jan 03, 2023 9:18 pm at Tue Jan 03, 2023 9:18 pm
>
> 
dob/file

since you are using c#. i made a console application for dob to obj conversion. just drag and drop the file onto the exe. the source code is also in the archive.

*(I made changes on your github. I would do everything differently) 
[DOB2OBJ.zip](https://xentaxbackup.github.io/file/23256_DOB2OBJ.zip)
## Post #17
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2023-01-05T07:08:33+00:00
- Post Title: Re: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Durik256 ↑Thu Jan 05, 2023 9:20 am at Thu Jan 05, 2023 9:20 am
>
> 
Sleepy wrote: ↑Tue Jan 03, 2023 9:18 pm
dob/file


since you are using c#. i made a console application for dob to obj conversion. just drag and drop the file onto the exe. the source code is also in the archive.

*(I made changes on your github. I would do everything differently)

It is so cool  thank you.
## Post #18
- Username: Durik256
- Rank: ultra-veteran
- Number of posts: 429
- Joined date: Thu Nov 22, 2018 2:26 am
- Post datetime: 2023-01-06T02:16:57+00:00
- Post Title: Re: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Sleepy ↑Thu Jan 05, 2023 3:08 pm at Thu Jan 05, 2023 3:08 pm
>
> 
It is so cool  thank you.

i download ROM   
i made plugin for Noesis for .LMP, and unpak all with batch process.

noticed a lot of .AWF files. you didn't describe them, its VAG audio file 
spec: [http://wiki.xentax.com/index.php/VAG_Audio](http://wiki.xentax.com/index.php/VAG_Audio)

using MFAudio v1.1 create wav
[S_MMENUout.objmenu_music.awf](https://drive.google.com/file/d/1XITFJaOhmhLUsPBUqgMjUwW-qOdJhejR/view?usp=share_link)
[screen](https://imgur.com/v6cGgyB)

I also made a plugin for Noesis for .TEX texture. (opens all textures with and without a palette)

there is also one .WOB file, this is also a 3d model, I made a plugin for it too.  
VEHICLESout.objforklift.wob


I also noticed a few .MDL, are the same .DOB (slightly different)

maybe you knew it all. this is just what I noticed on a quick inspection


 fmt_TEX_LMP_WOB.zip
(1.76 KiB) Downloaded 18 times
## Post #19
- Username: Sleepy
- Rank: beginner
- Number of posts: 20
- Joined date: Tue Jun 23, 2015 1:59 am
- Post datetime: 2023-01-06T06:58:52+00:00
- Post Title: Re: S.W.A.T. Target Liberty (*.dob) models.

Thank you,
As I can see mdl is a kind of dob model without the magic of dob and the data is shortened from 34 to 18.

About wob it has the path for texture.... hovewer they left the original path... C:\AssetServer\Projects\SWAT_PSP\Art_Exports\Props\Vehicles\Texture\forklift.tga

by the way as I can see every model has one texture
filename.tex they are not referenced in the dob models but some of them the game loads them with the same name of model.

example: 
globe.dob , globe.tex
hello_littlebird.dob hello_littlebird.tex

Some of them which are not the same I could see that loads the game with the lua script.
swatvan.dob
swat_van_tex.tex

boat.dob
boat_512.tex

h_res_mmlev01.dob
h_rez_multi_male_128.tex


I didn't know the .AWF files is VAG Audio so thank you for that information.

I've checked the Noesis plugins they are so cool
## Post #20
- Username: Durik256
- Rank: ultra-veteran
- Number of posts: 429
- Joined date: Thu Nov 22, 2018 2:26 am
- Post datetime: 2023-01-08T00:59:03+00:00
- Post Title: Re: S.W.A.T. Target Liberty (*.dob) models.

> Reply from Sleepy ↑Fri Jan 06, 2023 2:58 pm at Fri Jan 06, 2023 2:58 pm
>
> 
Thank you, I've checked the Noesis plugins they are so cool
  

today was free time. added bones and weights for DOB (not easy)

also added TEX export (version without palette and without swizzle)

that's all
