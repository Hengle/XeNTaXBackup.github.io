## Post #1
- Username: Kanbara
- Rank: advanced
- Number of posts: 55
- Joined date: Wed Oct 09, 2019 8:57 pm
- Post datetime: 2023-09-21T01:39:15+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

A new android mobile game for CCS was released!!
To my knowledge, this game is made by unity3d engine.
As I tried to extracted the models and textures from the .apk, it seems that all the assets are encrypted  


Wieredly, the files are quite normal, which means they did not pack the assets into assetbundle. The textures are ".png" or ".tga" and the models are either ".mesh" or ".fbx". What confuses me most is they CANNOT OPEN, let alone edit them  





Here are some samples from the game
[https://mega.nz/file/9KhGgT5D#uGwZTi5jt ... lAOGt1aXsg](https://mega.nz/file/9KhGgT5D#uGwZTi5jtCrxY-L3vXGLzWXHKDJBCI-AjlAOGt1aXsg)

You can also download the game from its official website
[https://sakura.qingcijoy.com/index.html?type=bdpz](https://sakura.qingcijoy.com/index.html?type=bdpz)

I would really appreciate it if anyone could help me figure it out!
## Post #2
- Username: Karpati
- Rank: ultra-veteran
- Number of posts: 467
- Joined date: Fri Dec 08, 2006 6:25 am
- Post datetime: 2023-09-21T07:17:41+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

It seems all files (.mesh, .fbx, etc) are encrypted.
## Post #3
- Username: Kanbara
- Rank: advanced
- Number of posts: 55
- Joined date: Wed Oct 09, 2019 8:57 pm
- Post datetime: 2023-09-21T09:00:15+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

> Reply from Karpati ↑Thu Sep 21, 2023 3:17 pm at Thu Sep 21, 2023 3:17 pm
>
> 
It seems all files (.mesh, .fbx, etc) are encrypted.

Yes, and I don't know where to start. I mean these files looks pretty common and I have no idea what to do with them. I don't even know what I should serach on google
## Post #4
- Username: andree
- Rank: veteran
- Number of posts: 149
- Joined date: Sun Jul 09, 2017 8:36 pm
- Post datetime: 2023-09-21T13:06:41+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

It should work with this.
[viewtopic.php?p=190486#p190486](https://forum.xentax.com/viewtopic.php?p=190486#p190486)
## Post #5
- Username: Kanbara
- Rank: advanced
- Number of posts: 55
- Joined date: Wed Oct 09, 2019 8:57 pm
- Post datetime: 2023-09-21T16:05:14+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

> Reply from andree ↑Thu Sep 21, 2023 9:06 pm at Thu Sep 21, 2023 9:06 pm
>
> 
It should work with this.
viewtopic.php?p=190486#p190486

Oh my god! It works like a charm!!
Thanks for your answer!
## Post #6
- Username: xlacie
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Tue Oct 03, 2023 12:31 pm
- Post datetime: 2023-10-03T04:34:00+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

Hi I've come across the same problem when extracting the files for myself, I understand andree sent a link about Python? I feel embarrassed to say this but I'm not sure what or how to use that and so I've come here in hopes someone could help walk me through it a little better please?
## Post #7
- Username: modmicer
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Wed Oct 04, 2023 5:25 am
- Post datetime: 2023-10-03T21:39:46+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

> Reply from andree ↑Thu Sep 21, 2023 9:06 pm at Thu Sep 21, 2023 9:06 pm
>
> 
It should work with this.
viewtopic.php?p=190486#p190486

How do you use this is there a guide on how to do this!
## Post #8
- Username: kittycat1506
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Oct 06, 2023 7:51 pm
- Post datetime: 2023-10-06T12:06:31+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

if anyone could figure out how to use the python code it would be greatly appreciated! Got the output .dat file but not sure how to make that work in blender.
## Post #9
- Username: xlacie
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Tue Oct 03, 2023 12:31 pm
- Post datetime: 2023-10-07T05:11:54+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

I'm thinking of message Andree perhaps? As I messaged OP about it and was left on read sadly with no help at all.
## Post #10
- Username: kittycat1506
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Oct 06, 2023 7:51 pm
- Post datetime: 2023-10-08T08:53:00+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

> Reply from xlacie ↑Sat Oct 07, 2023 1:11 pm at Sat Oct 07, 2023 1:11 pm
>
> 
I'm thinking of message Andree perhaps? As I messaged OP about it and was left on read sadly with no help at all.

Tried messaging Andree but no response either it seems :/
## Post #11
- Username: Vishwa
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Thu Jun 23, 2022 9:09 pm
- Post datetime: 2023-10-09T14:10:38+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

> Reply from kittycat1506 ↑Sun Oct 08, 2023 4:53 pm at Sun Oct 08, 2023 4:53 pm
>
> 
Tried messaging Andree but no response either it seems :/

Hello I tried dming you on discord as "Tsubasa" but since I didn't receive a response, I'll say it here:
The python script is for decrypting each files which spits out a decrypted.dat files and then after getting them load it onto asset studio and extract it, that way you can use it on blender or maya or unity
## Post #12
- Username: kittycat1506
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Oct 06, 2023 7:51 pm
- Post datetime: 2023-10-11T16:57:12+00:00
- Post Title: [Unity3D] Cardcaptor Sakura : Key of Memories assets encrypted

For anyone who is still confused on how to use the Python code, all you have to do is go to the python website and install any version of python. After the installation, open up IDLE (Python x.x 32-bit/64-bit), Ctrl+N to open a new file, paste the code in, change the path of the file after pt=r, save the file somewhere you can find it, then press F5 to run it. This should output a decrypted.dat file whereever you saved your python code, now just open the .dat file with AssetStudio and you should be good to go! 
I managed to find Joseph who wrote the code on the UnityPy Discord, and he helped me modify it to make it work (with some errors in AssetStudio) in batch of folders. Same thing goes, change the path of the folder where the assets are sitting in (make sure everything in there are files you want to be decrypted) and run it. After running, it should create a file in the same place the original files are sitting in, except with a _dec added at the end. To open, just choose File>Load folder in AssetStudio and you should be able to see everything in the Asset List. Gl!

```

def invert_xor(data: memoryview):
    end_index = len(data) - 1
    for i in range(1024):
        data[i] ^= data[end_index]
        end_index -= 1

if __name__ == '__main__':
    input_path = r"C:\Users\Hello\OneDrive\Desktop\prop"  # input path to the folder with encrypted files

    for root, _, files in os.walk(input_path):
        for file in files:
            name = os.path.basename(file).rsplit(".", 1)[0] + "_dec"
            pth = os.path.join(root, file)
            into = os.path.join(root, name)
            enc_file = open(pth, "rb").read()
            enc_file = memoryview(bytearray(enc_file))
            invert_xor(enc_file)
            print(f'Decrypted File: "{pth}", into {into}')
            open(into, "wb").write(enc_file)
    input('Press ENTER to exit..')
```
