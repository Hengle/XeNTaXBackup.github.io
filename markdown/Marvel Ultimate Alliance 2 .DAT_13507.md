## Post #1
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-07T19:42:52+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture? i would appreciate it 

Sample: [Here](https://mega.nz/#!RQgmDCyS!dd6t4Qd8u22OQTpY7mdGxAcxOWD6gzfCQm-NJ1AWDiU)

Added other textures to archive.
## Post #2
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2015-11-07T21:37:27+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

I don't know about the textures but 00000003.dat looks like a model of Deadpool   

this is the first of 3 submeshes
 

heres the h2o files for all 3 submeshes

0x11728 8190
Vb1
36 16
0x4 1985
120100
0x0 255

0x33934 13722
Vb1
36 16
0x15724 3428
120100
0x0 255

0x3CE98 1254
Vb1
36 16
0x3A468 300
120100
0x0 255
## Post #3
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-08T06:03:42+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> I don't know about the textures but 00000003.dat looks like a model of Deadpool   

this is the first of 3 submeshes
 

heres the h2o files for all 3 submeshes

0x11728 8190
Vb1
36 16
0x4 1985
120100
0x0 255

0x33934 13722
Vb1
36 16
0x15724 3428
120100
0x0 255

0x3CE98 1254
Vb1
36 16
0x3A468 300
120100
0x0 255

Oh gosh   
Unfortunately i definetly don't understand how to use this programme, but i'll try. Thank you a lot, you encouraged me with your post!
## Post #4
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-08T06:24:53+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

OH GOD FINNALY I GOT HIM THANK YOU A LOT FOR YOUR HELP MAN!  


Now only textures are left.
## Post #5
- Username: LarsMasters
- Rank: beginner
- Number of posts: 28
- Joined date: Mon Aug 25, 2014 10:30 am
- Post datetime: 2015-11-08T16:29:44+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

Which is it? 360 or PS3?

Sometimes i wish there's chance for MUA 360 one for Gold Edition model rips
## Post #6
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-08T16:35:31+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from LarsMasters
>
> Which is it? 360 or PS3?

Sometimes i wish there's chance for MUA 360 one for Gold Edition model rips

That's from Xbox360 version. Models from Gold edition differs from default MUA models?
## Post #7
- Username: LarsMasters
- Rank: beginner
- Number of posts: 28
- Joined date: Mon Aug 25, 2014 10:30 am
- Post datetime: 2015-11-08T16:40:13+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

IGB was it? for MUA1? Yes it is
## Post #8
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-08T16:41:08+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from LarsMasters
>
> IGB was it? for MUA1? Yes it is

I thought there's already models from MUA 1 PC version
## Post #9
- Username: LarsMasters
- Rank: beginner
- Number of posts: 28
- Joined date: Mon Aug 25, 2014 10:30 am
- Post datetime: 2015-11-08T16:59:16+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

Except the ones that are exclusives to Xbox 360. Gold Edition/DLC models (characters & their separate model parts (like Venom's tongue, Nightcrawler's tail, & Hawkeye's arrow) + character select's mannequins + character select stage), very high quality as MUA PC, but for XML2 veterans who became DLC like Cyclops, Nightcrawler, Magneto & Sabretooth are way more than their XML2 PC ones

For PSP exclusives, whose character models (which are way more HQ) also in Wii can be exported through some exporting software, & i dunno how. Dark_Mark & BLAW knows it

It is really sucks that no one ports those console content exclusive stuffs
## Post #10
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2015-11-11T18:50:28+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from LarsMasters
>
> Except the ones that are exclusives to Xbox 360. Gold Edition/DLC models (characters & their separate model parts (like Venom's tongue, Nightcrawler's tail, & Hawkeye's arrow) + character select's mannequins + character select stage), very high quality as MUA PC, but for XML2 veterans who became DLC like Cyclops, Nightcrawler, Magneto & Sabretooth are way more than their XML2 PC ones

For PSP exclusives, whose character models (which are way more HQ) also in Wii can be exported through some exporting software, & i dunno how. Dark_Mark & BLAW knows it

It is really sucks that no one ports those console content exclusive stuffs

i saw you wrote that it is possible to run this game on xenia xbox 360 emulator. If yes maybe i'll take a look on it and try to rip some models for you.
## Post #11
- Username: LarsMasters
- Rank: beginner
- Number of posts: 28
- Joined date: Mon Aug 25, 2014 10:30 am
- Post datetime: 2016-01-25T15:04:17+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

However. There some condition in order to be able to rip those GE models, like:
*Latest Emulator version that would make this game work on
*Windows 8-onwards
*Advance Graphic Card (particularly known for nvidia user. as for AMD user like me remained unknown. TT__TT)

Just got an info from the user who already test it
## Post #12
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-02-08T12:41:28+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from pechenko121
>
> Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture?



textures finally converted thanks to project code-named "uniswizzle"
## Post #13
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-02-08T20:25:43+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> pechenko121 wrote:Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture?



textures finally converted thanks to project code-named "uniswizzle"
youare... just god     . How did you do that?
Can you share this files or describe how you got textures?
Thanks
## Post #14
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-02-09T01:17:11+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

To convert the textures i just used the SWBF3 script from here
[viewtopic.php?p=115660#p115660](http://forum.xentax.com/viewtopic.php?p=115660#p115660)

and adapted it to these textures. I removed all the zero padding at the beginning and end of the texture and to prepare it before opening in Noesis and used the file size to guess the width and height.
## Post #15
- Username: napoleon321
- Rank: advanced
- Number of posts: 60
- Joined date: Tue Nov 16, 2010 7:11 pm
- Post datetime: 2016-02-10T15:04:18+00:00
- Post Title: Marvel Ultimate Alliance 2 .DAT

Hmm.. Ace can you share the edited script?
## Post #16
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-02-10T15:52:56+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Its the same script, i just changed the setting for image type, width and height in the script for these textures and also renamed the texture extension from dat to x2t just so Noesis would recognize them from the script, but you are free to change anything in there to make it easier for you.
## Post #17
- Username: logansan25
- Rank: veteran
- Number of posts: 138
- Joined date: Mon Oct 04, 2010 8:15 am
- Post datetime: 2016-02-12T19:56:28+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> Its the same script, i just changed the setting for image type, width and height in the script for these textures and also renamed the texture extension from dat to x2t just so Noesis would recognize them from the script, but you are free to change anything in there to make it easier for you.

Any tutorial for extract this files?
## Post #18
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-02-13T07:18:27+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

I don't think there is one, i just been playing around with the samples in this thread.   
aluigi made a script for QuickBMS to extract dat files from the X360 pak archives
[http://zenhax.com/viewtopic.php?p=2136#p2136](http://zenhax.com/viewtopic.php?p=2136#p2136)
## Post #19
- Username: JulioCabral
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sat Nov 28, 2015 7:14 am
- Post datetime: 2016-03-01T21:40:28+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from pechenko121
>
> Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture? i would appreciate it 

Sample: Here

Added other textures to archive.

Hello, sorry to bother. Here it say that there's a script to extract igz files? Where can I find it?.
## Post #20
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-03-29T04:23:51+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from pechenko121
>
> Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture? i would appreciate it 

Sample: Here

Added other textures to archive.

I made a Noesis plugin that works with your texture samples just for fun  


 tex_MUA2_dat.zip
(720 Bytes) Downloaded 122 times



it will open the diffuse, normal and specular textures but your normal map textures are corrupt or something and the specular textures are reddish so i don't know if that is my fault or just the way they are in that game.
## Post #21
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-03-29T13:26:39+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> pechenko121 wrote:Hello guys. That's me again. Luigi made script that extrats content of MUA2 igz files and everything is give is .dat files.  Can somebody please try to convert this files into readeble model and texture? i would appreciate it 

Sample: Here

Added other textures to archive.

I made a Noesis plugin that works with your texture samples just for fun  
tex_MUA2_dat.zip

it will open the diffuse, normal and specular textures but your normal map textures are corrupt or something and the specular textures are reddish so i don't know if that is my fault or just the way they are in that game.

oh, thank you 
Yeah, it seems that normals are corrupted, Luigi said that some files extracted from .pak archieves of game will be corrupted. Every time its normal maps
## Post #22
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-04-26T04:14:23+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from pechenko121
>
> Luigi said that some files extracted from .pak archieves of game will be corrupted. Every time its normal maps

I recently stumbled on those archives, and I think I can extract them correctly. If you still need it.
## Post #23
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-04-28T10:40:58+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from daemon1
>
> pechenko121 wrote:Luigi said that some files extracted from .pak archieves of game will be corrupted. Every time its normal maps 

I recently stumbled on those archives, and I think I can extract them correctly. If you still need it.

Oh i think that would be nice if you could do that
## Post #24
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-04-28T15:50:59+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Then can you point me at the link with archives you still need to extract.
## Post #25
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-04-28T18:55:33+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Just as i thought. Like in other IGA_ archives, these "unsupported" chunks are just uncompressed. Now I need some time to figure out how to support it in script.
## Post #26
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-04-28T20:08:43+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from daemon1
>
> Just as i thought. Like in other IGA_ archives, these "unsupported" chunks are just uncompressed. Now I need some time to figure out how to support it in script.

nice to see that!
## Post #27
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-05-02T16:33:34+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Sorry, I'm a little busy here with Star Sapphire extraction. But when I finish with her, MUA2 is next in my queue.
## Post #28
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-05-03T17:36:49+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Here's the tool for the Deadpool. Must extract all of the game archives now.

Notify me of any errors. The method they used to determine which files may be not-compressed was rather strange.
[Deadpool.rar](https://xentaxbackup.github.io/file/10886_Deadpool.rar)
## Post #29
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-05-05T15:10:33+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

So if the tool is working for all files, let me know. I will publish it in a new thread, so it won't be lost.
## Post #30
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-05T20:37:15+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from daemon1
>
> So if the tool is working for all files, let me know. I will publish it in a new thread, so it won't be lost.

sorry for late reply. Yes i used your tool, it extracted everything from archieves. But i have some difficulties with extracting textures from igz files. I used Luigi's igz extract script, then I used AceWell script for noesis, but it gave me an error. Maybe i did something wrong?
## Post #31
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-05-06T05:08:04+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

I don't have this game so i downloaded the deadpool_1702.pak sample from here 
[http://zenhax.com/viewtopic.php?p=2133#p2133](http://zenhax.com/viewtopic.php?p=2133#p2133)
and extracted contents from the pak with daemon1's tool and i made a new script still incomplete but will open most of the igz textures as they were extracted from the pak. 
i'm having difficulty with the format id of each texture so only a couple won't open.

script removed see this post
[viewtopic.php?p=118479#p118479](http://forum.xentax.com/viewtopic.php?p=118479#p118479)

leave the original igz intact because it contains some header info needed for the texture to display with right width and height.
## Post #32
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-06T09:39:26+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> I don't have this game so i downloaded the deadpool_1702.pak sample from here 
http://zenhax.com/viewtopic.php?p=2133#p2133
and extracted contents from the pak with daemon1's tool and i made a new script still incomplete but will open most of the igz textures as they were extracted from the pak. 
i'm having difficulty with the format id of each texture so only a couple won't open.
tex_MarvelUltimateAlliance2_igz.zip

leave the original igz intact because it contains some header info needed for the texture to display with right width and height.

Gonna give it a try a bit later this day, thank you
## Post #33
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-06T12:54:48+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> I don't have this game so i downloaded the deadpool_1702.pak sample from here 
http://zenhax.com/viewtopic.php?p=2133#p2133
and extracted contents from the pak with daemon1's tool and i made a new script still incomplete but will open most of the igz textures as they were extracted from the pak. 
i'm having difficulty with the format id of each texture so only a couple won't open.
tex_MarvelUltimateAlliance2_igz.zip

leave the original igz intact because it contains some header info needed for the texture to display with right width and height.

So i gave it a try. Some textures opened correctly. But some of them looks like this:


And for some textures it gave me an error:
## Post #34
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-06T13:03:47+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

most of the normals i tried looks like this:


i can upload more archieves if needed.
## Post #35
- Username: daemon1
- Rank: MEGAVETERAN
- Number of posts: 2649
- Joined date: Wed Mar 25, 2015 3:12 am
- Post datetime: 2016-05-06T16:20:50+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from pechenko121
>
> daemon1 wrote:I used Luigi's igz extract script

Where can I get this script?
## Post #36
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-07T10:51:14+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from daemon1
>
> pechenko121 wrote:daemon1 wrote:I used Luigi's igz extract script

Where can I get this script?

```
idstring "IGZ\x01"
get FILES long
for i = 0 < FILES
    get DUMMY long
    get NAME_OFF long
    get OFFSET long
    get SIZE long
    log "" OFFSET SIZE
next i
```
## Post #37
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-05-07T11:20:32+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

here is version 2 of the igz texture script 


 tex_MarvelUltimateAlliance2_igz.zip
(906 Bytes) Downloaded 92 times



it turned out to be a different 8 byte hash representing the 3 formats used  
supports dxt1, dxt5, ati2
this one should work for all of the igz textures, let me know if not
## Post #38
- Username: pechenko121
- Rank: advanced
- Number of posts: 48
- Joined date: Sat Dec 06, 2014 8:04 pm
- Post datetime: 2016-05-07T11:37:10+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> here is version 2 of the igz texture script 
tex_MarvelUltimateAlliance2_igz.zip

it turned out to be a different 8 byte hash representing the 3 formats used  
supports dxt1, dxt5, ati2
this one should work for all of the igz textures, let me know if not

everything is fine now, thank you
## Post #39
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-01T02:09:51+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Hey all, very new to this so forgive me if this is a simple question.  I'm haveing trouble just using HexToOBJ to convert the dat files to 2d models.  I've been trying it out on 1101.igz (Black Panther) and used the script pechenko provided to convert to .dat files (5 of them, although most are empty/useless).  But I'm just banging my head against it trying to extract the mesh.  Does anybody know something I might be missing?
## Post #40
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-01T03:02:59+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Can you share this 1101.igz sample you're working with? We can tell you for sure what you need to do  

edit
ah wait, are you working with the MUA PC version files?
[http://zenhax.com/viewtopic.php?f=9&t=2830](http://zenhax.com/viewtopic.php?f=9&t=2830)
i haven't looked at any of those yet, they might be different to the 360 files
## Post #41
- Username: Rutabaga
- Rank: veteran
- Number of posts: 115
- Joined date: Tue Jan 26, 2016 9:26 pm
- Post datetime: 2016-08-01T08:18:25+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Well,can you take a look in this file format for PC version?
Samples here: [https://mega.nz/#!CgAAVQiD!nc6Ttc-nEtCI ... Mi8xTs9tHs](https://mega.nz/#!CgAAVQiD!nc6Ttc-nEtCI_sUJcQdQVtVJ5z2a_rVYiMi8xTs9tHs)
Thanks in advance!
## Post #42
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-01T15:43:56+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> Can you share this 1101.igz sample you're working with? We can tell you for sure what you need to do  

edit
ah wait, are you working with the MUA PC version files?
http://zenhax.com/viewtopic.php?f=9&t=2830
i haven't looked at any of those yet, they might be different to the 360 files

Thanks so much!  At work atm but I'll share it soon as I'm home. Since the igz is a compressed file type is it okay for me to just attach it to a post?  Don't want to break forum conduct
## Post #43
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-01T22:48:27+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Alright, folder at the link below has the original 1101.igz and the 6 .dat files it was broken up into by pechenko's QuickBMS script

[https://dl.dropboxusercontent.com/u/414 ... anther.zip](https://dl.dropboxusercontent.com/u/41414718/BlackPanther.zip)
## Post #44
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-02T00:21:29+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

thanks for the samples guys! 
first submesh of BlackPanther 00000003.dat 



BlackPanther_00000003_dat.png (40.37 KiB) Viewed 100 times



it looks like the differences are the endianness, float UVs instead of half-float and the FVF size 
if someone was to make a plugin for these models it might be best to  leave the
igz file intact instead of splitting it into dat files to keep header info with the model data.
## Post #45
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T00:30:31+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> thanks for the samples guys! 
first submesh of BlackPanther 00000003.dat 
The attachment BlackPanther_00000003_dat.png is no longer available

it looks like the differences are the endianness, float UVs instead of half-float and the FVF size 
if someone was to make a plugin for these models it might be best to  leave the
igz file intact instead of splitting it into dat files to keep header info with the model data.

Any chance you might be able to explain your methodology?  How you knew to use vertex block mode, first vertex address, etc?  Also why does the mesh appear to have holes in the face?

But seriously, thank you for showing this off!  Reassuring to know that I was right about the start address and vertex count, so I can't be too far off  

EDIT: Got it to produce the same result using 1101.igz!!!



BlackPanterHexToObjResult.png (57.68 KiB) Viewed 96 times



Still confused about the gap in the mesh though.  Also why would the cape, belt, boots etc not be included?  Are those also contained in this same .igz but starting at a later address?  For example, there is a similar of little endian hex value face indices at 0x068DA4.
## Post #46
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-02T01:12:12+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

nice to see you getting the hang of it!   
the face has holes because it is only 1 of 4 submeshes
search for 00 00 01 00 02 00 to jump to the face indices start address of each submesh

sequence assumes there is no room for other data within the vertex stride
therefore the other data like normals and UVs etc must be in their own block 
Hex2obj doesn't deal with normals so we don't worry about that.
a float is 4 bytes, if XYZ position are stored in floats then that is 12 bytes
if the vertex stride is 12 bytes, there is no room left for other data
and must be elsewhere in the file.

i go by this rule
if FVF is 12 and stored as Floats you can use sequence
if FVF is 6 and stored as ShortAll you can use sequence
if FVF is 6 and stored as HF_all (half-float) you can use sequence   

i can't recoginze half-floats and shorts by looking at the numbers, but i do know what 2 bytes looks like  


there is a table with offsets and lengths in the 00000000.dat file starting at 0x9a0

little-endian byte order
0x9a0 - 3 bytes - length of vertex block for 1st submesh
0x9a8 - 3 bytes - start address of vertex block for 1st submesh
0x9b0 - 3 bytes - length of face indices for 1st submesh (divide by 2 to get num faces)
0x9b8 - 3 bytes - start address of face indices for 1st submesh
0x9c0 - 3 bytes - length of vertex block for 2nd submesh
etc

those lengths and addresses (except face indices lengths) actually end with either 10 or 02
10 represents a length
02 represents an address
## Post #47
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T03:16:07+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> nice to see you getting the hang of it!   
the face has holes because it is only 1 of 4 submeshes
search for 00 00 01 00 02 00 to jump to the face indices start address of each submesh

sequence assumes there is no room for other data within the vertex stride
therefore the other data like normals and UVs etc must be in their own block 
Hex2obj doesn't deal with normals so we don't worry about that.
a float is 4 bytes, if XYZ position are stored in floats then that is 12 bytes
if the vertex stride is 12 bytes, there is no room left for other data
and must be elsewhere in the file.

i go by this rule
if FVF is 12 and stored as Floats you can use sequence
if FVF is 6 and stored as ShortAll you can use sequence
if FVF is 6 and stored as HF_all (half-float) you can use sequence   

i can't recoginze half-floats and shorts by looking at the numbers, but i do know what 2 bytes looks like  


there is a table with offsets and lengths in the 00000000.dat file starting at 0x9a0

little-endian byte order
0x9a0 - 3 bytes - length of vertex block for 1st submesh
0x9a8 - 3 bytes - start address of vertex block for 1st submesh
0x9b0 - 3 bytes - length of face indices for 1st submesh (divide by 2 to get num faces)
0x9b8 - 3 bytes - start address of face indices for 1st submesh
0x9c0 - 3 bytes - length of vertex block for 2nd submesh
etc

those lengths and addresses (except face indices lengths) actually end with either 10 or 02
10 represents a length
02 represents an address

You evil genius!  I don't know how you realized that the data structure would include information on the submesh blocks, but this is golden information (I also don't know why a submesh would be divided right though the middle of Black Panther's face, but whatever lol.)  Thank you so so much for this

Looking a the data now that I understand it, I realize that you NEED to convert to .dat files as opposed to using the .igz.  The reason is that everything is the .igz is offset in such a way that the start addresses located in that data block are wrong, but work for the smaller, non-offset .dat files.  So looking at 00...00.dat start at 0x09A0 we can see that we should find:

a vertex block of length 0x030510 (197,904) beginning at address 0x10
a list of face indices of length 0x64c8 / 2 (12,900) beginning at address 0x030520 (aka the one already talked about in an earlier post)
a vertex block of length 0x867c (34,428) beginning at address 0x0369f0
a list of face indices of length 0x12a8 / 2 (2,388) beginning at address 0x03f06c

and so on.  However these addresses only line up if you look at file 00...03.dat.  If you're using 1101.igz the list of faces you'd expect to start at 0x030520 actually starts at 0x036c34.  If it feels like this is a pedantic explanation it's half to help any other people new to these concepts (the selfless reason) and half to make sure I fully understand what's going on (the selfish reason.)

And sure enough here's that missing bit of face, sitting pretty in the second block:



BlackPantherHexToObjResult2.png (37.18 KiB) Viewed 241 times
## Post #48
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-02T03:51:57+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

right, those table offsets make sense when the igz is split into dat files, but if i was to make a script to
automate importing i would leave the igz file intact and just use simple addition to make up the difference.
## Post #49
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T03:53:34+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from AceWell
>
> 
sequence assumes there is no room for other data within the vertex stride
therefore the other data like normals and UVs etc must be in their own block 
Hex2obj doesn't deal with normals so we don't worry about that.
a float is 4 bytes, if XYZ position are stored in floats then that is 12 bytes
if the vertex stride is 12 bytes, there is no room left for other data
and must be elsewhere in the file.

i go by this rule
if FVF is 12 and stored as Floats you can use sequence
if FVF is 6 and stored as ShortAll you can use sequence
if FVF is 6 and stored as HF_all (half-float) you can use sequence

This is the one part I'm still perplexed by though.  I get that a 3d point takes up 12 bytes of space, but how did you get to the conclusion that the appropriate block size was 76 bytes?  And what is the significance of the UV pos value?

Also RE saying that you could get the appropriate offset via addition: can you assume that every .igz file will have the same offset?  Is the header padded to a defined length?
## Post #50
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-02T06:10:45+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from IAmTheClayman
>
> .. but how did you get to the conclusion that the appropriate block size was 76 bytes?
here is where i explained how i do this before   
[viewtopic.php?p=120284#p120284](http://forum.xentax.com/viewtopic.php?p=120284#p120284)

> Reply from IAmTheClayman
>
> Also RE saying that you could get the appropriate offset via addition: can you assume that every .igz file will have the same offset?  Is the header padded to a defined length?
yeah there should be a common structure among similar game files, the trick is finding it!   

0x40 - offset to 16 bytes before first submesh vertex block
add this offset to every offset in the table to make up the difference

getting to the table looks pretty easy   
using 1101.igz (BlackPanther) as example

seek absolute to 0x82c
read integer 0x6f8
seek relative length of that integer - 4 to 0xf24
read integer 0x1c0
seek relative length of that integer - 4 to 0x10e4
read integer 0x84
seek relative length of that integer - 4 to 0x1168
read integer 0x30
seek relative length of that integer - 4 to 0x1198
tablelength = read integer
numSubmesh = tablelength - 20 / 32 
seek relative 0x04 to 0x11a0

and you are now at the table data where you can loop through the offsets+lengths for each submesh
## Post #51
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T12:17:06+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Thank again AceWell, checked out the thread you linked to and was able to set up my hex editor to see why the FVF block would be 76 bytes.  As for UV pos, HexToOBJ tutorial recommends either 12 or 24 when using floats, and if you use 12 you end up with negative values, which my professor always said was a big no-no for UV mapping (except in very rare instances.)

Was able to crank out the Iron Man mesh this morning much faster than I did the Black Panther mesh now that I know what to look for:



IronManModel.png (108.73 KiB) Viewed 222 times



Link to the .igz here: [https://dl.dropboxusercontent.com/u/41414718/1501.igz](https://dl.dropboxusercontent.com/u/41414718/1501.igz)
## Post #52
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2016-08-02T13:20:49+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from IAmTheClayman
>
> As for UV pos, HexToOBJ tutorial recommends either 12 or 24 when using floats, and if you use 12 you end up with negative values,If I hate something then it's uncorrect or incomplete "quotes".  
(always use the last version of hex2obj!)

From the actual tutorial it reads:

> For simple floating point formats UVpos is 12 or 24. Or try other multiples of 4.

It also states:

> Getting the UV position is the harder part. Mostly it is trial 'n error.
So for floats and an FVFsize>20 I'd recommend trying a uvpos= FVFsize - 8.
## Post #53
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T15:41:56+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Lol Shakotay, didn't mean to offend. Was attempting to quote the tutorial from memory since I wasn't at my computer. 

But perhaps you'd be the best person to ask: is there a way to automate hex2obj so that, for example, if we know there are x number of submeshes we can write up a script to enter the appropriate setting and output each mesh without typing in values manually?

Also a more general question: now that I have a decent enough understanding of just extracting the mesh, what would be the best way to get the skeleton information?  Is that something that can be done through Noesis?
## Post #54
- Username: shakotay2
- Rank: MEGAVETERAN
- Number of posts: 4300
- Joined date: Fri Apr 20, 2012 4:24 pm
- Post datetime: 2016-08-02T16:01:15+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from IAmTheClayman
>
> Lol Shakotay, didn't mean to offend.I didn't feel so, and I know hex2obj has some weakness, but I'm up to clear things where it has not.

> is there a way to automate hex2obj so that, for example, if we know there are x number of submeshes we can write up a script to enter the appropriate setting and output each mesh without typing in values manually?This is what The Make_H2O project was good for ([viewtopic.php?f=29&t=12756](http://forum.xentax.com/viewtopic.php?f=29&t=12756)).
You need to be a programmer, though, and it's not very popular.

So I decided to put more efforts on maxscript from time to time.

> what would be the best way to get the skeleton information?  Is that something that can be done through Noesis?Noesis is one of the best tools I know when it comes to skeleton/animation.
But you need to feed it with plugins (dll or python script). And plugins must be written in most cases.

I'm on my way to create a universal skeleton extractor (but I'm lazy, slow and dumb, so it will take more time  ).

Feel free to upload skeleton data and we could have a look at together.
## Post #55
- Username: IAmTheClayman
- Rank: n00b
- Number of posts: 17
- Joined date: Mon Aug 01, 2016 8:46 am
- Post datetime: 2016-08-02T19:01:51+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Haven't had time to translate it from the hex code to something more easily readable, but the skeleton data is included in the .igz files I included in my earlier posts. Shouldn't be too hard to locate, just look for references to joints near the start of the file
## Post #56
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-16T21:33:17+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from Rutabaga
>
> https://mega.nz/#!CgAAVQiD!nc6Ttc-nEtCI ... Mi8xTs9tHs
i made a Noesis python script to open most of those igz samples   

*script removed see this post*
[viewtopic.php?p=121800#p121800](http://forum.xentax.com/viewtopic.php?p=121800#p121800)

out of 194 files these are the only ones that won't open so i will call it a success for now   
i know there was a change in the stride for a couple but i can't find the flag yet
you can just use Hex2obj for these
0002.igz - vertex stride is 44
12201.igz - either corrupt or just a skeleton
17001.igz - either corrupt or just a skeleton
21001.igz - either corrupt or just a skeleton
21101.igz - either corrupt or just a skeleton
22401.igz - vertex stride is 80
7003.igz - vertex stride is 44 
8802.igz - vertex stride is 44
gambit_deck.igz - doesn't seem to be a model
grenade.igz - doesn't seem to be a model
## Post #57
- Username: Teancum
- Rank: veteran
- Number of posts: 99
- Joined date: Wed Nov 28, 2007 3:30 am
- Post datetime: 2016-08-17T14:30:56+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Nice work AceWell! Any idea whether your script below can be reversed? I'm curious as to whether I can reswizzle and just inject a modified texture back in as a chunk. I know Noesis can't do that, but if I have the hex offset and size I can reinject, I just have to get it back to the appropriate format.

> Reply from AceWell
>
> here is version 2 of the igz texture script 
tex_MarvelUltimateAlliance2_igz.zip

it turned out to be a different 8 byte hash representing the 3 formats used  
supports dxt1, dxt5, ati2
this one should work for all of the igz textures, let me know if not
## Post #58
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-17T15:25:08+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

i suppose you're asking for an export script which i'm sure Noesis should have no problem
with but i have zero knowledge of that kind of stuff, i''m not a programmer and if it
requires anything other than python there is not much chance i can do it.
## Post #59
- Username: Rutabaga
- Rank: veteran
- Number of posts: 115
- Joined date: Tue Jan 26, 2016 9:26 pm
- Post datetime: 2016-08-18T07:14:00+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Thanks a lot AceWell! works awesome! god bless you

Can you make a new script for textures please? here a samples:
[https://mega.nz/#!3shDVQCJ!XyYsaJjteIkJ ... i3SZVaTpLU](https://mega.nz/#!3shDVQCJ!XyYsaJjteIkJPcv3LS0n71kO9Ec6XBMMji3SZVaTpLU)
Thanks!
## Post #60
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-19T01:36:56+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

> Reply from Rutabaga
>
> Can you make a new script for textures please? here a samples:
https://mega.nz/#!3shDVQCJ!XyYsaJjteIkJ ... i3SZVaTpLU
here is the new script for these igz texture samples  

*script removed see this post*
[viewtopic.php?p=121800#p121800](http://forum.xentax.com/viewtopic.php?p=121800#p121800)

supports dxt1, dxt5, and ati2

you can't have this script and the model script in the python folder at the
same time or else you will get errors when trying to open any igz texture.
this is because they both look for the same magic and Noesis will think you are
trying to open a model when you are trying to open a texture. i need to add a 
second type check to the model script so they won't conflict, but until then
you will have to move one out temporarily
## Post #61
- Username: Rutabaga
- Rank: veteran
- Number of posts: 115
- Joined date: Tue Jan 26, 2016 9:26 pm
- Post datetime: 2016-08-19T06:55:54+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Works perfect! thanks a lot!
## Post #62
- Username: Rutabaga
- Rank: veteran
- Number of posts: 115
- Joined date: Tue Jan 26, 2016 9:26 pm
- Post datetime: 2016-08-20T10:34:32+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

AceWell,any chances what we will get a model with a bones?
## Post #63
- Username: Acewell
- Rank: VIP member
- Number of posts: 1330
- Joined date: Wed Nov 05, 2008 7:16 pm
- Post datetime: 2016-08-21T00:06:16+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

i'm afraid bones and skinning is not my area   

okay i now have proper type checking on both the texture and model Noesis python scripts  


 MUA_PC.zip
(2.22 KiB) Downloaded 166 times



you can discard the two previous scripts and use these instead   
models with a stride of 44 don't seem to have UVs, maybe they are collision or effect meshes   

*UPDATED Aug 24, 2016*
added stride detection to the model script, no more editing the script!
it opens all model samples except for the 4kb ones, but they don't even look like model files.  
Please download the scripts again and use the newest one
## Post #64
- Username: guti33
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Wed Dec 05, 2018 10:26 am
- Post datetime: 2018-12-05T02:34:38+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Can anyone get me the models for Penance, War-Machine, Electro, Shocker, and Nick Fury?
## Post #65
- Username: huitbgoiouythy
- Rank: beginner
- Number of posts: 20
- Joined date: Fri Nov 16, 2018 12:43 am
- Post datetime: 2021-01-16T09:16:30+00:00
- Post Title: Re: Marvel Ultimate Alliance 2 .DAT

Many thx for it, anyone can extract the skeleton too please?
