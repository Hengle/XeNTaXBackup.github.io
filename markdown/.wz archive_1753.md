## Post #1
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-02T08:20:03+00:00
- Post Title: .wz archive

Hi,

I am trying to figure out how to extract maple story's wz file archive. I used Nova Extractor and found the positions of mp3s and I am using that as a stepping stone to figure out the rest of the archive. I've manage to save a block between 265210743 to 266877208, 266877209 is the start of another mp3, and it successfully played!

The file size indicates that 1666351 bytes, but from 265210743 to 266877208 the file size is actually 1666466 bytes, so right now I am confused : P
I found the file size at 265210652 in 4 bytes? I am not sure. ( Sorry, I can't stand to work in Hex offsets, thus my noob approach : P ) I actually have the file's name, but I guess I first need to find where the file name actually begins first.

Can someone please provide some insight, comments, what should I look for? The game can be downloaded from [http://download.mapleglobal.com/downloa ... SSetup.exe](http://download.mapleglobal.com/download/FullVersion/MSSetup.exe) It's around 314mb.

How does Nova Extractor recognize that there are mp3 files at that position, but doesn't detect anything else? Since I can extract the block does that mean it's not compressed?
## Post #2
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-03-02T08:43:29+00:00
- Post Title: .wz archive

No, I just think the extractor looks for signatures that identify a mp3 file. 

anyway, will take a look.
## Post #3
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-02T18:04:25+00:00
- Post Title: .wz archive

You will? Awesome, I am eager to hear what your insights are for this.
## Post #4
- Username: valvwen
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Fri Mar 03, 2006 8:57 am
- Post datetime: 2006-03-03T01:23:56+00:00
- Post Title: .wz archive

I've been lookin' through Data.wz a bit...and Nova Extractor finds the mp3s cause they're all uncompressed in the archive.

I did manage to find alot of image data...there are alot of zlib compressed blocks in the archive...but they all have invalid block lengths. I figure they did this on purpose, because each block is preceded by four bytes which are the extact size of the compressed zlib block, and then a 0 byte.

For instance, at offset 225940914 in Data.wz there is a zlib compressed block...the 5 bytes before it contain the size, 5928 bytes and that 0 byte. When I extracted that block (and stopped before zlib reported an invalid stored block length error) I found out it contained 16 bit image data. I'm just not exactly sure what format it is in. By messing around with it a bit I managed to fit it into a 258 by 172 pixel bitmap of a golem from the game, but the colors are all wrong. I also found the values 258 and 172 just before the zlib block, but I can't seem to find any sort of regular pattern between all the zlib blocks. When I extract some of the images, they end up all distorted...so I'm wondering if they may have split some of the images into many zlib blocks.

Anyway, hope some of this info is useful...and I'd be interested if anyone has any ideas on what format the image data might be in...I know it's 16 bit...at least for some of the images...but I don't know if it's truecolor or palette or what...if it is palette, I'm not sure where the palette is :p
## Post #5
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-03-03T06:30:16+00:00
- Post Title: .wz archive

Good work! Did you also find some kind of table in there pointing to the location of the individual files in the archive?
## Post #6
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-03T09:02:03+00:00
- Post Title: .wz archive

Valvwen, that's a great find! I tried to reproduce your findings but, I am sorry, I have a novice question:

How did you uncompress your extraction with the zlib library? Are there unpackers out there? Because, I search all over and the only solution would be to create a custom solution using the library.

I am curious to what your extraction looked like, if you don't mind, can you please post your results? Inquiring minds want to know : P
## Post #7
- Username: valvwen
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Fri Mar 03, 2006 8:57 am
- Post datetime: 2006-03-03T14:15:15+00:00
- Post Title: .wz archive

I haven't managed to find a file table. I searched for the offsets, but haven't found any for the files themselves, and I've had trouble finding the beginning of each file header, they seem to be variable length, which makes me think that they contain an encrypted filename. For instance, infront of every mp3 (the entire second half of the archive after offset 265979867 seems to be mp3s) is a variable length set of bytes(could be the filename?), then the bytes 0x0080 then the file size. After that it's a variable length of bytes until you get to an mp3 header (0xFFF29040 or any number of valid mp3 headers). For about the first 50 mp3 files after that, the length of bytes after the file size is 87, but then it changes.

As for finding and uncompressing the zlib blocks, I used python and hex workshop. I got the idea for using python from an article I read at OpenRCE about extracting everquest 2 archives...but I had to modify it to go faster and find invalid archives. The original script iterated through all the bytes in the archive and tried to uncompress the whole thing...which really slow when the archive is 300+ meg.

I found all the zlib blocks with this script:

```
import os
import sys
import zlib

f = open("Data.wz", "rb")

start = 0
f.seek(0, 2)
size = f.tell()
f.seek(0)
obj = zlib.decompressobj()
buf = ""

while start < size:
	offset = start
	obj = zlib.decompressobj()
	buf = ""
	try:
		while offset < size:
			d = obj.decompress(f.read(1))
			if len(obj.unused_data) > 0:
				break
			buf += d
			offset += 1
	except zlib.error, details:
		if str(details) == "Error -3 while decompressing: invalid stored block lengths" and len(buf) > 0:
			print "offset:", start
			print "compressed:", offset - start - 1, "uncompressed:", len(buf)
		start += 1
		f.seek(start)
		continue
	print "offset:", start
	print "compressed:", offset - start - 1, "uncompressed:", len(buf)
	start += 1
	f.seek(start)

f.close()

```


After that I go to the offset, look 5 bytes before to get the file size...then go back to the offset and cut out the data to a new file with hex workshop.
Then I use this script to uncompress the zlib data.

```
import os
import sys
import zlib

if len(sys.argv) < 2:
	print "usage: extract.py <file>"
	sys.exit(1)

offset = 0

fd = os.open(sys.argv[1], os.O_RDONLY | os.O_BINARY)
m = mmap.mmap(fd, 0, None, mmap.ACCESS_READ)

size = len(m)
obj = zlib.decompressobj()
buf = ""

try:
	while offset < size:
		d = obj.decompress(m[offset])
		if len(obj.unused_data) > 0:
			break
		buf += d
		offset += 1
except zlib.error, details:
	print "offset:", offset, "length:", offset - 1
	print details
	m.close()
	os.close(fd)
	sys.exit(1)

print "compressed:", offset - start - 1, "uncompressed:", len(buf)
f = open(sys.argv[1] + ".dump", "wb")
f.write(buf)
f.close()

m.close()
os.close(fd)

```


As for actually viewing the image data...I wrote a quick c# program that just loads the data into a 16 bit bitmap (I tried 8, 16, 24, and 32 bit...16 is the only format that gives me the right image dimensions), and lets me modify the width of the image until it looks right :p Since I haven't been able to find width and height for all the images (partially I think cause most of the images are split up into smaller chunks).

I'll try to add an attachment of what I got for the golem data...you'll clearly see the golem, but the colors are all wrong cause can't figure out the exact image format.
[golem.png](https://xentaxbackup.github.io/file/627_golem.png)
## Post #8
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-04T06:34:40+00:00
- Post Title: .wz archive

Thanks a lot for sharing that python scripts they were a big help--I've outputted all the offsets into a file..a pretty big one at that. I spent a day trying to figure out how exactly I should go about viewing the files extracted, I've looked into opening it in Java's imageio, python's image module, they didn't seem to like the fact it didn't have any recognition of a valid image file. As a last ditched effort, I tried to just create an empty jpeg/png/bitmap/gif and merged the uncompressed data with it, in various positions--no luck.

The uncompressed blocks are pretty wierd, most of the extracted bytes are zero valued and fills the gap between non zeroed portions.

As for the filenames, I have a few known mp3 file names.
For version 0.18: (going off of nova extractor's offsets)
offset           file size      name
265210743 : 1666351  : SleepyWood.mp3
266877209 : 1376392  : FloralLife.mp3
268253714 : 728294    : GoPicnic.mp3
268982122 : 1907461  : Nightmare.mp3
## Post #9
- Username: valvwen
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Fri Mar 03, 2006 8:57 am
- Post datetime: 2006-03-04T14:07:03+00:00
- Post Title: .wz archive

I wrote some quick python code to put the uncompressed data into a 16bit bitmap.

```
import sys

if len(sys.argv) < 3:
	print "usage: tobmp.py <file> <width>"
	sys.exit(1)

width = int(sys.argv[2])

f1 = open(sys.argv[1], "rb")
f1.seek(0, 2)
size = f1.tell()
f1.seek(0)

### write BITMAPFILEHEADER ###
f2 = open(sys.argv[1] + ".bmp", "wb")
f2.write("BM")

bfSize = size + 52
f2.write(struct.pack("L", bfSize))

# bfReserved1 and 2
f2.write("\x00\x00\x00\x00")

bfOffBits = 52
f2.write(struct.pack("L", bfOffBits))

### write BITMAPINFOHEADER ###
biSize = 40
f2.write(struct.pack("L", biSize))

biWidth = width
f2.write(struct.pack("L", biWidth))

biHeight = (size / 2 / width) + 1
f2.write(struct.pack("L", biHeight))

biPlanes = 1
f2.write(struct.pack("H", biPlanes))

biBitCount = 16
f2.write(struct.pack("H", biBitCount))

# biCompression
f2.write("\x00\x00\x00\x00")

# biSizeImage
f2.write("\x00\x00\x00\x00")

# biXPelsPerMeter
f2.write("\x00\x00\x00\x00")

# biYPelsPerMeter
f2.write("\x00\x00\x00\x00")

# biClrUsed
f2.write("\x00\x00\x00\x00")

# biClrImportant
f2.write("\x00\x00\x00\x00")

### write the bitmap data ###
data = f1.read()

# since bitmaps are upside down, gotta flip it over
i = len(data) - 1
while i >= 0:
	f2.write(data[i])
	i -= 1

# pad the end
padsize = (biWidth * biHeight * 2) - size
i = 0
while i < padsize:
	f2.write("\x00")
	i += 1

f1.close()
f2.close()

```


Hope it helps!
## Post #10
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-06T02:21:29+00:00
- Post Title: .wz archive

Thanks for creating that python script, I don't think it converts the uncompressed files to anything recognizable, but it does make'em into bmp. 

I am still a bit perplexed at what exactly is the format these headerless uncompressed files are. I was wondering if you, Valvwen, can verify that this attached file is actually an image or something totally off the beaten path. 
Thanks.
## Post #11
- Username: valvwen
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Fri Mar 03, 2006 8:57 am
- Post datetime: 2006-03-06T13:01:56+00:00
- Post Title: .wz archive

Yeah, that particular offset doesn't seem to make any image, or if it is one, it may be distorted because it's part of a larger image. They're probably not all image blocks. I'd post some offsets of stuff I've found, but you're working on a more recent version of Data.wz, so the offsets may be off. I've managed to find lvl up text, a robot sort of thing, that golem, a few more golems that were all distorted, and some magic effects like power strike and stuff. Bear in mind that most of the blocks that are images look completely unrecognizable until you find the correct width. It's alot of trial and error until we figure out how to find the image width in the file header before we actually try random values until they work.
## Post #12
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-06T19:36:02+00:00
- Post Title: .wz archive

Okay : P I can stop going crazy in trying to find an image in that offset then. Well, I am extracting from version 0.18 but I also have 0.19.

You know what...there have been others that have successfully extracted images/text out of the archive, but of course trying to get them to even give me a hint as to how it was done resulted in some serious, elitist flaming.

Notable examples 
sauna.gibbed.us, this site's naming scheme reflects searchable values in memory when the game is played, however isn't searchable in hex.

And someone was able to get the animation into gifs
Edit: This site just used the extracted images from saua.gibbed.us and merged all the sequence.
dtrmp4.cursedsanctuary.com/ms/random/AnimatedGIFs/
## Post #13
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-06T20:01:07+00:00
- Post Title: .wz archive

[...]
## Post #14
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-06T20:52:33+00:00
- Post Title: .wz archive

...
## Post #15
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-06T22:58:36+00:00
- Post Title: .wz archive

...
## Post #16
- Username: babebabe
- Rank: beginner
- Number of posts: 36
- Joined date: Sat Jan 07, 2006 12:19 am
- Post datetime: 2006-03-07T09:30:10+00:00
- Post Title: 

@MedsL I run your script but error is:
Traceback (most recent call last):
  File "D:\Programs\Maplesea\tobmp.py", line 26, in ?
    f2.write(struct.pack("RGB", bfSize))
struct.error: bad char in struct format

Which tools you used to convert this raw image?
## Post #17
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-03-07T09:42:48+00:00
- Post Title: 

Nothing to convert efficiently yet. Trying to figure out how to. You got any leads?
## Post #18
- Username: mambox
- Rank: mega-veteran
- Number of posts: 190
- Joined date: Wed Mar 24, 2004 9:06 pm
- Post datetime: 2006-03-09T15:35:03+00:00
- Post Title: 

dunno if you work with a retail version,can't find a cr*cked version for this game 

all links appreciated..

but maybe you may look inside the unpacked .exe to see how it access and unpack all the data.wz.

found a python access dll...

hxxp://starship.python.net/crew/theller/ctypes/

may help..not..well cheers.
## Post #19
- Username: babebabe
- Rank: beginner
- Number of posts: 36
- Joined date: Sat Jan 07, 2006 12:19 am
- Post datetime: 2006-04-26T07:42:25+00:00
- Post Title: 

Hi there, anyone have news with this format?
Meds, are you done?
Help me pls....
## Post #20
- Username: babebabe
- Rank: beginner
- Number of posts: 36
- Joined date: Sat Jan 07, 2006 12:19 am
- Post datetime: 2006-04-26T07:42:50+00:00
- Post Title: 

Hi there, anyone have news with this format?
Meds, are you done?
Help me pls....
## Post #21
- Username: AndrewFM
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 02, 2006 3:24 am
- Post datetime: 2006-05-01T19:32:27+00:00
- Post Title: 

Here's some info that may help you guys out in solving the problems.

The images when extracted from the data.wz are 32 bit png files.

Here's the rest of one of the image's info (Dont think most, if any of the rest of the stuff is useful to you though)



Good luck.
## Post #22
- Username: babebabe
- Rank: beginner
- Number of posts: 36
- Joined date: Sat Jan 07, 2006 12:19 am
- Post datetime: 2006-05-05T14:46:15+00:00
- Post Title: 

But they have no magic byte, how do you extracted this?
## Post #23
- Username: AndrewFM
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 02, 2006 3:24 am
- Post datetime: 2006-05-09T20:58:10+00:00
- Post Title: 

I think you're reffering to file size when you say "magic bytes", right?

Anyways, I think this is actually a better idea then just showing you a limited screenshot of a few of the parameters of the actual image. Attached here is one of the images from the data.wz, so you can look at whatever you want with it, and try to figure out a good solution to the extraction puzzle.
[000.png](https://xentaxbackup.github.io/file/741_000.png)
## Post #24
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-05-09T22:26:20+00:00
- Post Title: 

What the hell? Are you working for Rick? Why are you posting his extraction, because that png has a tExt chunk with his site address. If you are, tell him that 'the sprites weren't as complicated than I thought'.
[asdfasdf_197.png](https://xentaxbackup.github.io/file/774_asdfasdf_197.png)
## Post #25
- Username: babebabe
- Rank: beginner
- Number of posts: 36
- Joined date: Sat Jan 07, 2006 12:19 am
- Post datetime: 2006-05-10T02:59:09+00:00
- Post Title: 

@Meds: help me, I want that program to extract this image, where is image size?
## Post #26
- Username: AndrewFM
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 02, 2006 3:24 am
- Post datetime: 2006-05-11T19:47:10+00:00
- Post Title: 

Rick was helping me with getting images for a project I'm currently working on. He's been AWOL for months, and I'm in desperate need of images right now... so I did this as a last resort, hoping that maybe a solution could be found, so that I could both continue at full speed with the project, and also stop having to bother him with getting me images, since I know he's been really busy with his site.

I really didnt want to do this, because its quite obvious that if wizet encrypted the data.wz well like that, they didnt want the images and stuff getting out to the public... but I wasnt quite sure what to do
## Post #27
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-06-04T02:33:50+00:00
- Post Title: 

> Reply from valvwen
>
> I've been lookin' through Data.wz a bit...and Nova Extractor finds the mp3s cause they're all uncompressed in the archive.

I did manage to find alot of image data...there are alot of zlib compressed blocks in the archive...but they all have invalid block lengths. I figure they did this on purpose, because each block is preceded by four bytes which are the extact size of the compressed zlib block, and then a 0 byte.

For instance, at offset 225940914 in Data.wz there is a zlib compressed block...the 5 bytes before it contain the size, 5928 bytes and that 0 byte. When I extracted that block (and stopped before zlib reported an invalid stored block length error) I found out it contained 16 bit image data. I'm just not exactly sure what format it is in. By messing around with it a bit I managed to fit it into a 258 by 172 pixel bitmap of a golem from the game, but the colors are all wrong. I also found the values 258 and 172 just before the zlib block, but I can't seem to find any sort of regular pattern between all the zlib blocks. When I extract some of the images, they end up all distorted...so I'm wondering if they may have split some of the images into many zlib blocks.

Anyway, hope some of this info is useful...and I'd be interested if anyone has any ideas on what format the image data might be in...I know it's 16 bit...at least for some of the images...but I don't know if it's truecolor or palette or what...if it is palette, I'm not sure where the palette is :p

I don't understand what '5 bytes before' means. Can I have a detailed explaination?
## Post #28
- Username: cyg
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sat Jun 10, 2006 4:26 am
- Post datetime: 2006-06-09T20:28:51+00:00
- Post Title: 

well i guess meds got what he wanted and decided to dust the tracks for anyone else who wanted to follow. wasn't that nice of him? especially when he decided to insult rick.

anyway, i will have some time to examine the .wz file in around a month if i find anything useful i'll post it here.
## Post #29
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2006-06-21T04:14:57+00:00
- Post Title: 

Well, since someone pointed me out to this thread, I guess I'll reply.

The reason why I choose not to help people get into Data.wz is clear -- it would eventually lead people to understanding how MapleStory handles data, which would eventually allow people to make easy cheats.

The file information within Data.wz is heavily encrypted, both Data.wz and the files inside Data.wz share the encryption system, which makes understanding this format even harder -- I wish you all who are attempting good luck in your attempts.
## Post #30
- Username: sjxsoft
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jul 14, 2006 6:11 pm
- Post datetime: 2006-07-14T12:10:22+00:00
- Post Title: 

> ...
## Post #31
- Username: thomasnilsh
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Thu Jul 27, 2006 5:40 am
- Post datetime: 2006-07-26T22:16:37+00:00
- Post Title: 

look, for more than a year now ive searched so much ive found  a working extracter! all i need is the files! im gust a curious guy    i promise i need those file names!
## Post #32
- Username: thomasnilsh
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Thu Jul 27, 2006 5:40 am
- Post datetime: 2006-07-27T00:10:31+00:00
- Post Title: 

> Reply from thomasnilsh
>
> look, for more than a year now ive searched so much ive found  a working extracter! all i need is the files! im gust a curious guy    i promise i need those file names! please
## Post #33
- Username: sjxsoft
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jul 14, 2006 6:11 pm
- Post datetime: 2006-07-27T13:05:08+00:00
- Post Title: 

> ....
## Post #34
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-07T09:29:29+00:00
- Post Title: 

The code to extract all the images is located there:

[http://timall3.100webspace.net/](http://timall3.100webspace.net/)

Just to be mean, I made it so that you have to click '->' 2000 times...because after all, when one person get it, the value of this thing will decrease with each copy.

...And to the top poster, that's my GeeWiz program...which really is just a modified TextureFinder. I am not Chinese... =<
## Post #35
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-08-07T12:42:10+00:00
- Post Title: 

O_o Oooook. That made little sense.

But anyways, I dunno what the aim is here. It seems to be to extract files from Maple Story? For modding? Or admiring the sprites? Or... hm?

Edit: Just as a note I don't play the game.
## Post #36
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-07T16:30:21+00:00
- Post Title: 

[quote="Darkfox"]O_o Oooook. That made little sense.

But anyways, I dunno what the aim is here. It seems to be to extract files from Maple Story? For modding? Or admiring the sprites? Or... hm?

Edit: Just as a note I don't play the game.[/quote]

Did...you...read....the thread? From beginning to end? Since you don't play the game, then extracting the images serves little purpose to you. So, what is the purpose of it? Novelty, I guess.
## Post #37
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-08-08T04:48:01+00:00
- Post Title: 

I did read, I know the game but I don't play it. Just it is a kind of a reach, being a MMO and all you can't do much with it other than probably extract sprites/music as it seems. And if one could do such a thing, well... everybody would have to have that file or a crash would occur, at least that is how it was with Ragnarok Online (Don't play it either XD but I've read documents).

Also, I think sombody asked how a site had animated gifs of things from Maple Story. What they probably did was take snapshots and rip each frame individually which is not all that hard but time consuming, and maybe a bit of skill in knowing what your doing.

Oh and I really don't have much interest in the sprites for Maple Story. A lil bizarre for my taste XD. But I'm just checking up on what is active and a bit interested in seeing how projects are going.

In any case, good work on your findings I guess. 

Edit: Oh and he said it was some Chinese because that board was in Chinese. Likely he can't read it.
## Post #38
- Username: sjxsoft
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jul 14, 2006 6:11 pm
- Post datetime: 2006-08-08T14:17:26+00:00
- Post Title: 

> Reply from Meds
>
> The code to extract all the images is located there:

http://timall3.100webspace.net/

Er......there isn't code in the site,or it shows something hard to understand

> 8].t..E.P.StepM.......E..p.One.M.......E..E.u.SV.E.P.m...Pj
>
> d.7.....YYP..n..YYSj..M.......M.........V.M.h|.T.j..F.P.E.P
>
> .+...PjThink.7.y...YYP.Qn..YYP.....YYSj..M.......F.P.......
>
> .H....6YY;.u..u..ForW.....P.........j.F.Pu.hp.T..7..h|.Th.T
>
> ..7.....YYP..m..YYP.....YourYYP..m..YYP.....YY..8;u.r......
>
> .;.u.hd.T..7.h...YY.wj>.7.....SelfYY............t..P.......
>
> ....P.P........v.;.u..M.jS.u..E.P.....Ph`.T..7.....YYP.?m..
>
> YYP.W...YYSj..M.......M..(...Sj..M.......M...%.._^[....U...
>
> ...u..M..u..u..c....u..M.......M.........t$..r...3.........
>
> ...I...t..t$..t$..........A..a....T$...V.p..2.p..~..u..V..r
>
> ..p..I.;Q.^u..A....J.;Q.u..A......P..B.....A.V.p.W.....t$..
>
> N..p.....t..v......6.~..t...->....A.V.p.W.....L$..F.P.=....
>
> .t....6...v..~..t..._^...U.....M....M..H..M..H..M....H..A8.
>
> M..H..@..]...V...N.......D$..t.
## Post #39
- Username: Savage
- Rank: VIP member
- Number of posts: 559
- Joined date: Sun Apr 17, 2005 6:00 pm
- Post datetime: 2006-08-08T14:23:52+00:00
- Post Title: 

it's a joke 

"Step one, think for yourself"
## Post #40
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-08T14:50:43+00:00
- Post Title: 

> Reply from Meds
>
> ...And to the top poster, that's my GeeWiz program...which really is just a modified TextureFinder. I am not Chinese... =<

Interesting. Where is this tool?
## Post #41
- Username: Savage
- Rank: VIP member
- Number of posts: 559
- Joined date: Sun Apr 17, 2005 6:00 pm
- Post datetime: 2006-08-08T15:45:23+00:00
- Post Title: 

I used a chinese translator...but only images attached...maybe you need to register?
## Post #42
- Username: mambox
- Rank: mega-veteran
- Number of posts: 190
- Joined date: Wed Mar 24, 2004 9:06 pm
- Post datetime: 2006-08-08T16:43:27+00:00
- Post Title: 

> Reply from pulposo
>
> I used a chinese translator...but only images attached...maybe you need to register?

nothing more as registered user,he claim that the pack is 9mb,too much to attach as post.

wanna check ftp..
## Post #43
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-08T17:08:50+00:00
- Post Title: 

> Reply from mambox
>
> pulposo wrote:I used a chinese translator...but only images attached...maybe you need to register?

nothing more as registered user,he claim that the pack is 9mb,too much to attach as post.

wanna check ftp..

But if this is an adapted version from Meds TextureFinder, so Meds says. 

Then I would like to have some answers to these questions:

A) Where's Meds tool? He can surely upload it somewhere? What happened to file sharing services? 

B) 9 MB for such a tool is hardly plausible, what on earth is in there? 

C) Meds,if you have this GeeWiz tool, why not share it?
## Post #44
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-08T21:21:25+00:00
- Post Title: 

The GeeWiz tool was released for a brief time, but people seemed to not care for it, so I took it off my site. Now there are copies of it floating around somewhere in cyberspace. The fact that it's 3mb (compressed, 7-8mb decompressed)  was due to the compiled Python script (which needed a lot of file) and a dump of all the zlib offsets (2mb). It's never going to be released again, because....I stupidly extracted texturefinder to my working project. I'll have to...work on it again...maybe. I didn't want to release it, also because of the fact that I didn't put enough disclaimers in...I don't want to get SUED. And as Mr. Mouse knows, this was one of my main concerns.

The site is valid, it's not a joke, if you can't get passed the first part...then I don't know what to say. At the end of the 2000 clicks, is the full source for extracting the zlib chunks and converting to a viewable format. This was done to piss you off, and I LOL'd a little too...since all I got were flames...even now. It's a jerry-rigged script from what Valwen has given me to work with... I was able to just connect all the pieces together.
[untitled.JPG](https://xentaxbackup.github.io/file/787_untitled.JPG)
## Post #45
- Username: Savage
- Rank: VIP member
- Number of posts: 559
- Joined date: Sun Apr 17, 2005 6:00 pm
- Post datetime: 2006-08-08T22:09:49+00:00
- Post Title: 

well...

> Anatomy of the Hack 2
>
> 
>
> zlib content
>
> -----------------etc etc

a history how recognize the zlib, well, your webpage it,s like a game,heheh, he sheep?
## Post #46
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-09T07:33:13+00:00
- Post Title: 

> Reply from Meds
>
> I didn't want to release it, also because of the fact that I didn't put enough disclaimers in...I don't want to get SUED. And as Mr. Mouse knows, this was one of my main concerns.

Well, I am aware of your concerns, and I respect those. However, I though you might have just added some disclaimers. You see, there's nothing wrong in what you created. It's only users who can do something illegal. It's like guns. Selling them is not illegal, but unlawful killing is. Selling a tool that can extract is not illegal, (reverse-engineering is not illegal), but extracting copyrighted material and doing something with it that might upset the copyright holders is. 

It's just that this thread was started to figure out how to do it, and then we know, but no-one benefits from it.
## Post #47
- Username: mambox
- Rank: mega-veteran
- Number of posts: 190
- Joined date: Wed Mar 24, 2004 9:06 pm
- Post datetime: 2006-08-09T13:53:15+00:00
- Post Title: 

feel free to share it
## Post #48
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-08-09T16:51:56+00:00
- Post Title: 

> but extracting copyrighted material and doing something with it that might upset the copyright holders is.

Like selling them, putting them in a game and selling that... it's mainly about the profit off another's work that is the key problem. I know I wouldn't want sombody making money off my graphics... unless I get a fair share... <_< >_> XD
## Post #49
- Username: Question
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Fri Aug 11, 2006 9:02 am
- Post datetime: 2006-08-11T01:06:52+00:00
- Post Title: 

That site is evil! ([http://timall3.100webspace.net](http://timall3.100webspace.net))  I got to 105 and then when trying something with the referrer on another browser got "Err, where are you going, sheep?".  An autoclicker might work, but it'd be fairly challenging to make work correctly.  I'm thinking that I can run a javascript loop to accomplish what I want but I'm not sure.  I'll tell you guys what happens once you get to 2000.  

-Question
## Post #50
- Username: Question
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Fri Aug 11, 2006 9:02 am
- Post datetime: 2006-08-11T12:18:26+00:00
- Post Title: 

Well, it almost worked.  I got to 1257, and then the site lagged, and then the script went ahead of itself and I was called a sheep again.  It does seem possible though to make all the way to 2000.  I'll keep working on it.

-Question
## Post #51
- Username: mambox
- Rank: mega-veteran
- Number of posts: 190
- Joined date: Wed Mar 24, 2004 9:06 pm
- Post datetime: 2006-08-12T16:20:28+00:00
- Post Title: 

you may post it at rapidshare with a password and nobody will claim about copyrights..

cheers.
## Post #52
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-16T12:06:53+00:00
- Post Title: 

> Reply from Question
>
> Well, it almost worked.  I got to 1257, and then the site lagged, and then the script went ahead of itself and I was called a sheep again.  It does seem possible though to make all the way to 2000.  I'll keep working on it.

-Question

Don't bother. He's probably scamming you. I think you can click 10000 times and not reach anything.
## Post #53
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-17T05:41:27+00:00
- Post Title: 

> Reply from mambox
>
> you may post it at rapidshare with a password and nobody will claim about copyrights..

cheers.
Come on... you can trust us =)
## Post #54
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-18T06:32:49+00:00
- Post Title: 

OMG! It actually worked! I got to 1999 and I got the code! Thank you thank you.
## Post #55
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-18T08:28:38+00:00
- Post Title: 

> Reply from themoviefund
>
> OMG! It actually worked! I got to 1999 and I got the code! Thank you thank you.

Somehow, I don't believe you.   If you did, prove it
## Post #56
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-19T02:46:47+00:00
- Post Title: 

I used JavaScript.... I have the code, if you want. Now I'm trying to decipher how to use it. Lol.... You want to try my JavaScript?

EDIT: I took out the link. Here's my proof:
[goodenough.gif](https://xentaxbackup.github.io/file/793_goodenough.gif)
## Post #57
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T04:32:40+00:00
- Post Title: 

Now, part two of this whole thing : P

Removing the code, and seeing how fast it spreads.

Scammer : (
## Post #58
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-19T08:13:05+00:00
- Post Title: 

> Reply from themoviefund
>
> I used JavaScript.... I have the code, if you want. Now I'm trying to decipher how to use it. Lol.... You want to try my JavaScript?

EDIT: I took out the link. Here's my proof:

Well, show us the code you got of of Meds site. Provide a direct link ar attach it to a post here, and we can lay this matter to rest. A picture is not going to do it for the people here, I'm afraid, as we've seen enough pictures of this already, without having the code itself.
## Post #59
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T08:14:48+00:00
- Post Title: 

> Reply from Meds
>
> Now, part two of this whole thing : P

Removing the code, and seeing how fast it spreads.

Scammer : (
wt the hell?
are you kidding me?
you remove the code where I can find if damn didn't release it ?

And how many "part" do you plan?
now it is just "part 2"?
## Post #60
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T08:19:21+00:00
- Post Title: 

i have a question................  
who know how to extract the .exe file in Data.wz
(p.s. I come from Hong Kong,My english is .....    and you guy may don't understand wt i am talking
## Post #61
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T08:21:12+00:00
- Post Title: 

> Reply from themoviefund
>
> I used JavaScript.... I have the code, if you want. Now I'm trying to decipher how to use it. Lol.... You want to try my JavaScript?

EDIT: I took out the link. Here's my proof:
ohz???
the image in data.wz is store in BMP or you convert it?
i remenber Wizet store the image in ".img"
## Post #62
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-08-19T08:54:37+00:00
- Post Title: 

I don't connect Meds site. Link is Broken... :(
I need that tools.. :(

Tell me how I can get tools.
## Post #63
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T09:30:58+00:00
- Post Title: 

I hate being called a scammer : ( So there you go : )

<3

oops forgot the link
[http://heat.castleparadox.com/mslvl/geewiz.php](http://heat.castleparadox.com/mslvl/geewiz.php)
: 3

Buy me a beer? : (
## Post #64
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-08-19T09:46:13+00:00
- Post Title: 

I Love so Much!!!!

Meds. You a cool guy!!!
## Post #65
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T09:52:04+00:00
- Post Title: 

...I need a new wand....*wink*
## Post #66
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2006-08-19T10:07:30+00:00
- Post Title: 

> Reply from Meds
>
> I hate being called a scammer : ( So there you go : )



oops forgot the link
http://heat.castleparadox.com/mslvl/geewiz.php
: 3

Buy me a beer? : (

AH FINALLY! You've certainly earned that beer.   I'm sure you made lots of fans of the game happy here. 

One thing though, the links to 

For Maple Global v.19 : Download
For MapleSEA v.26: Download

404 on me.
## Post #67
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T10:10:10+00:00
- Post Title: 

Oh right >.< I have to make new ones. Since the addresses change with each patch. I don't have the game though~ There are instructions in the readme on how to go about creating the mapdump.

Global MS mapdump is up.
## Post #68
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-19T10:17:05+00:00
- Post Title: 

Meds: If are you going to use the GPL as the license for your program you must offer source code to those who ask of it...  Not that I think it adds anything to what I've figured out, but consider this a request.

---------------

Anyways, here's the algorithm used for those who want to work on further reverse engineering the file format on their own.

Wizet uses a 16 bit image format as opposed to the normal 32 bit image format.  IE:  instead of RR GG BB AA, they just have RG BA.  Once you extract the zlib compressed data, you need to expand 16 bits to 32.  (python code)  That's why any image you see on Rick's site have pixels values like: 0x11ffcc.  It just repeats the same rgb value twice.

```
  buf = ""
  for i in range(width*height):
    p = struct.unpack("BB", data[i*2:i*2+2])

    a = p[1] / 16 ; a = a*16 + a
    r = p[1] % 16 ; r = r*16 + r
    g = p[0] / 16 ; g = g*16 + g
    b = p[0] % 16 ; b = b*16 + b

    buf += struct.pack("BBBB", r, g, b, a)
  return buf

```


Here's a complete application to extract images from a known file location.  I'll be posting all morning on how to figure out the rest of the file format, or at least a large(r) chunk of it.

Copy this code to a file named "extractat.py" and put it in the same directory as data.wz.  It takes command line arguments of file locations.  So to extract the mushrooms at the very beginning of the file, you'd type something similar to: "extractat.py 167995 169523 171333 172989 174630 176264 177900 179542 181372 182541"  And out will pop 10 png files.  The code is in the public domain and comes without warrenty.

```
import struct

def pack_chunk(tag,data):
  to_check = tag + data
  return struct.pack("!I",len(data)) + \
         to_check + \
         struct.pack("!I",zlib.crc32(to_check))

def dumpToPNG(width, height, data):
  raw_data = ""
  for y in range(height):
    raw_data += chr(0)
    raw_data += data[y*width*4:(y+1)*width*4]

  return struct.pack("8B", 137, 80, 78, 71, 13, 10, 26, 10) + \
         pack_chunk('IHDR',
           struct.pack("!IIBBBBB",width,height,8,6,0,0,0)) + \
         pack_chunk('IDAT', zlib.compress(raw_data,9)) + \
         pack_chunk('IEND', '')

def image16to32(width, height, data):
  buf = ""
  for i in range(width*height):
    p = struct.unpack("BB", data[i*2:i*2+2])

    a = p[1] / 16 ; a = a*16 + a
    r = p[1] % 16 ; r = r*16 + r
    g = p[0] / 16 ; g = g*16 + g
    b = p[0] % 16 ; b = b*16 + b

    buf += struct.pack("BBBB", r, g, b, a)
  return buf

from sys import argv

f = open("Data.wz", "rb")
i = 0
for arg in argv[1:]:
  offset = int(arg)

  offset = offset - 12
  f.seek(offset,0)
  (width, height) = struct.unpack("BB", f.read(2))
  f.read(6)
  (length, ) = struct.unpack("I", f.read(4))
  f.read(1)
  
  obj = zlib.decompressobj()
  buf = obj.decompress(f.read(length))

  g = open(arg + ".png", "wb")
  g.write(dumpToPNG(width, height, image16to32(width, height, buf)))
  g.close()

  i += 1
f.close()

```
## Post #69
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T10:19:31+00:00
- Post Title: 

And they come out of the wood works : P

It was on the file with the source. But I couldn't figure out the png header, so everything was in bitmap and there's probably a few width offsets I'd missed by doing that.
## Post #70
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-19T10:27:26+00:00
- Post Title: 

The header of data.wz is the easiest section of the file to figure out, it contains a file identifer (the first 4 bytes of any file format generally identify it, somewhat like the ".123" file extensions), the size of the data minus the 4 bytes already read in but including the size value itself (64 bit value), the offset into the file where the filetable is at (32 bit value), and the Wizet copyright takes up the rest of the header:

```

def rU32(f): return struct.unpack('I', f.read(4))[0]
def rU64(f): return struct.unpack('Q', f.read(8))[0]

def dumpFileLoc(f):  print "<tr><td>FileLocation</td><td>%d</td></tr>" % f.tell()

def dumpHeader(f):
  ident  = f.read(4)
  size   = rU64(f)
  offset = rU32(f)
  copy   = f.read(offset - f.tell())

  print "<tr><td>Header.FileIdentifier</td><td>%s</td></tr>" % ident
  print "<tr><td>Header.DataSize</td><td>%d</td></tr>" % size
  print "<tr><td>Header.DataStartOffset</td><td>0x%08x</td></tr>" % offset
  print "<tr><td>Header.Copyright</td><td>%s</td></tr>" % copy

def dump():
  f = open("data.wz", "rb")

  print "<html>"
  print " <head>"
  print "  <title>data.wz File Dump</title>"
  print " </head>"
  print " <body>"
  print "  <table>"
  dumpHeader(f)
  dumpFileLoc(f)
  print "  </table>"
  print " </body>"
  print "</html>"

dump()

```


I'm copying and pasting from my main source file just the sections that apply to each description, I do a quick check before submitting, but nothing extensive.   So there may be errors.
## Post #71
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-19T10:56:49+00:00
- Post Title: 

The next 16 bits after the header are unknown at the moment.  In the version of data.wz that I have, it's 0x0061.

After that, we begin the directory blocks.  In my version there are 45 directories, and I had to fix my extractor to use that value.  The program could be smarter and count the number of subdirectories and stop once it no longer finds them, or I could figure out the encoding used for file/directory offsets.  If anyone else figures it out, I'd be glad to know.

The first value is the count of how many files are in the directory.  Wizet tries to compactly store sizes.  If the size is less then 128, it just gives you the size as a single byte.  If it's >= then 128, it flags the value as a large value (hex code 0x80), and the next 4 bytes make up the actual count/size.

```
  size = rU8(f)
  if(size == 0x80): size = rU32(f)
  return size

```


Once you know the number of files, start iterating over all of the entries.  Each entry has a: Identifier byte, filename (or link), filesize, and then two unknown values.

The identifier byte can be one of the following three values:  0x04 for files, 0x03 for directories, and 0x02 for symbolic links.

After the identifer, comes the filename.  The filenames and strings in the data.wz are tricky because wizet "encrypts" them.  (Look!  Scare quotes!  I'm shaking.)

The decryption key begins with: 0xAA (0101 0101).  If the value I'm encrypting is 0110 0111, and the key is 0101 0101, then the key will flip any bits where there is a 1 in the key; where there is a 0 in the key, the bit.  So with our current key, we flip bits 1,3,5, and 7, for the final value of: 0010 0010.  The decryption process works the same way.

After each character, the decryption key gets incremented by 1 (from 0xAA to 0xAB to 0xAC, etc...

The above complicated description boils down to the following 9 lines of code:

```
  s = ''
  p = 0xAA
  for cc in str:
    a = ord(cc)
    val = ((a & ~p) ^ (~a & p)) & 0xff
    s += struct.pack("B", val )
    p += 1
  return s

```


Strings are guarenteed to be less then 256 characters.

Before each string is the negation/not of the string length.  So if the string length is 3, the value read in will actually be -3.  Since strings are less then 256 characters, the length is just a signed byte.

This leads to the following 3 lines of code:

```
  size = rU8(f)
  return transStr(f.read(256 - size))

```


Next is the filesize, and unknown1 (both PackNums), and then a 32 bit something for unknown2.

Symbolic links are the only oddities.  Instead of a string, it gives a 32 bit link to the file that it is pointing to.

Put it all together, and you get:

```
from sys import exit

def dumpFileLoc(f):  print "<tr><td>FileLocation</td><td>%d</td></tr>" % f.tell()
def dumpFileSize(f): print "<tr><td>FileSize</td><td>%d</td></tr>" % getFileSize(f)

def check(flag, val, f):
  if(flag != val):
    print "<tr><td>Unknown: %s</td><td>Expecting: %s</td></tr>" % (repr(flag), repr(val))
    dumpFileLoc(f)
    exit(-1)

def checkA(flag, vals, f):
  if(not flag in vals):
    print "<tr><td>Unknown:  %s</td><td>Expecting: %s</td></tr>" % (repr(flag), repr(vals))
    dumpFileLoc(f)
    exit(-1)

def rU8 (f): return struct.unpack('B', f.read(1))[0]
def rU16(f): return struct.unpack('H', f.read(2))[0]
def rU32(f): return struct.unpack('I', f.read(4))[0]
def rU64(f): return struct.unpack('Q', f.read(8))[0]
def rF32(f): return struct.unpack('f', f.read(4))[0]

def rPackNum(f):
  size = rU8(f)
  if(size == 0x80): size = rU32(f)
  return size

def transStr(str):
  s = ''
  p = 0xAA
  for cc in str:
    a = ord(cc)
    val = ((a & ~p) ^ (~a & p)) & 0xff
    s += struct.pack("B", val )
    p += 1
  return s

def rUStr(f):
  size = rU8(f)
  return transStr(f.read(256 - size))

def dumpHeader(f):
  ident  = f.read(4)
  size   = rU64(f)
  offset = rU32(f)
  copy   = f.read(offset - f.tell())

  print "<tr><td>Header.FileIdentifier</td><td>%s</td></tr>" % ident
  print "<tr><td>Header.DataSize</td><td>%d</td></tr>" % size
  print "<tr><td>Header.DataStartOffset</td><td>0x%08x</td></tr>" % offset
  print "<tr><td>Header.Copyright</td><td>%s</td></tr>" % copy

def dumpDirInfo(f, sname):
  filename = rUStr(f)
  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.DirName</td><td>%s</td></tr>" % (sname, filename)
  print "<tr><td>%s.DirSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpLinkInfo(f, sname):
  fileloc  = rU32(f)

  pos = f.tell()
  f.seek(fileloc + 0x3c + 1, 0)
  filename = rUStr(f)
  f.seek(pos)

  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.LinkName (from %08x)</td><td>%s</td></tr>" % (sname, fileloc + 0x3c, filename)
  print "<tr><td>%s.LinkSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpFileInfo(f, sname):
  filename = rUStr(f)
  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.FileName</td><td>%s</td></tr>" % (sname, filename)
  print "<tr><td>%s.FileSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpDirTree(f, sname):
  fileCount = rPackNum(f)

  for i in range(fileCount):
    fileType = rU8(f)
    if  (fileType == 0x04): dumpFileInfo(f, sname + "[" + str(i) + "]")
    elif(fileType == 0x03): dumpDirInfo(f, sname + "[" + str(i) + "]")
    elif(fileType == 0x02): dumpLinkInfo(f, sname + "[" + str(i) + "]")
    else: exit(-1)

def dumpDirTrees(f):
  unknown = rU16(f)
  print "<tr><td>Unknown16</td><td>0x%04x</td></tr>" % unknown

  for i in range(45):
    dumpDirTree(f, "Dir[" + str(i) + "]")

def dump():
  f = open("data.wz", "rb")

  print "<html>"
  print " <head>"
  print "  <title>data.wz File Dump</title>"
  print " </head>"
  print " <body>"
  print "  <table>"
  dumpHeader(f)
  dumpDirTrees(f)
  dumpFileLoc(f)
  print "  </table>"
  print " </body>"
  print "</html>"

dump() 

```


The basic encryption that they used took me a long time to figure out.  But it was a fun puzzle.
## Post #72
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-19T11:16:49+00:00
- Post Title: 

Meds: I'm still not seeing source.

The only things in GeeWiz.zip are: bz2.pyd (python library), geeWiz.exe (the program), library.zip (a bunch of compiled python libraries), mapdump (all of the image offsets), mextract.exe (a program), MSVCR71.dll (a dll), python23.dll (a dll), python24.dll (a dll), README! (a text file), unicodedata.pyd (python library), w9xpopen.exe (a program), and zlib.pyd (a program).

I didn't see anything in the maplox!.zip either: bz2.pyd (python library), library.zip (a bunch of compiled python libraries), maplox.exe (the program), MSVCR71.dll (a dll), python24.dll (a dll), README! (a text file), unicodedata.pyd (python library), w9xpopen.exe (a program), and zlib.pyd (a program).

Am I blind and just not seeing it?  I apologize if I am.

--

Some fun notes about the file table: If you add up the sizes of all of the files in the very first directory, it adds up to the size of the whole data.wz minus the size of the header and the file table itself.  That's a good confirmation!

For those running the code, you'll need to redirect the output to an html file, ie: "dump.py > blah.html".  It was easier for me to extract to an html file then it was to write a real GUI for it...  especially when you are first figuring things out.  Basic text wasn't enough, because eventually we'll see images show up in the HTML document.  It starts to become a very large file very quickly.
## Post #73
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-08-19T12:27:20+00:00
- Post Title: 

Korean Maple's Data.wz file is split for them.

I dont use the tools.. :(
how can I use that?
## Post #74
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T13:33:09+00:00
- Post Title: 

> Reply from Meds
>
> I hate being called a scammer : ( So there you go : )



oops forgot the link
http://heat.castleparadox.com/mslvl/geewiz.php
: 3

Buy me a beer? : (
I will care your GeeWiz because I don't play GMS
=.=""""
thanks for sharing!~~~~
i want to buy you a beer 

and "care" i mean that your own copyright~!!!!!
Hong Kong guys love copryright
but not copy
## Post #75
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T13:55:49+00:00
- Post Title: 

> Reply from Lambda
>
> The next 16 bits after the header are unknown at the moment.  In the version of data.wz that I have, it's 0x0061.

After that, we begin the directory blocks.  In my version there are 45 directories, and I had to fix my extractor to use that value.  The program could be smarter and count the number of subdirectories and stop once it no longer finds them, or I could figure out the encoding used for file/directory offsets.  If anyone else figures it out, I'd be glad to know.

The first value is the count of how many files are in the directory.  Wizet tries to compactly store sizes.  If the size is less then 128, it just gives you the size as a single byte.  If it's >= then 128, it flags the value as a large value (hex code 0x80), and the next 4 bytes make up the actual count/size.
Code: Select alldef rPackNum(f):
  size = rU8(f)
  if(size == 0x80): size = rU32(f)
  return size


Once you know the number of files, start iterating over all of the entries.  Each entry has a: Identifier byte, filename (or link), filesize, and then two unknown values.

The identifier byte can be one of the following three values:  0x04 for files, 0x03 for directories, and 0x02 for symbolic links.

After the identifer, comes the filename.  The filenames and strings in the data.wz are tricky because wizet "encrypts" them.  (Look!  Scare quotes!  I'm shaking.)

The decryption key begins with: 0xAA (0101 0101).  If the value I'm encrypting is 0110 0111, and the key is 0101 0101, then the key will flip any bits where there is a 1 in the key; where there is a 0 in the key, the bit.  So with our current key, we flip bits 1,3,5, and 7, for the final value of: 0010 0010.  The decryption process works the same way.

After each character, the decryption key gets incremented by 1 (from 0xAA to 0xAB to 0xAC, etc...

The above complicated description boils down to the following 9 lines of code:
Code: Select alldef transStr(str):
  s = ''
  p = 0xAA
  for cc in str:
    a = ord(cc)
    val = ((a & ~p) ^ (~a & p)) & 0xff
    s += struct.pack("B", val )
    p += 1
  return s


Strings are guarenteed to be less then 256 characters.

Before each string is the negation/not of the string length.  So if the string length is 3, the value read in will actually be -3.  Since strings are less then 256 characters, the length is just a signed byte.

This leads to the following 3 lines of code:
Code: Select alldef rUStr(f):
  size = rU8(f)
  return transStr(f.read(256 - size))


Next is the filesize, and unknown1 (both PackNums), and then a 32 bit something for unknown2.

Symbolic links are the only oddities.  Instead of a string, it gives a 32 bit link to the file that it is pointing to.

Put it all together, and you get:
Code: Select allimport struct
from sys import exit

def dumpFileLoc(f):  print "<tr><td>FileLocation</td><td>%d</td></tr>" % f.tell()
def dumpFileSize(f): print "<tr><td>FileSize</td><td>%d</td></tr>" % getFileSize(f)

def check(flag, val, f):
  if(flag != val):
    print "<tr><td>Unknown: %s</td><td>Expecting: %s</td></tr>" % (repr(flag), repr(val))
    dumpFileLoc(f)
    exit(-1)

def checkA(flag, vals, f):
  if(not flag in vals):
    print "<tr><td>Unknown:  %s</td><td>Expecting: %s</td></tr>" % (repr(flag), repr(vals))
    dumpFileLoc(f)
    exit(-1)

def rU8 (f): return struct.unpack('B', f.read(1))[0]
def rU16(f): return struct.unpack('H', f.read(2))[0]
def rU32(f): return struct.unpack('I', f.read(4))[0]
def rU64(f): return struct.unpack('Q', f.read(8))[0]
def rF32(f): return struct.unpack('f', f.read(4))[0]

def rPackNum(f):
  size = rU8(f)
  if(size == 0x80): size = rU32(f)
  return size

def transStr(str):
  s = ''
  p = 0xAA
  for cc in str:
    a = ord(cc)
    val = ((a & ~p) ^ (~a & p)) & 0xff
    s += struct.pack("B", val )
    p += 1
  return s

def rUStr(f):
  size = rU8(f)
  return transStr(f.read(256 - size))

def dumpHeader(f):
  ident  = f.read(4)
  size   = rU64(f)
  offset = rU32(f)
  copy   = f.read(offset - f.tell())

  print "<tr><td>Header.FileIdentifier</td><td>%s</td></tr>" % ident
  print "<tr><td>Header.DataSize</td><td>%d</td></tr>" % size
  print "<tr><td>Header.DataStartOffset</td><td>0x%08x</td></tr>" % offset
  print "<tr><td>Header.Copyright</td><td>%s</td></tr>" % copy

def dumpDirInfo(f, sname):
  filename = rUStr(f)
  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.DirName</td><td>%s</td></tr>" % (sname, filename)
  print "<tr><td>%s.DirSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpLinkInfo(f, sname):
  fileloc  = rU32(f)

  pos = f.tell()
  f.seek(fileloc + 0x3c + 1, 0)
  filename = rUStr(f)
  f.seek(pos)

  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.LinkName (from %08x)</td><td>%s</td></tr>" % (sname, fileloc + 0x3c, filename)
  print "<tr><td>%s.LinkSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpFileInfo(f, sname):
  filename = rUStr(f)
  filesize = rPackNum(f)
  unknown1 = rPackNum(f)
  unknown2 = rU32(f)

  print "<tr><td>%s.FileName</td><td>%s</td></tr>" % (sname, filename)
  print "<tr><td>%s.FileSize</td><td>%d</td></tr>" % (sname, filesize)
  print "<tr><td>%s.Unknown1</td><td>0x%08x</td></tr>" % (sname, unknown1)
  print "<tr><td>%s.Unknown2</td><td>0x%08x</td></tr>" % (sname, unknown2)

def dumpDirTree(f, sname):
  fileCount = rPackNum(f)

  for i in range(fileCount):
    fileType = rU8(f)
    if  (fileType == 0x04): dumpFileInfo(f, sname + "[" + str(i) + "]")
    elif(fileType == 0x03): dumpDirInfo(f, sname + "[" + str(i) + "]")
    elif(fileType == 0x02): dumpLinkInfo(f, sname + "[" + str(i) + "]")
    else: exit(-1)

def dumpDirTrees(f):
  unknown = rU16(f)
  print "<tr><td>Unknown16</td><td>0x%04x</td></tr>" % unknown

  for i in range(45):
    dumpDirTree(f, "Dir[" + str(i) + "]")

def dump():
  f = open("data.wz", "rb")

  print "<html>"
  print " <head>"
  print "  <title>data.wz File Dump</title>"
  print " </head>"
  print " <body>"
  print "  <table>"
  dumpHeader(f)
  dumpDirTrees(f)
  dumpFileLoc(f)
  print "  </table>"
  print " </body>"
  print "</html>"

dump() 


The basic encryption that they used took me a long time to figure out.  But it was a fun puzzle.
it is your code or the code after 2000 evil click?
## Post #76
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-19T15:03:01+00:00
- Post Title: 

> Reply from singga
>
> It is your code or the code after 2000 evil click?

All the code I posted is mine.  As previously stated "The code is in the public domain and comes without warrenty."

I think the 2000 click thing was a joke.

> Reply from terasonic
>
> Korean Maple's Data.wz file is split for them.

I dont use the tools.. 
how can I use that?

If you follow the direction in Med's GeeWiz program about using a hex editor to find compressed blocks, you could use his program.  On his, I think you would have to: rename one of the split files "data.wz" and then extract just the images from that file, rename it back, and go on to the next file.

You can do a similar process with mine.  Except it'd probably be easiest to extend the program to take two arguments instead of just one (filename, and offset).  If you are a programmer that's an easy modification.

The other alternative is to wait.  After I finish up figuring out the rest of the global client data I'll probably move on to the other versions.

I'm through ~4500 data blocks out of the ~5500 data blocks in the global client.

[edit: misattributed a quote]
## Post #77
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T16:18:21+00:00
- Post Title: 

Download maplox extractor.
Find zlib offsets for each .wz files, save them in a file. ie (charactermapdump,  mobmapdump, etc)

Run maplox.exe all lol mobmapdump mob.wz

But in general maplox.exe all lol <zlib offset files> <file.wz> (without the <>)

You'll have to move each 0-XXXX folder into another folder since I didn't do a check for that kind of stuff.
## Post #78
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T16:19:39+00:00
- Post Title: 

> Reply from Lambda
>
> singga wrote:It is your code or the code after 2000 evil click?

All the code I posted is mine.  As previously stated "The code is in the public domain and comes without warrenty."

I think the 2000 click thing was a joke.
terasonic wrote:Korean Maple's Data.wz file is split for them.

I dont use the tools.. 
how can I use that?

If you follow the direction in Med's GeeWiz program about using a hex editor to find compressed blocks, you could use his program.  On his, I think you would have to: rename one of the split files "data.wz" and then extract just the images from that file, rename it back, and go on to the next file.

You can do a similar process with mine.  Except it'd probably be easiest to extend the program to take two arguments instead of just one (filename, and offset).  If you are a programmer that's an easy modification.

The other alternative is to wait.  After I finish up figuring out the rest of the global client data I'll probably move on to the other versions.

I'm through ~4500 data blocks out of the ~5500 data blocks in the global client.

[edit: misattributed a quote]

I have a serious question ask you 
I use Chinese Windows
Do i need to change my Windows Language When using geeWiz?
And also
the geeWizGMS data file is that the newest?if not may you please give me the newest mapledump 
[okornot.JPG](https://xentaxbackup.github.io/file/797_okornot.JPG)
## Post #79
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T16:40:45+00:00
- Post Title: 

> Reply from Meds
>
> Download maplox extractor.
Find zlib offsets for each .wz files, save them in a file. ie (charactermapdump,  mobmapdump, etc)

Run maplox.exe all lol mobmapdump mob.wz

But in general maplox.exe all lol <zlib offset files> <file.wz> (without the <>)

You'll have to move each 0-XXXX folder into another folder since I didn't do a check for that kind of stuff.

how can i Find zlib offsets?????
and i can't run the maplox extractor
why?????
## Post #80
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T16:46:10+00:00
- Post Title: 

GeeWiz only works with one .WZ file and it's set to read only Data.wz.

Download [http://heat.castleparadox.com/mslvl/maplox!.zip](http://heat.castleparadox.com/mslvl/maplox!.zip) and extract it to a folder with your .wz files.

Download HexWorkshop: [http://www.hexworkshop.com/](http://www.hexworkshop.com/)
Download Vedit: [http://vedit.com/index.html](http://vedit.com/index.html)
...intall

With HexWorkshop, find and load your .wz file. Next push Ctrl+F, and find 40056 16bit unsigned. (Find all instances, little endian)

When it's done finding all the offsets, then right click on the addresses and select Copy All

Now, open Vedit. Save the file first, name it anything you want. Paste the addresses that you copied.

Now go up to the very first line of the file, highlight everything until the end of '2' (ie, '     2   ') copy that. Now search and replace all '     2   ' with nothing. Save the file into the same folder with maplox.exe.

Open a cmd, goto your dir, and type [i]maplox.exe all lol mapdump whatever.wz[/i]
## Post #81
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T16:59:39+00:00
- Post Title: 

[quote="singga"]

how can i Find zlib offsets?????
and i can't run the maplox extractor
why????? :cry:  :cry:[/quote]

GMS mapdump is for Global maple, not chinese...follow the instructions up top to make one for Chinese maple.
## Post #82
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-19T23:24:31+00:00
- Post Title: 

> Reply from Meds
>
> GeeWiz only works with one .WZ file and it's set to read only Data.wz.

Download http://heat.castleparadox.com/mslvl/maplox!.zip and extract it to a folder with your .wz files.

Download HexWorkshop: http://www.hexworkshop.com/
Download Vedit: http://vedit.com/index.html
...intall

With HexWorkshop, find and load your .wz file. Next push Ctrl+F, and find 40056 16bit unsigned. (Find all instances, little endian)

When it's done finding all the offsets, then right click on the addresses and select Copy All

Now, open Vedit. Save the file first, name it anything you want. Paste the addresses that you copied.

Now go up to the very first line of the file, highlight everything until the end of '2' (ie, '     2   ') copy that. Now search and replace all '     2   ' with nothing. Save the file into the same folder with maplox.exe.

Open a cmd, goto your dir, and type maplox.exe all lol mapdump whatever.wz

I can't do the last step.
Look my step is right or wrong(i am MS DOS ass bump   )
I do all hexworkshop and vedit...
I click "run"
tape"CMD" in run
then CMD is open!(ye~it will be open XD )
i tape dir
then i tape <i>maplox.exe all lol mapdump whatever.wz</i>
then it say that
it is not correct commond
  
is there any taping mistake when DOS???
## Post #83
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-19T23:54:27+00:00
- Post Title: 

Lambda, I've since removed the GPL license from the .zip.
But here's my jerry-rigged code I've managed to build from what Valvwen posted:

```
import struct
import array
import sys
import zlib
###############
###############
###############
###############

def wtf(off, left, type, readbyte):
    sizeoff = int(off)-left
    try:
        dwz.seek(sizeoff)
        return struct.unpack(type, dwz.read(readbyte))[0]
    except:
        struct.error
        print "error"
##########################################################
def mextract(addy, wut):
	size = wtf(addy, 5, 'l', 4) 
	width13 = wtf(addy, 13, 'B', 1) 
	width20 = wtf(addy, 20, 'l', 4) 
	width16 = wtf(addy, 16, 'l', 4) 
	width17 = wtf(addy, 17, 'B', 1)
	width = ""

	if width13 == 0 or width13 <= 0:
		if width20 <= 0:
			width = width16
		else:
			if width20 >= 1048576:
				width = width17
			else:
				width = width20
	else:
		width = width13

	if size <= 0 or size > 2485760:
		pass
	else:
		dwz.seek(int(addy))
		compressed = dwz.read(size)

		sizeComp = len(compressed)
		compOff = 0
		obj = zlib.decompressobj()
		buf = ""
		try:
			while compOff < sizeComp:
				  d = obj.decompress(compressed[compOff])
				  if len(obj.unused_data) > 0:
					 break
				  buf += d
				  compOff += 1
		except zlib.error, details:
			pass
#############################################################################
		insize = len(buf)
		width = width
		height = insize / width / 2
					
		if( wut == 0 and (height != 0 and height < 9000) ):
			OUT = '%d'%int(addy)+'.bmp'

			fout = file(OUT,'wb')
			fout.write('BM')
			bmfh = struct.pack( 'LLL', insize*2 + 14 + 40, 0, 14+40 )
			fout.write(bmfh)
			bmih = struct.pack('LLLHHLLLLLL',
				40,
				width,
				height,
				1,
				32,
				0, 0, 0, 0, 0, 0 )
			fout.write(bmih)
			rgba = array.array('B')
			wFile = array.array('H')
			wFile.fromstring(buf)

			for y in range(height,0,-1):
				for pix in wFile[width * (y-1) : width * y]:
					a = ((pix >> 12) & 0xf) * 0x11
					r = ((pix >>  8) & 0xf) * 0x11
					g = ((pix >>  4) & 0xf) * 0x11
					b = ((pix >>  0) & 0xf) * 0x11
					rgba.extend( [b,g,r,a] )
			rgba.tofile(fout)

##############all##################
def mextractall():
	df = 0
	dr = 0
	os.mkdir("%d"%dr)
	os.chdir("%d"%dr)
	makeafile()
	while 1:
		addy = zloc.readline()
		if not addy:
			break
		mextract(addy, 0)
		if (df == 1000):
			os.chdir("..")
			dr = dr+df
			os.mkdir("%d"%dr)
			os.chdir("%d"%dr)
			makeafile()
			df = 0
		print float((float(zloc.tell())/float(zlocsize))*100)
		df += 1
##############Main################
if len(sys.argv) < 5:
	print 'Meds'
	print 'Usage maplox.py all lol zliboffsetFile zlibArchivethinger'
else:
	if sys.argv[2] != 'lol':
		print 'you need to lol'
	else:
		zloc = open(sys.argv[3], "rb")
		zloc.seek(0,2)
		zlocsize = zloc.tell()
		zloc.seek(0)
		dwz = open(sys.argv[4], "rb")
		dwz.seek(0, 2)
		dwzsize = dwz.tell()
		width = ""
		height= ""
		addy = sys.argv[1] ##test offset
		
		if( addy == 'all' ):
			mextractall()
```


The addresses for the widths were varying, and were found through trial and error. I had no idea how to view the extracted zlib chunks, and the only way I could view them were chucking it through Iceburg's program running in ARGB mode--that's why it's in bitmap format. Other than that, basic.
## Post #84
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T00:23:28+00:00
- Post Title: 

Lol that was the code I got from the-evil-2000-click-web-site-that-I-cheated-through-with-JavaScript! Grr... Did it for no reason...
## Post #85
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-20T01:05:53+00:00
- Post Title: 

> Reply from Meds
>
> Lambda, I've since removed the GPL license from the .zip.
But here's my jerry-rigged code I've managed to build from what Valvwen posted.

Thanks.

I'll post the block format tomorrow morning.  I was able to successfully parse through all of the inner files earlier today.  Each block has a block specific format and each of those have to be parsed, but if you don't know the format, they can still be skipped over (what I'm currently doing).

The walk/run/swim blocks I can get through, as well as the info blocks that have all of the icons used for the items.  I'll wait until that code is a little cleaner before posting it.
## Post #86
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-20T01:33:33+00:00
- Post Title: 

> Reply from themoviefund
>
> Lol that was the code I got from the-evil-2000-click-web-site-that-I-cheated-through-with-JavaScript! Grr... Did it for no reason...
can you teach me how to make the Java Script?  
geeWiz seems that don't work in  my computer
## Post #87
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T01:41:58+00:00
- Post Title: 

Why do you want to click? First, the web site is down already. Next, Meds put the code right here on the forums! But if you really want to know, I will attach an example... Hold on.

View the source of :
[broken link]
[broken link]
## Post #88
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T01:45:35+00:00
- Post Title: 

> Reply from themoviefund
>
>  Why do you want to click? First, the web site is down already. Next, Meds put the code right here on the forums! But if you really want to know, I will attach an example... Hold on.

View the source of :
http://www.themfund.com/grrr/frame1.html
http://www.themfund.com/grrr/something.html

You're a dirty little...I love you. That surely is thinking for yourself! Nicely done.
## Post #89
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T01:48:10+00:00
- Post Title: 

> Reply from Meds
>
> themoviefund wrote: Why do you want to click? First, the web site is down already. Next, Meds put the code right here on the forums! But if you really want to know, I will attach an example... Hold on.

View the source of :
http://www.themfund.com/grrr/frame1.html
http://www.themfund.com/grrr/something.html 

You're a dirty little...I love you.

... I feel complimented and insulted at the same time. Since you already put the code... I'll just show the "other guy" the code, because he apparently didn't read your post.

```
# Copyright (C) 2006 Meds

# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

# This was intended for educational use only. I will not be held responsible for any damages you may receive when you use this. This code must not be redistributed without this note and the above note.



import os
import struct
import array
import sys
import zlib
##########################################################
def wtf(off, left, type, readbyte):
    sizeoff = int(off)-left
    try:
        dwz.seek(sizeoff)
        return struct.unpack(type, dwz.read(readbyte))[0]
    except:
        struct.error
        print "error"
##########################################################
def mextract(addy, wut):
	size = wtf(addy, 5, 'l', 4) 
	width13 = wtf(addy, 13, 'B', 1) 
	width20 = wtf(addy, 20, 'l', 4) 
	width16 = wtf(addy, 16, 'l', 4) 
	width17 = wtf(addy, 17, 'B', 1)
	width = ""

	if width13 == 0 or width13 <= 0:
		if width20 <= 0:
			width = width16
		else:
			if width20 >= 1048576:
				width = width17
			else:
				width = width20
	else:
		width = width13

	if size <= 0 or size > 2485760:
		pass
	else:
		dwz.seek(int(addy))
		compressed = dwz.read(size)

		sizeComp = len(compressed)
		compOff = 0
		obj = zlib.decompressobj()
		buf = ""
		try:
			while compOff < sizeComp:
				  d = obj.decompress(compressed[compOff])
				  if len(obj.unused_data) > 0:
					 break
				  buf += d
				  compOff += 1
		except zlib.error, details:
			pass
#############################################################################
		insize = len(buf)
		width = width
		height = insize / width / 2
					
		if( wut == 0 and (height != 0 and height < 9000) ):
			OUT = '%d'%int(addy)+'.bmp'

			fout = file(OUT,'wb')
			fout.write('BM')
			bmfh = struct.pack( 'LLL', insize*2 + 14 + 40, 0, 14+40 )
			fout.write(bmfh)
			bmih = struct.pack('LLLHHLLLLLL',
				40,
				width,
				height,
				1,
				32,
				0, 0, 0, 0, 0, 0 )
			fout.write(bmih)
			rgba = array.array('B')
			wFile = array.array('H')
			wFile.fromstring(buf)

			for y in range(height,0,-1):
				for pix in wFile[width * (y-1) : width * y]:
					a = ((pix >> 12) & 0xf) * 0x11
					r = ((pix >>  8) & 0xf) * 0x11
					g = ((pix >>  4) & 0xf) * 0x11
					b = ((pix >>  0) & 0xf) * 0x11
					rgba.extend( [b,g,r,a] )
			rgba.tofile(fout)
		else:
			print 'hi'

##############all##################
def mextractall():
	df = 0
	dr = 0
	os.mkdir("%d"%dr)
	os.chdir("%d"%dr)
	while 1:
		addy = zloc.readline()
		if not addy:
			break
		mextract(addy, 0)
		if (df == 1000):
			os.chdir("..")
			dr = dr+df
			os.mkdir("%d"%dr)
			os.chdir("%d"%dr)
			df = 0
		print float((float(zloc.tell())/float(zlocsize))*100)
		df += 1
##############Main################
#if len(sys.argv) < 3:
print 'Maple Extract by Meds'
#else:
#	if sys.argv[2] != 'lol':
#		print 'Maple Extract by Meds, you need to lol'
#	else:
zloc = open("zliboffsets", "rb")
zloc.seek(0,2)
zlocsize = zloc.tell()
zloc.seek(0)
dwz = open("Data.wz", "rb")
dwz.seek(0, 2)
dwzsize = dwz.tell()
width = ""
height= ""
#		addy = sys.argv[1] ##test offset
		
#		if( addy == 'all' ):
mextractall()

```


I edited *some* code.
## Post #90
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T01:52:29+00:00
- Post Title: 

Awe, but you need to lol~ Come on!
## Post #91
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T01:57:33+00:00
- Post Title: 

Lol.     

Right now I'm trying to combine your's and Lambda's to make an extractor that can sort the pictures (i.e with image names and directory names).
## Post #92
- Username: Crohm
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Sun Aug 20, 2006 9:59 am
- Post datetime: 2006-08-20T02:05:40+00:00
- Post Title: 

Hello.

Well i have a kind of a nooby question XD  would there be a way to like.. make server files with all that? So that let's say me and my friend could play in a closed server where we could play maple the way we'd want. Let's admit it, maple global's rates SUCK. Me and my friend would just like to play and actually get somewhere without sacrificing our social life. 

So, is it possible? Chck out the attachement and tell me if those empty folders could be filled with the data they need to work.


Thanks  ^^
[Maple_Emul.rar](https://xentaxbackup.github.io/file/809_Maple_Emul.rar)
## Post #93
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T02:29:09+00:00
- Post Title: 

> Reply from Crohm
>
> Hello.

Well i have a kind of a nooby question XD  would there be a way to like.. make server files with all that? So that let's say me and my friend could play in a closed server where we could play maple the way we'd want. Let's admit it, maple global's rates SUCK. Me and my friend would just like to play and actually get somewhere without sacrificing our social life. 

So, is it possible? Chck out the attachement and tell me if those empty folders could be filled with the data they need to work.


Thanks  ^^

Woah there...we don't do that here. That's illegal.
## Post #94
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T02:32:17+00:00
- Post Title: 

Welcome to the forums!!!

Well, I don't think we can do that.

(And by we, I mostly mean them.)
I don't know that much about Python. Thank you Google! 
T.T

[deleted for meaness]

Sorry sorry sorry sorry sorry sorry sorry sorry
## Post #95
- Username: Crohm
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Sun Aug 20, 2006 9:59 am
- Post datetime: 2006-08-20T02:44:17+00:00
- Post Title: 

Nope, i checked around a bit. Didnt see its illegal. Sorry >_<  And no i didnt join just for that lol. That was a quetion. Nothing more. Answer's yes. Yay. Answers no. Meh too bad. 

Well sorry 'bout it. I think im gonna read the rules now...
## Post #96
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T02:50:48+00:00
- Post Title: 

But I agree with you on the exp rate, it made me an alcoholic : (

Oh and MovieFund, sorry I didn't see your PM until now.
## Post #97
- Username: Crohm
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Sun Aug 20, 2006 9:59 am
- Post datetime: 2006-08-20T02:59:59+00:00
- Post Title: 

Nothing here!   

Hehe.
## Post #98
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T03:05:15+00:00
- Post Title: 

I'm sorry, I should be nicer.         
Sorry, sorry, sorry. I mean it   

Welcome to the forums!!!
## Post #99
- Username: Crohm
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Sun Aug 20, 2006 9:59 am
- Post datetime: 2006-08-20T03:09:49+00:00
- Post Title: 

XD Thank you ^^ 
This forum actually got me into reading the topics. Interesting. Meh, I wont be posting much since i'll prolly read more. Though i should post from time to time. Hehe.
## Post #100
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T05:02:33+00:00
- Post Title: 

Ok, now that we have "kinda" figured out the images, what about all the text files and sounds?
## Post #101
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-20T08:49:41+00:00
- Post Title: 

> Reply from themoviefund
>
> I'm sorry, I should be nicer.         
Sorry, sorry, sorry. I mean it   

Welcome to the forums!!!
making private serve is very lost your mind...
and also money(real)
but i want to play it XD
## Post #102
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-20T08:52:57+00:00
- Post Title: 

Med,do you have any plans to close geeWiz again?
i need to make a buckup~  

and moviefound...
if you done the extractor,
will you share with us??
## Post #103
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-08-20T09:13:00+00:00
- Post Title: 

> Reply from Meds
>
> With HexWorkshop, find and load your .wz file. Next push Ctrl+F, and find 40056 16bit unsigned. (Find all instances, little endian)

When it's done finding all the offsets, then right click on the addresses and select Copy All

Now, open Vedit. Save the file first, name it anything you want. Paste the addresses that you copied.

Now go up to the very first line of the file, highlight everything until the end of '2' (ie, '     2   ') copy that. Now search and replace all '     2   ' with nothing. Save the file into the same folder with maplox.exe.

Open a cmd, goto your dir, and type maplox.exe all lol mapdump whatever.wz

I playing stap 3. But I don't know this mean.. 'Now search and replace all '     2   ' with nothing'.

serch '2' and replace 'speace'?
Delete all '2'?
## Post #104
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-20T09:23:15+00:00
- Post Title: 

> Reply from terasonic
>
> Meds wrote:With HexWorkshop, find and load your .wz file. Next push Ctrl+F, and find 40056 16bit unsigned. (Find all instances, little endian)

When it's done finding all the offsets, then right click on the addresses and select Copy All

Now, open Vedit. Save the file first, name it anything you want. Paste the addresses that you copied.

Now go up to the very first line of the file, highlight everything until the end of '2' (ie, '     2   ') copy that. Now search and replace all '     2   ' with nothing. Save the file into the same folder with maplox.exe.

Open a cmd, goto your dir, and type maplox.exe all lol mapdump whatever.wz

I playing stap 3. But I don't know this mean.. 'Now search and replace all '     2   ' with nothing'.

serch '2' and replace 'speace'?
Delete all '2'?

that means:
you search "2"
and don't tap anythings in replace~~~~~


But i don't know the last step :

dir  maplox.exe all lol mapdump whatever.wz

is there any taping mistake in my DOS?
please help me
## Post #105
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-20T09:34:00+00:00
- Post Title: 

Oh!Hell!!!!!!!
I put Data.wz(GMS) file in geeWiz file.
and extract library.zip in folder into geewiz file.
but it still not work(nothing display)
what the hell get on? 
[anythingwrong.JPG](https://xentaxbackup.github.io/file/810_anythingwrong.JPG)
## Post #106
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-08-20T16:46:37+00:00
- Post Title: 

GeeWiz, don't have a cow. (See what I did? <_<)

But seriously, don't lose your cool.
## Post #107
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T17:42:06+00:00
- Post Title: 

Sure, I'll share my extractor when I'm done. Right now, I'm trying to organize the pictures.
## Post #108
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T17:54:42+00:00
- Post Title: 

You know, you don't have to do Med's Search and Replace step. You can use this:

```
import os
import sys
import zlib

f = open("Data.wz", "rb")

start = 0
f.seek(0, 2)
size = f.tell()
f.seek(0)
obj = zlib.decompressobj()
buf = ""

while start < size:
   offset = start
   obj = zlib.decompressobj()
   buf = ""
   try:
      while offset < size:
         d = obj.decompress(f.read(1))
         if len(obj.unused_data) > 0:
            break
         buf += d
         offset += 1
   except zlib.error, details:
      if str(details) == "Error -3 while decompressing: invalid stored block lengths" and len(buf) > 0:
         print start
      start += 1
      f.seek(start)
      continue
   print start
   start += 1
   f.seek(start)

f.close() 

```


It's not mine. It may take a while. When it's done, copy and paste everything to the mapdump file.
## Post #109
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-20T17:58:43+00:00
- Post Title: 

> Reply from singga
>
> terasonic wrote:Meds wrote:With HexWorkshop, find and load your .wz file. Next push Ctrl+F, and find 40056 16bit unsigned. (Find all instances, little endian)

When it's done finding all the offsets, then right click on the addresses and select Copy All

Now, open Vedit. Save the file first, name it anything you want. Paste the addresses that you copied.

Now go up to the very first line of the file, highlight everything until the end of '2' (ie, '     2   ') copy that. Now search and replace all '     2   ' with nothing. Save the file into the same folder with maplox.exe.

Open a cmd, goto your dir, and type maplox.exe all lol mapdump whatever.wz

I playing stap 3. But I don't know this mean.. 'Now search and replace all '     2   ' with nothing'.

serch '2' and replace 'speace'?
Delete all '2'?

that means:
you search "2"
and don't tap anythings in replace~~~~~


But i don't know the last step :

dir  maplox.exe all lol mapdump whatever.wz

is there any taping mistake in my DOS?
please help me

```
C:\Random Folder 1>cd where i keep geewiz
C:\Random Folder 1\Where I keep GeeWiz\>maplox.exe all lol mapdump whatever.wz
```
## Post #110
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T21:19:30+00:00
- Post Title: 

HexWorkshop outputs ~50 offsets/sec, it's the fastest solution.
## Post #111
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T21:27:01+00:00
- Post Title: 

Props to Lambda on the text encryption.
## Post #112
- Username: CWP
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Fri Jun 02, 2006 9:49 am
- Post datetime: 2006-08-20T21:30:52+00:00
- Post Title: 

> Reply from Meds
>
> HexWorkshop outputs ~50 offsets/sec, it's the fastest solution.You already know the compressed size. Wouldn't it be better to modify the script so that it will skip over the gzip data? I mean you know that there won't be any other gzip header information within the gzip data block.
## Post #113
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-20T21:32:03+00:00
- Post Title: 

It's old code, so it needs the start of the zlib offsets to work. I haven't touched it since March when all the data I went by was iffy at best--so it needs a crutch.

But that's Valvwen's zlib location script, the valuable thing in that is the decompression routine.
## Post #114
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-20T22:04:31+00:00
- Post Title: 

I was going to post the block format this morning, but I started making some really good progress and decided to wait.

I have the majority of the rest of the file figured out.  All of the images, text, etc...  but MS Windows doesn't look too kindly on having over 100,000+ images in a single directory.  Firefox also goes a little nuts with 30 meg html files filled with that many images as well.

Give me a few more hours of clean up to fix those problems, and then everyone can smile.
## Post #115
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-21T00:57:35+00:00
- Post Title: 

This breaks down when you try to extract from the Korean Maple, since they break Data.wz into it's folder ie: Character.wz, Effect.wz...etc.

But we can just iterate through the different .wz(s).
## Post #116
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-21T01:10:38+00:00
- Post Title: 

> Reply from themoviefund
>
> singga wrote:terasonic wrote:

I playing stap 3. But I don't know this mean.. 'Now search and replace all '     2   ' with nothing'.

serch '2' and replace 'speace'?
Delete all '2'?

that means:
you search "2"
and don't tap anythings in replace~~~~~


But i don't know the last step :

dir  maplox.exe all lol mapdump whatever.wz

is there any taping mistake in my DOS?
please help me  
Code: Select allC:\> cd random folder 1
C:\Random Folder 1>cd where i keep geewiz
C:\Random Folder 1\Where I keep GeeWiz\>maplox.exe all lol mapdump whatever.wz
Oh My Godsssssh~~~   

Wizet is very bitc*y
I can't use 
```
dir C:\Wizet>Maple
```

and go into the KMS file to take GeeWiz.
## Post #117
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-21T02:01:02+00:00
- Post Title: 

Ehh...  not to happy with where I got.  I've extracted up to file 4104 (out of 5991), but you have to flip some bits in various places to get it to work that far.  The file format seems inconsistant and I haven't been able to track down a logical method of getting around it.

The attached file will extract everything up to file 1593, and then after that it just extracts basic strings and icons for the rest of them.  Place the file in the same directory as your data.wz, and run it (you'll need python installed).  You don't have to redirect output or do anything special in DOS.  Just double click on it and watch it go.  It creates a "dump" directory and places a bunch of HTML and directories full of images in it.

Maybe next weekend I'll have some more time to look at it.  It still needs more polish.  A next/back button, an actual index page, I removed some of the prints and so now the file table shows nothing...

It's only been tested with GMS.
[dump.zip](https://xentaxbackup.github.io/file/816_dump.zip)
## Post #118
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-21T02:49:27+00:00
- Post Title: 

Wow, Lambda, that is excellent! ... You even extract information! Thanks so much!

That's no dump, that's a gold mine!     

Can't wait for the rest to come!

(I know, I know.)
## Post #119
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-21T07:14:31+00:00
- Post Title: 

Any one who uses my method and cares to convert the bitmap to png use nconvert and this script:

```
def makepng():
	status = 0
	dr = 0
	while status != -2:
		cr = '%d'%dr
		cmd='"C:\\Program Files\\XnView\\nconvert.exe" -D -out png -o '+cr+'_png/%.png '+cr+'/*'
		try:
			status = os.system(cmd)
		except:
			continue
		dr+=1000
##:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::##
def deldir():
	dc = 0
	dl = 1
	while dl:
		ch = os.listdir('%d'%dc)
		try:
			if ch[0]>1:
				dl = 1
			else:
				os.system('rmdir %d'%dc+' /q')
		except:
			os.system('rmdir %d'%dc+' /q')
			dl = 1
		dc +=1000
makepng()
```
## Post #120
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-22T03:09:34+00:00
- Post Title: 

Oh thanks!
## Post #121
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-08-22T09:28:37+00:00
- Post Title: 

Who can help me to make Chinese MS mapdump because they had a new exclusive map.......
I want to know that is there any new monster(not release)in CMS data.wz 
[Maple0099_GnkdhNlnYlnW.jpg](https://xentaxbackup.github.io/file/820_Maple0099_GnkdhNlnYlnW.jpg)
## Post #122
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-08-22T16:32:22+00:00
- Post Title: 

I was looking through my data.wz, and the unknown 16 bit number is 0x0060, whcih is diff from what lambda got.  

i was looking at the directory structure and it seems fairly simple.
First read the root directory, if it has x folders, then the next x nodes are its sub folders.  This function is just an example, it won't work with any of the code already here.

```
    numDirs = 0
    print "Node:", self.nodeNum
    self.nodeNum += 1
    temp = self.readNode()
    for ctr in range(temp):
        self.readDirs()

```


Also, later on there are the files in node 42, Bgm00.img to Bgm13.img, BgmEvent.img, BgmJp.img, BgmUI.img are all uncompressed mp3s.  i'm guessing .img is a container format, not an image format.  So are there individual file names or just block names?
## Post #123
- Username: Lok
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Wed Aug 23, 2006 4:41 am
- Post datetime: 2006-08-22T20:44:33+00:00
- Post Title: 

Meds, where can you get NConvert? I tried searching it, and I downloaded it from this one site, but when I tried to install it, I got an error.

'Access violation at address 004091A2. Write of address 00401000'

Any help?

Edit : It's worked now for some reason. o_o
## Post #124
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-23T00:40:09+00:00
- Post Title: 

> Reply from Omega
>
> I was looking through my data.wz, and the unknown 16 bit number is 0x0060, whcih is diff from what lambda got.  

i was looking at the directory structure and it seems fairly simple.
First read the root directory, if it has x folders, then the next x nodes are its sub folders.

Also, later on there are the files in node 42, Bgm00.img to Bgm13.img, BgmEvent.img, BgmJp.img, BgmUI.img are all uncompressed mp3s.  i'm guessing .img is a container format, not an image format.  So are there individual file names or just block names?

Good observation on the sub folders.  The files are also in the same order as they are listed in the file table.  I'll do some testing with the subfolder idea.  I was worried about assuming things like that, on the chance that it's just a coincidence that the files/directories are in order, or if that's actually the design of the format.  I still think that one of the two unknown fields in each file entry is an encoded file offset to the actual entry.  My other guesses are a crc32 checksum and the unpacked size of the structures.  (unknown 1 ~= 20 * size).

The .img files are container files / structures.  See the output from the dump.py script for an example.
## Post #125
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-08-23T06:36:25+00:00
- Post Title: 

> Reply from Lambda
>
> Omega wrote:I was looking through my data.wz, and the unknown 16 bit number is 0x0060, whcih is diff from what lambda got.  

i was looking at the directory structure and it seems fairly simple.
First read the root directory, if it has x folders, then the next x nodes are its sub folders.

Also, later on there are the files in node 42, Bgm00.img to Bgm13.img, BgmEvent.img, BgmJp.img, BgmUI.img are all uncompressed mp3s.  i'm guessing .img is a container format, not an image format.  So are there individual file names or just block names?

Good observation on the sub folders.  The files are also in the same order as they are listed in the file table.  I'll do some testing with the subfolder idea.  I was worried about assuming things like that, on the chance that it's just a coincidence that the files/directories are in order, or if that's actually the design of the format.  I still think that one of the two unknown fields in each file entry is an encoded file offset to the actual entry.  My other guesses are a crc32 checksum and the unpacked size of the structures.  (unknown 1 ~= 20 * size).

The .img files are container files / structures.  See the output from the dump.py script for an example.

Just to note, this is my first time trying to break up one of these files.  I'm dumbfounded by how much you figured out so fast and just trying to learn what I can. Anywayz.
About the crc that was my guess as well but i haven't tried (perhaps of the .img).  If i were to program a file system i'd probably have the offsets at the beginning, though just adding up the filesizes seems to accomplish the same thing (tested for first 10 or so).
If you are correct about encrypted file positions, it shouldn't be too hard to figure out given that we already know the answer.
The folders do seem to be in order, the last three seem to fit the pattern: last is UI, 2nd last is strings (EULA.img, tooltiphelp), and 3rd last is sound (bgmXX).  I haven't bothered to check through the files themselves, my laptop starts to cook if i run it too long  (probably due to the amount of info i output, i need to clean that up).

I'm curious where you got the number 5991 from (im assuming number of blocks?) cause i counted the number of files at the beginning and there are only 5959. 44 directories and 47 shortcuts doesn't seem to make up the diff (which is 32, no clue if thats relevant).

I'm sure you know this stuff, but I'll say it anyway.  Your immedValue is just a special case of dumpBlock (with obvious benefits) as is your dumpEntryBlock (except for 0x08 which is weird).  For dumpEntryBlock, do you think its just they didn't feel like making different codes, or that they're somehow the same function?
Well thats all for me for now.
## Post #126
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-23T12:25:14+00:00
- Post Title: 

> Reply from Omega
>
> Just to note, this is my first time trying to break up one of these files.  I'm dumbfounded by how much you figured out so fast and just trying to learn what I can. Anywayz.

I've was working on it off and on for a few weeks privately before the flurry of activity started.  That said, I started making some amazing progress after I figured out the text encryption.  The zlib hints I read here helped as well.  I should have read Mr. Mouse's Guide to Reverse Engineering file formats.  It would have explained all that!

You've done good with the time you've spent on it, and you have a talent for noticing patterns, which is huge when trying to figure this type of thing out.  You should be proud.

> Reply from Omega
>
> I'm curious where you got the number 5991 from (im assuming number of blocks?) cause i counted the number of files at the beginning and there are only 5959. 44 directories and 47 shortcuts doesn't seem to make up the diff (which is 32, no clue if thats relevant).

I think we have different versions of data.wz.  Maybe that's what the 0x61 is?  And why yours is only 0x60.  My file table has 6035 entries - 45 directories + 1 becaues the root directory isn't listed = 5991.

The symbolic link thing was a bad guess on my part.  They were just trying to save space listing the same string twice.  "Ohh... use the string at 0x83948 instead", I can save 3 bytes by linking to strings like that!

> Reply from Omega
>
> I'm sure you know this stuff, but I'll say it anyway.  Your immedValue is just a special case of dumpBlock (with obvious benefits) as is your dumpEntryBlock (except for 0x08 which is weird).  For dumpEntryBlock, do you think its just they didn't feel like making different codes, or that they're somehow the same function?

I thought that too, but I had trouble getting it to work.  dumpBlock and dumpEntry have different interpretations of 0x00 (one is a null, one is a string), and like you said, 0x08 is just weird.

I'm kind of happy with having immedValue as a seperate case, as I think it makes certain things clearer.  Since blocks are just descriptions of structs, the main format is: :valuename: then :value:.  :Valuename:s can only be immedValues, while :value:s can be a variety of things.  It wouldn't make sense to have an image being a :valuename:.  But that's just a personal preference, and the two could be merged.  Good observation.

The 32 bit ints in immedValue are actually links to strings (so they can save a few bytes, just like in the file table).  But valuenames are repeated more often, so they really do save space with it.  The filenames aren't repeated enough for any decent savings.
## Post #127
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-08-24T00:17:55+00:00
- Post Title: 

check it. this is maple's music extractor.



name : terasonic
code : 155018442814BD52
## Post #128
- Username: Savage
- Rank: VIP member
- Number of posts: 559
- Joined date: Sun Apr 17, 2005 6:00 pm
- Post datetime: 2006-08-24T03:15:15+00:00
- Post Title: 

I don't know if it helps...but....looking inside the file ZLZ.dll (uops it'a zlib1.dll)

[quote]
 deflate 1.1.3 Copyright 1995-1998 Jean-loup Gailly                                       Â
## Post #129
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-29T03:50:26+00:00
- Post Title: 

Lambda, are you still working on extracting?
## Post #130
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-29T08:44:36+00:00
- Post Title: 

> Reply from themoviefund
>
> Lambda, are you still working on extracting?

Yes, but work has gotten in the way of finishing it completely during the week.  My script can parse the entire file including all images and music.  I reworked a large part of it, but now it doesn't print anything out.  The other current problem is not handling wide strings (unicode).  The unicode text also causes problems when outputting decent filenames for items...  You can't really have a filename with tabs or returns in them, but that's what it would try to generate now.

I'll go ahead and post it so anyone else can look at it.  Hopefully I'll have more time over Labor Day weekend.
[dump.zip](https://xentaxbackup.github.io/file/833_dump.zip)
## Post #131
- Username: nicoli_s
- Rank: advanced
- Number of posts: 77
- Joined date: Fri Jan 07, 2005 2:47 pm
- Post datetime: 2006-08-29T16:46:18+00:00
- Post Title: 

I work for a game DB website and I've been trying desperately to extract info from MS. Great work on figuring all this stuff out btw. I had a small question, I added in a print in the dumpfile function so I could grab the stats from items like I could in your old version, but when it runs, all I see is refernces to the differnet animations for each item, and while the names work fine, the value returned from dump entry value always shows as none for me, im just doing a simple "print "%s is %s" % (str(val), str(value))" where value is the return from dumpentryvalue This is my first time using python so i might be doing something wrong, any ideas?
## Post #132
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-08-30T00:04:42+00:00
- Post Title: 

> Reply from nicoli_s
>
> I work for a game DB website and I've been trying desperately to extract info from MS. Great work on figuring all this stuff out btw. I had a small question, I added in a print in the dumpfile function so I could grab the stats from items like I could in your old version, but when it runs, all I see is refernces to the differnet animations for each item, and while the names work fine, the value returned from dump entry value always shows as none for me, im just doing a simple "print "%s is %s" % (str(val), str(value))" where value is the return from dumpentryvalue This is my first time using python so i might be doing something wrong, any ideas?

It doesn't return lists of values correctly (like the item stats are: Required Level: 1, Exp: 20, etc..).  See extract08type and extract1btype (a few places)... they don't return values ("None").  If you put a return in extract08type, you might get better results.

Good job playing with it as much as you have, it takes confidence to jump into someone else's code and start modifying things.

A big hint: Get rid of the giant for loop at the very bottom.  Running through 5000 entries and getting things to work that way is difficult.  Just dump the first file and get the prints looking good for that.  Also, the code is a little better written now, and you can jump around file entries, if you just want to dump file 1958, you can.  You don't have to go through all of them if you just want specific information.

Hopefully I'll have a chance this weekend to write some nice output routines myself.
## Post #133
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-08-30T02:39:53+00:00
- Post Title: 

Please hurry   By the way, thank you for all this, it's very useful.
## Post #134
- Username: nicoli_s
- Rank: advanced
- Number of posts: 77
- Joined date: Fri Jan 07, 2005 2:47 pm
- Post datetime: 2006-08-30T22:47:18+00:00
- Post Title: 

awesome,appreciate that, now I can get most of the data I need  one question though, have you found any way to get the name of any of the entries?
## Post #135
- Username: masterburner
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Fri Sep 01, 2006 3:31 am
- Post datetime: 2006-08-31T19:37:15+00:00
- Post Title: 

First thanks Lambda i got the Pics  

so GeeWitz is working with my Mapdump 

and i tried MAplox but i get this error

Is something wrong with my OS   o_o

[](http://www.imagethrust.com)
## Post #136
- Username: Meds
- Rank: beginner
- Number of posts: 36
- Joined date: Sun Feb 26, 2006 10:16 am
- Post datetime: 2006-08-31T20:12:19+00:00
- Post Title: 

> Reply from masterburner
>
> 

There's already a folder named '0', delete it.
## Post #137
- Username: masterburner
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Fri Sep 01, 2006 3:31 am
- Post datetime: 2006-09-01T17:15:36+00:00
- Post Title: 

> Reply from Meds
>
> masterburner wrote:



There's already a folder named '0', delete it.

THY Meds so simple   

[](http://www.imagethrust.com)


Uh yeah SOO many PICS thank you again but can you tell me how to disable the Black background ?
## Post #138
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-04T01:00:36+00:00
- Post Title: 

All right.  This is about the best that it gets from me.

About 10 images don't extract correctly, I'm not sure why.  There are still some unicode issues as well.  If anyone wants to look at it, try transStr16.  0xAAAA generally works as a decode key, but not in all cases.  Sound doesn't extract, but it's a simple change (add an extra parameter to dumpMp3 for the filename, and pass in the name from extract1b and extract73type.)  The code is just commented out.  An index page would be nice, as well as front/back buttons.  Changing the background colors on the generated html pages would be nice so you can see images that are white.  Versions that work for other versions of maple story should be relativly easy to write aside from the unicode issues.

It's also extremely slow...  On the order of 2 1/2 hours to extract everything.  Someone would have to rewrite it in C to make it faster.

It's up to everyone else if anyone wants more features.  I just did this as a challenge.  I don't even play MapleStory.  Good luck.

If anyone has any questions, I'll be around.  Thanks to Mr.Mouse for providing this resource.  It's been fun.
[dump.zip](https://xentaxbackup.github.io/file/838_dump.zip)
## Post #139
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-09-04T10:49:57+00:00
- Post Title: 

yep~~~
this guy come from China......
He is name is"SJXsoft""
but he is not here right now...
he has some problem.....
that is he made a "wz Extractor"
it is fit....
only3MB....
but some china guy attack his server...
so he stop qouter ot using....
now he has a problem:
that is when we throw the items(in Maple)the items will turn in360*.
but his scanner can't be scan this...
why?
he is investing to Ver2.0...
here is his discover and extractor pic:
his scanner scanned pic:
his scanner:





keep on contact~~~
his blog:sjxsoft.my.766.com
## Post #140
- Username: masterburner
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Fri Sep 01, 2006 3:31 am
- Post datetime: 2006-09-04T11:36:58+00:00
- Post Title: 

THY lambda Your Dumper can even extract pics from the EMS data.wz 
and they are in PNG i love you   

[](http://www.imagethrust.com)
## Post #141
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-09-04T13:03:22+00:00
- Post Title: 

> Reply from Lambda
>
> All right.  This is about the best that it gets from me.

About 10 images don't extract correctly, I'm not sure why.  There are still some unicode issues as well.  If anyone wants to look at it, try transStr16.  0xAAAA generally works as a decode key, but not in all cases.  Sound doesn't extract, but it's a simple change (add an extra parameter to dumpMp3 for the filename, and pass in the name from extract1b and extract73type.)  The code is just commented out.  An index page would be nice, as well as front/back buttons.  Changing the background colors on the generated html pages would be nice so you can see images that are white.  Versions that work for other versions of maple story should be relativly easy to write aside from the unicode issues.

It's also extremely slow...  On the order of 2 1/2 hours to extract everything.  Someone would have to rewrite it in C to make it faster.

It's up to everyone else if anyone wants more features.  I just did this as a challenge.  I don't even play MapleStory.  Good luck.

If anyone has any questions, I'll be around.  Thanks to Mr.Mouse for providing this resource.  It's been fun.

oh my god!!!!
how to use it?
i am stupid!!!!
## Post #142
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-04T15:00:21+00:00
- Post Title: 

> Reply from singga
>
> oh my god!!!!
how to use it?
i am stupid!!!!

Install python ([http://www.python.org/download/](http://www.python.org/download/)).
Extract dump.py from the zip into your Maple directory, or where you have data.wz.
Double click on dump.py and wait...  wait a really long time.
When it's done, go into a new directory (dump), and enjoy.

And as a rule of thumb, don't use the cry emoticon.  It makes you sound childish and people less likely to reply to your comments.
## Post #143
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-04T17:23:09+00:00
- Post Title: 

Thank you. Now to output all the text into an XML file for my web site. =)

Can somebody help me with outputing the XML file? I've tried everything I can think of, but nothing is outputting a correct file...

How can I work with ONLY the Mobs directory?

```

```
## Post #144
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-05T01:38:14+00:00
- Post Title: 

> Reply from themoviefund
>
> Thank you. Now to output all the text into an XML file for my web site. =)

Can somebody help me with outputing the XML file? I've tried everything I can think of, but nothing is outputting a correct file...

How can I work with ONLY the Mobs directory?

At the very bottom of the file are two options, dumpImages = 1 and dumpHTML = 1.  Turn off dump images if you've already done it once.  It will speed up your work tremendously.

To work with only the mobs directory, modify the for loop in dump().  On my version of data.wz, the mobs are from 4957 to 5336.  So modify 'for i in range(len(dirTree["Files"])):' to read 'for i in range(4957,5336):'.

You could also compare the file name near the top of the for loop.  The filename is in: file["Name"].  So you'd add something like:  'if(file["Name"][0:4] == "/Mob/"):' and indent everything underneath it.
## Post #145
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-09-05T02:03:54+00:00
- Post Title: 

Thanks All guys. :)
I did it!

but.. I have a some problem.

How can i change the making folder name? (main folder - ex. dump)
## Post #146
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-05T02:23:42+00:00
- Post Title: 

Thanks Lambda.

> Reply from terasonic
>
> Thanks All guys. 
I did it!

but.. I have a some problem.

How can i change the making folder name? (main folder - ex. dump)

At the bottom of the file, change the "DumpDirBase" to something more suitable.
## Post #147
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-09-05T02:32:51+00:00
- Post Title: 

Thanks themoviefund :)
## Post #148
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-05T03:33:42+00:00
- Post Title: 

Ok. This is too hard. I'm having a hard time counting how many pictures there are for each monster animation, and I can't extract only the animation delays with the script. I tried using regular expressions, but they failed. One more thing: is there a way to concencate a list together with a "splitter" (i.e. ",") in Python? And I don't suppose that you can retrieve the name of the monster right?
## Post #149
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-05T03:55:05+00:00
- Post Title: 

> Reply from themoviefund
>
> Ok. This is too hard. I'm having a hard time counting how many pictures there are for each monster animation, and I can't extract only the animation delays with the script. I tried using regular expressions, but they failed. One more thing: is there a way to concencate a list together with a "splitter" (i.e. ",") in Python? And I don't suppose that you can retrieve the name of the monster right?

from the python docs:
S.join(sequence) -> string

Return a string which is the concatenation of the strings in the
sequence.  The separator between elements is S.

in the data.wz theres a folder called "String" which contains all the names.  Specifically the "mob.img" file.  Dunno if lambda's extracts that, but ive got something like:

Filename: \String\mob.img
Block Name: 100100
  Type: 0x9
    Type: 0x1b
      Type: 0x0 Value: name
      Type: 0x8
        Value: Snail
Block Name: 100101
  Type: 0x9
    Type: 0x1b
      Type: 0x0 Value: name
      Type: 0x8
        Type: 0x0 Value: Blue Snail

the block name is the filename where the enemy is stored (ie. Snail is stored in \Mob\0100100.img)

@lambda
in your latest version the 0x08 type seems to have simplified a lot, and it seems the complications have been moved to the 0x00 for the unicode stuff (was that the problem with 0x08 earlier?).  Is that the only diff? or did this affect something somewhere else?
## Post #150
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-05T04:29:13+00:00
- Post Title: 

> Reply from Omega
>
> in the data.wz theres a folder called "String" which contains all the names.  Specifically the "mob.img" file.  Dunno if lambda's extracts that, but ive got something like:

the block name is the filename where the enemy is stored (ie. Snail is stored in \Mob\0100100.img)

@lambda
in your latest version the 0x08 type seems to have simplified a lot, and it seems the complications have been moved to the 0x00 for the unicode stuff (was that the problem with 0x08 earlier?).  Is that the only diff? or did this affect something somewhere else?

Omega, great job on finding the string table.

The 0x08 type did get simplified, but it's not because of the unicode issues.  One of the neat things with reverse engineering file formats, is that the more you figure out, generally the simplier everything becomes.

But 0x00 did become a lot more complicated...  I believe that 0x00 is interpreted differently depending on where you are in the file, which makes it difficult to handle.  For filenames, there's a special case where it basically says "I've had a previous string that begins with the following 7 letters, and is X characters long."  So I added code save all previous strings and then search through the list of previous strings to find a match.  When you aren't parsing filenames, it does the unicode string thing... at least in most cases.  I had to add one special case so that the image names wouldn't get messed up near the end of the file.  If the unicode stuff is figured out, that would probably be cleaned up.
## Post #151
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-05T05:06:13+00:00
- Post Title: 

Nevermind.

Hehe: 

> Reply from .String.Mob
>
> 
100100.name	Snail
100101.name	Blue Snail
120100.name	Shroom
130100.name	Stump
130101.name	Red Snail
210100.name	Slime
1110100.name	Green Mushroom
1110101.name	Dark Stump
1120100.name	Octopus
1130100.name	Axe Stump
1140100.name	Ghost Stump
1210100.name	Pig
1210101.name	Ribbon Pig
1210102.name	Orange Mushroom
1210103.name	Bubbling
2110200.name	Horny Mushroom
2130100.name	Dark Axe Stump
2130103.name	Jr. Necki
2220100.name	Blue Mushroom
2230100.name	Evil Eye
2230101.name	Zombie Mushroom
2230102.name	Wild Boar
2230103.name	Trixter
2230104.name	Green Trixter
2230105.name	Seacle
2230106.name	Cico
2230107.name	Krappy
2230108.name	Pinboom
2230109.name	Bubble Fish
2230110.name	Wooden Mask
2230111.name	Rocky Mask
2230200.name	Flower Fish
2300100.name	Stirge
3000000.name	Sentinel
3000001.name	Fairy 1
3000002.name	Fairy 2
3000003.name	Fairy 3
3000004.name	Fairy 4
3000005.name	Brown Teddy
3000006.name	Krip
3110100.name	Ligator
3110101.name	Pink Teddy
3110102.name	Ratz
3210100.name	Fire Boar
3210200.name	Jr. Cellion
3210201.name	Jr. Lioner
3210202.name	Jr. Grupin
3210203.name	Panda Teddy
3210204.name	Roloduck
3210205.name	Black Ratz
3210206.name	Helly
3210207.name	Tick
3210208.name	Retz
3210450.name	Scuba Pepe
3210800.name	Lupin
3230100.name	Curse Eye
3230101.name	Jr. Wraith
3230102.name	Lorang
3230103.name	King Bloctopus
3230104.name	Mask Fish
3230200.name	Star Pixie
3230300.name	Jr. Boogie 1
3230301.name	Jr. Boogie 2
3230302.name	Bloctopus
3230303.name	Propelly
3230304.name	Planey
3230305.name	Toy Trojan
3230306.name	Chronos
3230307.name	Chirppy
3230308.name	Tweeter
3230400.name	Drumming Bunny
3230405.name	Jr. Seal
4130100.name	Copper Drake
4130101.name	Tortie
4130102.name	Dark Nependeath
4130103.name	Rombot
4130104.name	Dark Nependeath
4230100.name	Cold Eye
4230101.name	Zombie Lupin
4230102.name	Wraith
4230103.name	Iron Hog
4230104.name	Clang
4230105.name	Nependeath
4230106.name	Lunar Pixie
4230107.name	Flyeye
4230108.name	Jr. Cerebes
4230109.name	Block Golem
4230110.name	King Block Golem
4230111.name	Robo
4230112.name	Master Robo
4230113.name	Tick-Tock
4230114.name	Platoon Chronos
4230115.name	Master Chronos
4230116.name	Barnard Gray
4230117.name	Zeta Gray
4230118.name	Ultra Gray
4230119.name	Mateon
4230120.name	Plateon
4230121.name	Mecateon
4230122.name	Nependeath
4230123.name	Sparker
4230124.name	Freezer
4230125.name	Skeledog
4230126.name	Mummydog
4230200.name	Poopa
4230201.name	Poison Poopa
4230300.name	\x7e\x6c\xb3\x11
4230400.name	Iron Boar
4240000.name	Chief Gray
5100000.name	Jr. Yeti
5100001.name	Transforming Jr. Yeti
5100002.name	Firebomb
5100003.name	Hodori
5100004.name	Samiho
5100005.name	Hogul
5120000.name	Luster Pixie
5120001.name	Cellion
5120002.name	Lioner
5120003.name	Grupin
5120100.name	MT-09
5130100.name	Drake
5130101.name	Stone Golem
5130102.name	Dark Stone Golem
5130103.name	Croco
5130104.name	Hector
5130105.name	Dark Jr. Yeti
5130106.name	Transforming Dark Jr. Yeti
5130107.name	Coolie Zombie
5130108.name	Minor Zombie
5140000.name	White Fang
5150000.name	Mix Gollem
5150001.name	Skeleton Soldier
5200000.name	Jr. Sentinel
5200001.name	Ice Sentinel
5200002.name	Fire Sentinel
5300000.name	Leatty
5300001.name	Dark Leatty
5300100.name	Malady
5400000.name	Jr. Pepe
6130100.name	Red Drake
6130101.name	Mushmom
6130102.name	Separated Pepe
6130103.name	Pepe
6130104.name	Boogie
6130200.name	Buffy
6130201.name	Blin
6130202.name	Morphed Blin
6230100.name	Wild Kargo
6230101.name	Puco
6230200.name	Dark Pepe
6230201.name	Separated Dark Pepe
6230300.name	Lazy Buffy
6230400.name	Soul Teddy
6230500.name	Master Soul Teddy
6230600.name	Ice Drake
6230601.name	Dark Drake
6230602.name	Officer Skeleton
6300000.name	Yeti
6300001.name	Transformed Yeti
6300002.name	Separated Yeti
6300003.name	Punco
6300004.name	Pachu
6300005.name	Zombie Mushmom
6300100.name	Buffoon
6400000.name	Dark Yeti
6400001.name	Transformed Dark Yeti
6400002.name	Separated Dark Yeti
6400003.name	Cuzco
6400004.name	Opachu
6400100.name	Deep Buffoon
7130000.name	Lucida
7130001.name	Cerebes
7130010.name	Death Teddy
7130020.name	Goby
7130100.name	Tauromacis
7130101.name	Taurospear
7130102.name	Yeti and Pepe
7130103.name	Commander Skeleton
7130200.name	Werewolf
7130300.name	Master Death Teddy
7130400.name	Yellow King Goblin
7130401.name	Blue King Goblin
7130402.name	Green King Goblin
7140000.name	Ghost Pirate
7160000.name	Dual Ghost Pirate
8130100.name	Jr. Balrog
8140000.name	Lycanthrope
8140100.name	Dark Yeti and Pepe
8140200.name	Klock
8140300.name	Dark Klock
8140500.name	Bain
8140555.name	Bombing Fish House
8140600.name	Bone Fish
8141000.name	Spirit Viking
8141100.name	Gigantic Spirit Viking
8141300.name	Squid
8142000.name	Phantom Watch
8142100.name	Risell Squid
8143000.name	Grim Phantom Watch
8150000.name	Crimson Balrog
8150100.name	Shark
8150101.name	Cold Shark
8160000.name	Gatekeeper
8170000.name	Thanatos
8500000.name	Time Sphere
8500001.name	Papulatus Clock
8500002.name	Papulatus
8500003.name	High Darkstar
8500004.name	Low Darkstar
8510000.name	Pianus
8510100.name	Bloody Boom
8520000.name	Pianus
8800000.name	Zakum1
8800001.name	Zakum2
8800002.name	Zakum3
8800003.name	Zakum's Arm 1
8800004.name	Zakum's Arm 2
8800005.name	Zakum's Arm 3
8800006.name	Zakum's Arm 4
8800007.name	Zakum's Arm 5
8800008.name	Zakum's Arm 6
8800009.name	Zakum's Arm 7
8800010.name	Zakum's Arm 8
9000001.name	Curse Eye 2
9000002.name	Horned Mushroom 2
9000100.name	Fire Boar 2
9000101.name	Lupin 2
9000200.name	Evil Eye 2
9000201.name	Zombie Mushroom 2
9000300.name	Cold Eye 2
9000301.name	Blue Mushroom 2
9001000.name	Dances with Balrog's Clone
9001001.name	Grendel the Really Old's Clone
9001002.name	Athena Pierce's Clone
9001003.name	Dark Lord's Clone
9100000.name	Super Slime
9100001.name	Super Jr. Necki
9100002.name	Super Stirge
9100003.name	Ultra Jr. Necki 1
9100004.name	Ultra Jr. Necki 2
9100005.name	Super Trickster
9100006.name	Super Green Trickster
9100007.name	Super Ribbon-Pig
9200000.name	Wild Boar (PC)
9200001.name	Fire Boar (PC)
9200002.name	Dark Stump (PC)
9200003.name	Horned Mushroom (PC)
9200004.name	Green Mushroom (PC)
9200005.name	Slime (PC)
9200006.name	Lupin (PC)
9200007.name	Zombie Lupin (PC)
9200008.name	Blue Mushroom (PC)
9200009.name	Stone Golem (PC)
9200010.name	Zombie Mushroom (PC)
9200011.name	Evil Eye (PC)
9200012.name	Drake (PC)
9200013.name	Cold Eye (PC)
9200014.name	Wild Kargo (PC)
9200015.name	Brown Tanny
9200016.name	Drumming Bunny
9200017.name	Pink Tanny
9200018.name	Jr. Yetti
9200019.name	White Fang
9200020.name	Yetti & Pepe
9200021.name	Separated Yetti
9200022.name	Separated Pepe
9300000.name	Jr. Necki (PC)
9300001.name	Ligator (PC)
9300002.name	Curse Eye (PC)
9300003.name	King Slime (PC)
9300004.name	Mimic
9300005.name	Ratz from Another Dimension
9300006.name	Black Ratz from Another Dimension
9300007.name	Bloctopus from Another Dimension
9300008.name	Shadow Eye from Another Dimension
9300009.name	Block Golem from Another Dimension
9300010.name	Rombad from Another Dimension
9300011.name	Toy Trojan
9300012.name	Alishar
9300013.name	King Block Golem from Another Dimension
9300014.name	Dark Eye from Another Dimension
9300015.name	Cronos
9300016.name	Platoon Cronos
9300017.name	Master Cronos
9300018.name	Tutorial Jr. Sentinel
9300019.name	Master Muscle Stone
9300020.name	Muscle Stone
9300021.name	Dark Muscle Stone
9300022.name	Black Knight
9300023.name	Myst Knight
9300024.name	Puppet Golem
9300025.name	Gargoyle
9300026.name	Jr. Gargoyle
9300027.name	Devil Slime
9300028.name	Ergoth
9300029.name	Lion Statue A
9300030.name	Lion Statue B
9300031.name	Knight Statue A
9300032.name	Knight Statue B
9300033.name	Jr. Gargoyle
9300034.name	Mist Knight
9300035.name	Jr. Gargoyle
9300036.name	Black Knight
9300037.name	Mist Knight
9400000.name	Crow
9400001.name	Fire Raccoon
9400002.name	Mushroom Fox
9400003.name	Cloud Fox
9400004.name	Cloud Fox
9400005.name	\xd6\x6d\x53\x16\x15\x10
9400006.name	\xd6\x6d\x53\x16\x15\x10
9400007.name	\xd6\x6d\x53\x16\x15\x10
9400008.name	\xd6\x6d\x53\x16\x15\x10
9400100.name	\xd6\x6d\x53\x16\x15\x10
9400101.name	\xd6\x6d\x53\x16\x15\x10
9400102.name	\xd6\x6d\x53\x16\x15\x10
9400103.name	Japanese Monster
9400112.name	Japanese Monster
9400113.name	Japanese Monster
9400114.name	Japanese Monster
9400121.name	Japanese Monster
9400200.name	Japanese Monster
9400201.name	Japanese Monster
9400300.name	Japanese Monster
9400110.name	\xd6\x6d\x53\x16\x15\x10
9400111.name	\xd6\x6d\x53\x16\x15\x10
9400120.name	\xd6\x6d\x53\x16\x15\x10
9400500.name	Malady
9400501.name	Jr. Wraith
9400502.name	Wraith
9400503.name	Stirge
9400504.name	Coolie Zombie
9400505.name	Turkey
9400506.name	Candle Monster
9400507.name	Cake Monster
9500000.name	Making a wish to full moon
9500001.name	Making a wish to the full moon
9500002.name	Making a wish to the full moon
9500003.name	Making a wish to the full moon
9500004.name	Making a wish to the full moon
9500005.name	Making a wish to the full moon
9500100.name	Slime
9500101.name	Pig
9500102.name	Orange Mushroom
9500103.name	Bubbling
9500104.name	Octopus
9500105.name	Green Mushroom
9500106.name	Horny Mushroom
9500107.name	Drumming Bunny
9500108.name	Ligator
9500109.name	Ratz
9500110.name	Star Pixie
9500111.name	Jr. Wraith
9500112.name	Jr. Pepe
9500113.name	Panda Teddy
9500114.name	King Blockpus
9500115.name	Lorang
9500116.name	Zombie Lupin
9500117.name	Helly
9500118.name	Tweeter
9500119.name	Toy Trojan
9500120.name	King Block Golem
9500121.name	Wraith
9500122.name	Chief Gray
9500123.name	Mixed Golem
9500124.name	Mushmom
9500125.name	Red Drake
9500126.name	Ice Drake
9500127.name	Master Soul Teddy
9500128.name	Dark Yeti
9500129.name	Taurospear
9500130.name	Blue King Goblin
9500131.name	Luinel
9500132.name	Werewolf
9500133.name	Yeti and Pepe
9500134.name	Lycanthrope
9500135.name	Death Teddy
9500136.name	Gigantic Viking
9500137.name	G. Phantom Watch
9500138.name	Bain
9500139.name	Jr. Balrog
9500140.name	Crimson Balrog
9500141.name	Separated Yeti
9500142.name	Separated Pepe
9500143.name	Coke Pig
9500144.name	Coke Snail
9500145.name	Coke Seal
9500146.name	Play Seal
9500147.name	Yeti and Coketump
9500148.name	Igloo Turtle
9500149.name	Coke Golem
9500150.name	Ice Golem
9500151.name	Coke Slime
9500152.name	Coke Mushroom
9500153.name	Coketump
9500154.name	Coketump Lite
9500200.name	Zoo Balrog
9500201.name	Zoo Yeti
9500202.name	Zoo White Fang
9500203.name	Zoo Pig
9500204.name	Zoo Ribbon Pig
9500400.name	Gourd
9999999.name	???

What's with this? \xd6\x6d\x53\x16\x15\x10
Looks familiar.
## Post #152
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-05T05:25:14+00:00
- Post Title: 

> Reply from themoviefund
>
> What's with this? \xd6\x6d\x53\x16\x15\x10
Looks familiar.

That's one of the unicode strings I wasn't able to figure out how to decode.  Where'd you see it at?

Edit: It's the Chinese(?) text "ì
## Post #153
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-05T05:54:45+00:00
- Post Title: 

ive completely split up the "file splitting" part from the file decoding .  just got too messy, annoying and time consuming trying to run through the whole file every time.

I don't think i had any problems splitting the file up.  All the filenames came out properly (ie. no unicode filenames).  The link nodes were just the 32 bit number + 61.  Right now im trying to figure out exactly how much of the structure is based on reading order (creates an annoyingly large amount of code >.<).  I haven't tried to get 0x73 working (0x09 lets me get around it ).  So far the only problem I'm having is reading unicode.  If I try decoding it, how do I check if its right?

Also, I've been looking through the stored strings, and ive found some very interesting things .  Ex. there's a list of all the reasons someone can get banned for (and the message they receive if they try to log in.  Also found a list of bad words .
## Post #154
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-05T06:17:13+00:00
- Post Title: 

> Reply from Omega
>
> So far the only problem I'm having is reading unicode.  If I try decoding it, how do I check if its right?

Cheat.  

Go to Rick's Maple Story site ([http://www.sauna.gibbed.us/start/](http://www.sauna.gibbed.us/start/)), in a lot of cases, you can type in the file name/number and get information.  To check that '\xd6\x6d\x53\x16\x15\x10' was correct (used for monster's 9400110, 9400111, etc..), I could go to [http://www.sauna.gibbed.us/monster/9400110/](http://www.sauna.gibbed.us/monster/9400110/) .
## Post #155
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-05T06:51:39+00:00
- Post Title: 

> Reply from Lambda
>
> Omega wrote:So far the only problem I'm having is reading unicode.  If I try decoding it, how do I check if its right?

Cheat.  

Go to Rick's Maple Story site (http://www.sauna.gibbed.us/start/), in a lot of cases, you can type in the file name/number and get information.  To check that '\xd6\x6d\x53\x16\x15\x10' was correct (used for monster's 9400110, 9400111, etc..), I could go to http://www.sauna.gibbed.us/monster/9400110/ .

Cheater. I need some help. When I use file.readline, it returns an error. But when I use file.readline[0], it doesn't, but I only get the first letter.

Nevermind. I should use rstrip(). And it only took me 2 hours to figure it out! =)
## Post #156
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-05T07:01:15+00:00
- Post Title: 

Ehhh... is it just me, or can people come read this entire thing, reverse engineer it, and make their own hacked Data.wz? 0.o

EDIT: [http://themfund.com/maplestory/monsters ... php#middle](http://themfund.com/maplestory/monsters/maps/random.php#middle)

o0o00o0o0o00o0o
## Post #157
- Username: terasonic
- Rank: ultra-n00b
- Number of posts: 8
- Joined date: Wed Aug 09, 2006 5:45 pm
- Post datetime: 2006-09-05T11:52:54+00:00
- Post Title: 

> Reply from Lambda
>
> themoviefund wrote:What's with this? \xd6\x6d\x53\x16\x15\x10
Looks familiar.

That's one of the unicode strings I wasn't able to figure out how to decode.  Where'd you see it at?

Edit: It's the Chinese(?) text "ì
## Post #158
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-05T15:35:12+00:00
- Post Title: 

> Reply from themoviefund
>
> Ehhh... is it just me, or can people come read this entire thing, reverse engineer it, and make their own hacked Data.wz? 0.o

EDIT: http://themfund.com/maplestory/monsters ... php#middle

o0o00o0o0o00o0o
interesting website 

theres still a fair bit we don't know about the data.wz, namely the two entries in the header of the file table, one of which is probably a checksum of some sort.  Start changing the file, and the checksum won't match up and the game will exit.  Of course, thats just a guess 

from what ive been able to read from the file, it doesn't seem like there is very much "useful" stuff in there.  You can't change exp, skills, damage, etc.  The only thing you could potentially change is the sounds (a growling snail?) or the pictures (throwing balrog heads?).  But those will only be useful to the user and it will look normal to everyone else.

At least, thats what I hope .  I play the game and giving hackers new ammunition would be annoying >.>
## Post #159
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-06T03:02:46+00:00
- Post Title: 

Never mind this post...
## Post #160
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-10T03:32:33+00:00
- Post Title: 

Hi, I wonder what Data.wz/Quest/QuestInfo.img/****.area is for.
## Post #161
- Username: Elem
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Sun Sep 10, 2006 3:30 pm
- Post datetime: 2006-09-10T07:37:44+00:00
- Post Title: 

I have try GMS and TMS.....
But it cannot extract Tile,NPC,Mob,Quest,Reactor,Skill,UI.....  
How to solve the problem?
## Post #162
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-10T16:32:36+00:00
- Post Title: 

Lol! Data.wz/Etc/ForbiddenName.img/ mentions name of other games!
## Post #163
- Username: lionheartuk
- Rank: double-veteran
- Number of posts: 749
- Joined date: Wed May 17, 2006 5:55 am
- Post datetime: 2006-09-10T16:56:35+00:00
- Post Title: 

[quote]Edit: It's the Chinese(?) text "ì
## Post #164
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-10T22:05:08+00:00
- Post Title: 

> Reply from lionheartuk
>
> SHe loves it but I have never even seen it, think  might look into it now, asthis topic has becomes rather Popular

This topic looks like it's racing with the "Metal Gear Solid 2 - any luck?" topic. =)
## Post #165
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-11T00:27:22+00:00
- Post Title: 

im still trying to figure out how exactly the 0x1b blocks work >.<

the way Lambda does it is check if its one, if its not go back and check another.  There doesn't seem to be any discernable logic :/
## Post #166
- Username: lionheartuk
- Rank: double-veteran
- Number of posts: 749
- Joined date: Wed May 17, 2006 5:55 am
- Post datetime: 2006-09-11T10:29:42+00:00
- Post Title: Re: huh?

> Reply from themoviefund
>
> lionheartuk wrote:SHe loves it but I have never even seen it, think  might look into it now, asthis topic has becomes rather Popular

This topic looks like it's racing with the "Metal Gear Solid 2 - any luck?" topic. =)
lol.
Yes it seems to be.
There have bene well over 120 posts here.
Im not sure how many there are in the MGS topic.
Its slow NOW but itl speed up once the NEWEST version of Solidus is released, Apparenty its near completion.
## Post #167
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-09-11T10:47:53+00:00
- Post Title: Re: huh?

> Reply from Omega
>
> im still trying to figure out how exactly the 0x1b blocks work >.<

the way Lambda does it is check if its one, if its not go back and check another.  There doesn't seem to be any discernable logic :/

You should have tried figuring it out originally 

I believe you can tell what the 1b block is by checking the size ahead of time.  If it's 1, 2, 5, or 10, it's an X, Y value pair; otherwise, it's something else.  That's basically what my code does, it makes a guess "Hmm... is it an X, Y pair?  (Yes/No)  OK... I'll interpret it this other way instead."  The file format was inconsistant.  Sometimes it would have both the X, and Y values, sometimes just the X value.  That's what all of the EndOfBlock checks are for.

You might be able to tell by looking at the name of the variable like I do in extract73type.  I didn't do enough analysis.

Edit: Doing an analysis based on the directory you are in could also turn up well...  you aren't going to have images in the BGM (background music) directory.  And you won't likely have images in the files full of strings.
## Post #168
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-13T03:07:58+00:00
- Post Title: Re: huh?

I don't know if this will help, but [ftp://patch.mapleglobal.com/Maple/patch/patchdir](ftp://patch.mapleglobal.com/Maple/patch/patchdir) has the patch files. Apparently, [http://www.sleepywood.net/forum/showthr ... ?t=1054453](http://www.sleepywood.net/forum/showthread.php?t=1054453) Rick was able to extract the client BEFORE the patch. I wonder if he just used the program on the .patch file.
## Post #169
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-14T04:39:00+00:00
- Post Title: Re: huh?

MapleTip >>> [http://www.mapletip.com/index.php](http://www.mapletip.com/index.php)
Extracted.
Sauna >>> [http://sauna.gibbed.us/](http://sauna.gibbed.us/)
Extracted.

Aww!!! Beat me to it!
## Post #170
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-14T13:40:02+00:00
- Post Title: Re: huh?

from 0028 to 0029
My "file version" went from 0x60 to 0x63
Changed Files:
"Character\Shoes\01072013.img"
"Character\Shoes\01072057.img"
"Character\Shoes\01072058.img"
"Character\Shoes\01072190.img"
"Character\Shoes\01072191.img"
"Character\Weapon\01702067.img"
"Character\Weapon\01702068.img"
"Character\Weapon\01702069.img"
"Etc\CashPackage.img"
"Etc\Commodity.img"
"Etc\ScriptInfo.img"
"Item\Cash\0522.img"
"Item\Pet\5000011.img"
"Item\Special\0910.img"
"Map\Map\Map1\100000100.img"
"Map\Map\Map1\101000000.img"
"Map\Map\Map1\102000000.img"
"Map\Map\Map1\103000000.img"
"Map\Map\Map1\103010000.img"
"Map\Map\Map1\104000000.img"
"Map\Map\Map1\105040300.img"
"Map\Map\Map2\211000100.img"
"Map\Map\Map2\220000000.img"
"Npc\9200000.img"
"Quest\Check.img"
"Quest\QuestInfo.img"
"Quest\Say.img"
"String\Item.img"
"String\Map.img"
"String\Npc.img"
"String\Pet.img"
"String\Skill.img"
"String\ToolTipHelp.img"
"UI\ChatBalloon.img"
"UI\Login.img"
"UI\UIWindow.img"

New Files:
"Character\Cap\01002553.img"
"Etc\ScanBlock.img"
"Item\Cash\0523.img"
"Map\Map\Map2\220000500.img"
"Map\Map\Map2\222020000.img"
"Map\Map\Map2\222020100.img"
"Map\Map\Map2\222020110.img"
"Map\Map\Map2\222020111.img"
"Map\Map\Map2\222020200.img"
"Map\Map\Map2\222020210.img"
"Map\Map\Map2\222020211.img"
"Map\Map\Map2\222020300.img"
"Npc\9100109.img"
"Npc\9100110.img"

Next I'm gonna check what changed in the header.  If only the changed files changed, then its probably a crc.  If only moved files changed, then its probably the location.
## Post #171
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-14T14:39:58+00:00
- Post Title: Re: huh?

In the file table:
first of the two unknowns is some kind of file size, probably the extracted size, or maybe the amount of memory required.  i added up all of the entries for all the files in a directory, and it added up to the value in the directory's entry.

second value changed for every file, meaning its either a checksum that depends on file location, or its the location in the file, or its the location of the file encoded somehow. Last one being my guess.

EDIT: That unknown number at the beginning of the file table could be a decryption key or something.
## Post #172
- Username: nicoli_s
- Rank: advanced
- Number of posts: 77
- Joined date: Fri Jan 07, 2005 2:47 pm
- Post datetime: 2006-09-14T15:32:40+00:00
- Post Title: Re: huh?

MMODB [http://ms.mmodb.com](http://ms.mmodb.com)
Extracted  sorry for the plug, but couldn't resist 
btw, is the problem with unicode strings that python doesn't have a way to handle them, or that we don't know how to decode them?
## Post #173
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-14T16:19:50+00:00
- Post Title: Re: huh?

> Reply from nicoli_s
>
> MMODB http://ms.mmodb.com
Extracted  sorry for the plug, but couldn't resist 
btw, is the problem with unicode strings that python doesn't have a way to handle them, or that we don't know how to decode them?
Guess i should put my plug as well 
[http://strategywiki.org/wiki/MapleStory](http://strategywiki.org/wiki/MapleStory)
I'm going to be putting up whatever info I can there.  Also going to try and extract data from the other versions and post the data.

About unicode, the strings are extracted properly, the difficulty is displaying them.  Any web browser should be able to display it properly, its just a matter of figuring out how to indicate you're displaying unicode not regular text.

EDIT: Try this
replace the line in transStr16:    
s += struct.pack("h",  xor16(a,p))
with this:
s += "&#" + str(xor16(a,p))
## Post #174
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-14T17:36:49+00:00
- Post Title: Re: huh?

[quote="lionheartuk"][quote]Edit: It's the Chinese(?) text "ì
## Post #175
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-15T17:31:09+00:00
- Post Title: Re: huh?

> Reply from nicoli_s
>
> MMODB http://ms.mmodb.com
Extracted  sorry for the plug, but couldn't resist 
btw, is the problem with unicode strings that python doesn't have a way to handle them, or that we don't know how to decode them?
I should probably mention that I'm [http://strategywiki.org/wiki/User:Prod](http://strategywiki.org/wiki/User:Prod)
## Post #176
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-17T20:06:38+00:00
- Post Title: Re: huh?

I want to try to figure out how to patch MapleStory manually, so I could extract it before the patch actually is released. 

This file is to patch from 00028 to 00029. Hopefully some people haven't patched their Maplestory yet. =(


[ftp://patch.mapleglobal.com/Maple/patch ... 0029.patch](ftp://patch.mapleglobal.com/Maple/patch/patchdir/00029/00028to00029.patch)
[ftp://patch.mapleglobal.com/Maple/patch ... atcher.dat](ftp://patch.mapleglobal.com/Maple/patch/patchdir/00028/NewPatcher.dat)
[ftp://patch.mapleglobal.com/Maple/patch ... rsion.info](ftp://patch.mapleglobal.com/Maple/patch/patchdir/00028/Version.info)
## Post #177
- Username: huosoft
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Fri Sep 15, 2006 2:39 am
- Post datetime: 2006-09-25T06:49:50+00:00
- Post Title: Re: huh?

```
var
  a, i, p: WORD;
  r: widestring;
begin
  setlength(r,length(str) div 2);
  p := $AAAA;
  for i := 1 to length(str) div 2 do
  begin
//    a := ord(str[2 * i-1])+ ord(str[2 * i ]) shl 8 ;
    a := PWord(@str[2*i-1])^;
    r[i] := widechar(a xor p);
    inc(p);
  end;
  result := r;
end;
```

the Delphi unicode decode function work well! I had decode chinese maplestory suceessful,and I'm Chinese
[http://www.huosoft.com/blogview.asp?logID=69](http://www.huosoft.com/blogview.asp?logID=69)
 [quote]
100101.name    è“
## Post #178
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-26T08:51:38+00:00
- Post Title: Re: huh?

Is this illegal?



> Reply from NXGAMES_TERMS_OF_USE
>
> 
2.2 Code of Conduct. While using the Service, including without limitation, while participating in a Forum (as defined and discussed below) or while using any data, text, graphics, images, audio and/or video clips, logos, icons, links and other information, content and materials provided through or included in the Service or the Game (collectively, the "Materials") and/or the Software, you agree not to: 
...
...
...
â€¢ Use any robot, spider, site search/retrieval application or other manual or automatic device or process to retrieve, index, "data mine" or in any way reproduce or circumvent the navigational structure or presentation of the Service or its contents, including, but not limited to, Cash Items;
## Post #179
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-26T15:18:37+00:00
- Post Title: Re: huh?

> Reply from themoviefund
>
> Is this illegal?


NXGAMES_TERMS_OF_USE wrote:
2.2 Code of Conduct. While using the Service, including without limitation, while participating in a Forum (as defined and discussed below) or while using any data, text, graphics, images, audio and/or video clips, logos, icons, links and other information, content and materials provided through or included in the Service or the Game (collectively, the "Materials") and/or the Software, you agree not to: 
...
...
...
â€¢ Use any robot, spider, site search/retrieval application or other manual or automatic device or process to retrieve, index, "data mine" or in any way reproduce or circumvent the navigational structure or presentation of the Service or its contents, including, but not limited to, Cash Items;
I don't think its illegal for lambda, cause he doesn't play 
Are these the TOS on the website? or in the game?
Cause I don't ever remember accepting a TOS on the website
## Post #180
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-09-27T03:37:23+00:00
- Post Title: Re: huh?

Usually it is not illegal unless used for one's own profit... DARN GRAPHIC PIRATES!
## Post #181
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-09-27T06:07:34+00:00
- Post Title: 

> Reply from Omega
>
> themoviefund wrote:Is this illegal?


NXGAMES_TERMS_OF_USE wrote:
2.2 Code of Conduct. While using the Service, including without limitation, while participating in a Forum (as defined and discussed below) or while using any data, text, graphics, images, audio and/or video clips, logos, icons, links and other information, content and materials provided through or included in the Service or the Game (collectively, the "Materials") and/or the Software, you agree not to: 
...
...
...
â€¢ Use any robot, spider, site search/retrieval application or other manual or automatic device or process to retrieve, index, "data mine" or in any way reproduce or circumvent the navigational structure or presentation of the Service or its contents, including, but not limited to, Cash Items; 
I don't think its illegal for lambda, cause he doesn't play 
Are these the TOS on the website? or in the game?
Cause I don't ever remember accepting a TOS on the website

I got the TOS on the site, but I think it's the same one you accept in game.
## Post #182
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-09-27T16:46:28+00:00
- Post Title: 

> Reply from themoviefund
>
> Omega wrote:themoviefund wrote:Is this illegal?



I don't think its illegal for lambda, cause he doesn't play 
Are these the TOS on the website? or in the game?
Cause I don't ever remember accepting a TOS on the website

I got the TOS on the site, but I think it's the same one you accept in game.
Well, as I know where the EULA is in the data file, whats to say that I didnt change it to something like
"By using this game you promise not to do drugs at the same time"
and accepted that.
## Post #183
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2006-09-27T19:06:47+00:00
- Post Title: 

> Reply from Omega
>
> themoviefund wrote:Omega wrote:
I don't think its illegal for lambda, cause he doesn't play 
Are these the TOS on the website? or in the game?
Cause I don't ever remember accepting a TOS on the website

I got the TOS on the site, but I think it's the same one you accept in game.
Well, as I know where the EULA is in the data file, whats to say that I didnt change it to something like
"By using this game you promise not to do drugs at the same time"
and accepted that.

O_o XD I don't think it works that way XD
## Post #184
- Username: AnyThing
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Sun Oct 01, 2006 2:59 am
- Post datetime: 2006-09-30T19:01:35+00:00
- Post Title: 

I was able to extract from the .wz files; however, there were some strings I could not decode.

Eqp.Accessory.1010000.name \xa2\x06\x62\x6a\x8c\xaa\x9c\x7b\xb6\x68\x53\x6f 
Eqp.Accessory.1010001.name \x73\x19\x53\x07\x2c\x1d\x8d\xaa\xb6\x68\x53\x6f 
Eqp.Accessory.1010002.name \x02\x1a\x3b\x6d\x60\x18\x3d\x6d\x8e\xaa\x67\x13\x14\x68\xdd\x7a 
Eqp.Accessory.1010003.name \xde\x10\x6f\x19\x3c\x6d\xc0\x07 
Eqp.Accessory.1010004.name \xde\x7f\x4b\x68\x8c\xaa\x08\x6d\x5a\x16\x4f\x06\x90\xaa\xa9\x68\x4e\x6f 
Eqp.Accessory.1010005.name \xde\x7f\x4b\x68\x8c\xaa\x51\x6f\x0b\x6d\x8f\xaa\xa8\x68\x4d\x6f 
Eqp.Accessory.1010006.name \xd6\x6f\x4b\x65\x3c\x6d\x8d\xaa\xe7\x7d\x9f\x7b 
Eqp.Accessory.1011000.name \x46\x6f\x3b\x6d\x60\x18\x3d\x6d\x8e\xaa\x67\x13\x14\x68\xdd\x7a 
Eqp.Accessory.1011001.name \xf9\xaa\xed\xaa\x60\x18\x3d\x6d\x8e\xaa\x67\x13\x14\x68\xdd\x7a 
Eqp.Accessory.1011002.name \xf2\x7f\x13\x78\x64\x13\xc1\x7a 
Eqp.Accessory.1011003.name \x56\x62\x57\x07\xc4\x04 
Eqp.Accessory.1012000.name \xbe\x16\x27\x1d\xf4\x6d\x8d\xaa\xe7\x7d\x9f\x7b 
Eqp.Accessory.1012001.name \xe2\x14\xbf\x1f 
Eqp.Accessory.1012002.name \xaa\x06\x56\x62\x8c\xaa\x65\x13\x0a\x68\xc3\x7a 
Eqp.Accessory.1012003.name \x5a\x6f\x6b\x63\x48\x06\x6d\x63 
Eqp.Accessory.1012004.name \xe2\x6f\xdf\x10\xa8\x6d\x08\x6d 
Eqp.Accessory.1012005.name \xe7\x10 
Eqp.Accessory.1012006.name \x0f\x6d\x53\x11\x8c\xaa\xf1\x7f\x8e\xaa\x0e\x6b\xc4\x6d 
Eqp.Accessory.1012007.name \x1a\x6a\x6b\x7a\x8c\xaa\xb5\x68\x52\x6f 
Eqp.Accessory.1012008.name \x02\x10\x3b\x6d\xd8\x6d\xc1\x7a 
Eqp.Accessory.1012009.name \x0e\x7a\x0f\x68\x8c\xaa\x65\x13\xc2\x7a 
Eqp.Accessory.1012010.name \x22\x7d\xd3\x1b\x64\x13\x45\x12 
Eqp.Accessory.1012011.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 
Eqp.Accessory.1012012.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 
Eqp.Accessory.1012013.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 
Eqp.Accessory.1012014.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 
Eqp.Accessory.1012015.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 
Eqp.Accessory.1012016.name \x42\x12\x67\x19\xa8\x7f\xf5\x6d\x8e\xaa\xc7\x14\xb4\x06\xe5\x65 






Does anyone know how to decode this stuff?
## Post #185
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-09-30T19:05:25+00:00
- Post Title: 

This is supposed to be in Korean, but it's in these wierd hexadecimal forms.









Cash.5151007.name \x42\x12\xbf\x1f\xa0\x14\x01\x13\x6a\x6f\x8f\xaa\x4c\x6f\x78\x6a\x92\xaa\x53\x06\xbd\x04\x55\x65\x46\x79 
Cash.5151007.desc \x89\xaa\xc8\xaa\x44\x12\xb9\x1f\xa2\x14\x03\x13\x74\x6f\x91\xaa\x4a\x11\x1a\x6c\x50\x68\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x19\x6c\x92\x7f\x5f\x18\xec\xaa\xf5\x10\x62\x13\x06\x6a\xf3\xaa\xed\x6d\x8e\x12\xf3\xaa\xc0\x16\x15\x05\xf6\xaa\xcf\x68\xf8\xaa\x51\x6d\x3e\x18 
Cash.5151014.name \xd6\x6f\x77\x68\x09\x6d\x8d\xaa\x52\x6f\x66\x6a\x90\xaa\xcd\x6d\xaa\x16\x53\x65\x44\x79 
Cash.5151014.desc \x89\xaa\xc8\xaa\xd0\x6f\x71\x68\x0b\x6d\x8f\xaa\x48\x11\x18\x6c\x56\x68\x90\xaa\x64\x6f\xa9\x6b\x96\xaa\x1b\x6a\x11\x6c\xe1\x7f\xce\x10\x97\xaa\x9c\xaa\x8c\xaa\x32\x7c\x6f\x6f\xe0\xaa\x9d\x7f\x9a\x7f\x2f\x6f\xe4\xaa\xe6\xaa\xa5\xaa\x43\x6d\x90\x6d\xea\xaa\x92\x6d\xeb\xaa\xf4\x10\x61\x13\x07\x6a\xf3\x6d\x8c\x12\xf1\xaa\xc6\x16\xc3\x1a\x30\x18 
Cash.5151015.name \xd6\x6f\x77\x68\x09\x6d\x8d\xaa\x52\x6f\x66\x6a\x90\xaa\x51\x06\xbb\x04\x53\x65\x44\x79 
Cash.5151015.desc \x89\xaa\xc8\xaa\xd0\x6f\x71\x68\x0b\x6d\x8f\xaa\x48\x11\x18\x6c\x56\x68\x90\xaa\x64\x6f\xa9\x6b\x96\xaa\x1b\x6a\x11\x6c\xe1\x7f\xce\x10\x97\xaa\x9c\xaa\x8c\xaa\x32\x7c\x6f\x6f\xe0\xaa\x9d\x7f\x9a\x7f\x2f\x6f\xe4\xaa\xe6\xaa\xa5\xaa\x17\x6c\x90\x7f\x5d\x18\xea\xaa\xf3\x10\x60\x13\x04\x6a\xed\xaa\xf3\x6d\x8c\x12\xf1\xaa\xc6\x16\x13\x05\xf4\xaa\xcd\x68\xf6\xaa\x5f\x6d\x3c\x18 
Cash.5152000.name \x4e\x7f\x8f\x1b\x70\x68\x09\x68\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\xc8\x6d\xad\x16\x56\x65\x47\x79 
Cash.5152000.desc \x89\xaa\xc8\xaa\x48\x7f\x89\x1b\x72\x68\x0b\x68\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x4d\x6d\x92\x6d\xe8\xaa\x94\x6d\xed\xaa\x72\x6f\xbb\x07\x8c\x12\xf1\xaa\x12\x16\x8f\x7f\x30\x18 
Cash.5152001.name \x4e\x7f\x8f\x1b\x70\x68\x09\x68\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\x54\x06\xbc\x04\x56\x65\x47\x79 
Cash.5152001.desc \x89\xaa\xc8\xaa\x48\x7f\x89\x1b\x72\x68\x0b\x68\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x19\x6c\x92\x7f\x5f\x18\xec\xaa\x71\x6f\xba\x07\xec\xaa\x8c\x12\xf1\xaa\xc6\x16\x13\x05\xf4\xaa\xcd\x68\xf6\xaa\x5f\x6d\x3c\x18 
Cash.5152002.name \x4e\x64\x76\x18\x70\x68\x5d\x78\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\xc8\x6d\xad\x16\x56\x65\x47\x79 
Cash.5152002.desc \x89\xaa\xc8\xaa\x48\x64\x70\x18\x72\x68\x5f\x78\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x4d\x6d\x92\x6d\xe8\xaa\x94\x6d\xed\xaa\x72\x6f\xbb\x07\x8c\x12\xf1\xaa\x12\x16\x8f\x7f\x30\x18 
Cash.5152003.name \x4e\x64\x76\x18\x70\x68\x5d\x78\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\x54\x06\xbc\x04\x56\x65\x47\x79 
Cash.5152003.desc \x89\xaa\xc8\xaa\x48\x64\x70\x18\x72\x68\x5f\x78\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x19\x6c\x92\x7f\x5f\x18\xec\xaa\x71\x6f\xba\x07\xec\xaa\x8c\x12\xf1\xaa\xc6\x16\x13\x05\xf4\xaa\xcd\x68\xf6\xaa\x5f\x6d\x3c\x18 
Cash.5152004.name \x8e\x6c\xdf\x13\xe8\x14\x09\x68\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\xc8\x6d\xad\x16\x56\x65\x47\x79 
Cash.5152004.desc \x89\xaa\xc8\xaa\x88\x6c\xd9\x13\xea\x14\x0b\x68\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x4d\x6d\x92\x6d\x93\x6d\xec\xaa\x71\x6f\xba\x07\xec\xaa\x8c\x12\xf1\xaa\x12\x16\x8f\x7f\x30\x18 
Cash.5152005.name \x8e\x6c\xdf\x13\xe8\x14\x09\x68\x8e\xaa\x9e\x6b\xa5\x7c\xc9\x6c\x4e\x06\x93\xaa\x54\x06\xbc\x04\x56\x65\x47\x79 
Cash.5152005.desc \x89\xaa\xc8\xaa\x88\x6c\xd9\x13\xea\x14\x0b\x68\x90\xaa\x80\x6b\xa7\x7c\xcb\x6c\x48\x06\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x19\x6c\x92\x7f\x5f\x18\xec\xaa\x71\x6f\xba\x07\xec\xaa\x8c\x12\xf1\xaa\xc6\x16\x13\x05\xf4\xaa\xcd\x68\xf6\xaa\x5f\x6d\x3c\x18 
Cash.5152006.name \x42\x12\xbf\x1f\xa0\x14\x01\x13\x6a\x6f\x8f\xaa\x81\x6b\xa4\x7c\xca\x6c\x4f\x06\x94\xaa\xc9\x6d\xae\x16\x57\x65\x48\x79 
Cash.5152006.desc \x89\xaa\xc8\xaa\x44\x12\xb9\x1f\xa2\x14\x03\x13\x74\x6f\x91\xaa\x83\x6b\xa6\x7c\xcc\x6c\x49\x06\x95\xaa\x67\x6f\xa4\x6b\x99\xaa\x16\x6a\x12\x6c\xe4\x7f\xc9\x10\x92\xaa\x9f\xaa\xf1\xaa\x4d\x7c\x12\x6f\xe3\xaa\x98\x7f\x9d\x7f\x2a\x6f\xe7\xaa\xeb\xaa\xaa\xaa\x4e\x6d\x93\x6d\x94\x6d\xed\xaa\x72\x6f\xbb\x07\xf3\xaa\x8d\x12\xf2\xaa\x13\x16\x88\x7f\x31\x18 
Cash.5152007.name \x42\x12\xbf\x1f\xa0\x14\x01\x13\x6a\x6f\x8f\xaa\x81\x6b\xa4\x7c\xca\x6c\x4f\x06\x94\xaa\x55\x06\xbf\x04\x57\x65\x48\x79 
Cash.5152007.desc \x89\xaa\xc8\xaa\x44\x12\xb9\x1f\xa2\x14\x03\x13\x74\x6f\x91\xaa\x83\x6b\xa6\x7c\xcc\x6c\x49\x06\x95\xaa\x67\x6f\xa4\x6b\x99\xaa\x16\x6a\x12\x6c\xe4\x7f\xc9\x10\x92\xaa\x9f\xaa\xf1\xaa\x4d\x7c\x12\x6f\xe3\xaa\x98\x7f\x9d\x7f\x2a\x6f\xe7\xaa\xeb\xaa\xaa\xaa\x1a\x6c\x93\x7f\x58\x18\xed\xaa\x72\x6f\xbb\x07\xf3\xaa\x8d\x12\xf2\xaa\xc7\x16\x14\x05\xf5\xaa\xce\x68\xf7\xaa\x50\x6d\x3d\x18 
Cash.5152023.name \xd6\x6f\x77\x68\x09\x6d\x8d\xaa\x9f\x6b\xba\x7c\xc8\x6c\x4d\x06\x92\xaa\xcf\x6d\xac\x16\x55\x65\x46\x79 
Cash.5152023.desc \x89\xaa\xc8\xaa\xd0\x6f\x71\x68\x0b\x6d\x8f\xaa\x81\x6b\xa4\x7c\xca\x6c\x4f\x06\x97\xaa\x65\x6f\xaa\x6b\x97\xaa\x14\x6a\x10\x6c\xe2\x7f\xcf\x10\x90\xaa\x9d\xaa\x8f\xaa\x33\x7c\x10\x6f\xe1\xaa\x9e\x7f\x9b\x7f\x28\x6f\xe5\xaa\xe5\xaa\xa4\xaa\x4c\x6d\x91\x6d\x92\x6d\xeb\xaa\x70\x6f\xb9\x07\xed\xaa\x93\x12\xf0\xaa\x11\x16\x8e\x7f\x37\x18 
Cash.5152024.name \xd6\x6f\x77\x68\x09\x6d\x8d\xaa\x9f\x6b\xba\x7c\xc8\x6c\x4d\x06\x92\xaa\x53\x06\xbd\x04\x55\x65\x46\x79 
Cash.5152024.desc \x89\xaa\xc8\xaa\xd0\x6f\x71\x68\x0b\x6d\x8f\xaa\x81\x6b\xa4\x7c\xca\x6c\x4f\x06\x97\xaa\x65\x6f\xaa\x6b\x97\xaa\x14\x6a\x10\x6c\xe2\x7f\xcf\x10\x90\xaa\x9d\xaa\x8f\xaa\x33\x7c\x10\x6f\xe1\xaa\x9e\x7f\x9b\x7f\x28\x6f\xe5\xaa\xe5\xaa\xa4\xaa\x18\x6c\x91\x7f\x5e\x18\xeb\xaa\x70\x6f\xb9\x07\xed\xaa\x93\x12\xf0\xaa\xc5\x16\x12\x05\xf3\xaa\xcc\x68\xf5\xaa\x5e\x6d\x33\x18 
Cash.5153000.name \x4e\x7f\x8f\x1b\x70\x68\x09\x68\x8e\xaa\x93\x7f\x30\x17\xb1\x07\x1e\x13\x93\xaa\x54\x65\x45\x79 
Cash.5153000.desc \x89\xaa\xc8\xaa\x48\x7f\x89\x1b\x72\x68\x0b\x68\x90\xaa\x8d\x7f\x32\x17\xb3\x07\x18\x13\x51\x68\x95\xaa\x67\x6f\xa4\x6b\x99\xaa\x16\x6a\x12\x6c\xe4\x7f\xc9\x10\x92\xaa\x9f\xaa\xf1\xaa\x4d\x7c\x12\x6f\xe3\xaa\x98\x7f\x9d\x7f\x2a\x6f\xe7\xaa\xeb\xaa\xaa\xaa\x1a\x6c\x93\x7f\x58\x18\xed\xaa\xf2\x7f\x4f\x17\x19\x6a\xf2\xaa\xee\x6d\x8f\x12\xf4\xaa\xc1\x16\x16\x05\xf7\xaa\xc0\x68\xf9\xaa\x52\x6d\x3f\x18 
Cash.5153001.name \x8e\x6c\xdf\x13\xe8\x14\x09\x68\x8e\xaa\x93\x7f\x30\x17\xb1\x07\x1e\x13\x93\xaa\x54\x65\x45\x79 
Cash.5153001.desc \x89\xaa\xc8\xaa\x88\x6c\xd9\x13\xea\x14\x0b\x68\x90\xaa\x8d\x7f\x32\x17\xb3\x07\x18\x13\x51\x68\x95\xaa\x67\x6f\xa4\x6b\x99\xaa\x16\x6a\x12\x6c\xe4\x7f\xc9\x10\x92\xaa\x9f\xaa\xf1\xaa\x4d\x7c\x12\x6f\xe3\xaa\x98\x7f\x9d\x7f\x2a\x6f\xe7\xaa\xeb\xaa\xaa\xaa\x1a\x6c\x93\x7f\x58\x18\xed\xaa\xf2\x7f\x4f\x17\x19\x6a\xf2\xaa\xee\x6d\x8f\x12\xf4\xaa\xc1\x16\x16\x05\xf7\xaa\xc0\x68\xf9\xaa\x52\x6d\x3f\x18 
Cash.5153002.name \x42\x12\xbf\x1f\xa0\x14\x01\x13\x6a\x6f\x8f\xaa\x14\x68\x19\x7a\xb2\x65\x07\x6f\x94\xaa\x55\x65\x46\x79 
Cash.5153002.desc \x89\xaa\xc8\xaa\x44\x12\xb9\x1f\xa2\x14\x03\x13\x74\x6f\x91\xaa\x16\x68\x1b\x7a\xb4\x65\x01\x6f\x43\x6a\x94\xaa\x68\x6f\xa5\x6b\x9a\xaa\x17\x6a\x15\x6c\xe5\x7f\xca\x10\x93\xaa\xe0\xaa\xf0\xaa\x4e\x7c\x13\x6f\xe4\xaa\x99\x7f\x9e\x7f\x2b\x6f\xe8\xaa\xea\xaa\xa9\xaa\x1b\x6c\x94\x7f\x59\x18\xee\xaa\xf3\x7f\x50\x17\x18\x6a\xf1\xaa\xef\x6d\x88\x12\xf5\xaa\xc2\x16\x17\x05\xf8\xaa\xc1\x68\xfa\xaa\x53\x6d\x38\x18 
Cash.5153005.name \xd6\x6f\x77\x68\x09\x6d\x8d\xaa\x0a\x68\x07\x7a\xb0\x65\x05\x6f\x92\xaa\x53\x65\x44\x79 
Cash.5153005.desc \x89\xaa\xc8\xaa\xd0\x6f\x71\x68\x0b\x6d\x8f\xaa\x14\x68\x19\x7a\xb2\x65\x07\x6f\x41\x6a\x96\xaa\x66\x6f\xab\x6b\x98\xaa\x15\x6a\x13\x6c\xe3\x7f\xc8\x10\x91\xaa\x9e\xaa\x8e\xaa\x4c\x7c\x11\x6f\xe2\xaa\x9f\x7f\x9c\x7f\x29\x6f\xe6\xaa\xe4\xaa\xab\xaa\x19\x6c\x92\x7f\x5f\x18\xec\xaa\xf1\x7f\x4e\x17\x06\x6a\xf3\xaa\xed\x6d\x8e\x12\xf3\xaa\xc0\x16\x15\x05\xf6\xaa\xcf\x68\xf8\xaa\x51\x6d\x3e\x18 
Cash.5154000.name \x8e\x6c\xdf\x13\xe8\x14\x09\x68\x8e\xaa\x1f\x6a\xac\x16\x89\x10\x1e\x13\x93\xaa\x54\x65\x45\x79 
Cash.5154000.desc \x89\xaa\xc8\xaa\x88\x6c\xd9\x13\xea\x14\x0b\x68\x90\xaa\x49\x11\x1b\x6c\x57\x68\x97\xaa\x65\x6f\xaa\x6b\x97\xaa\x14\x6a\x10\x6c\xe2\x7f\xcf\x10\x90\xaa\x9d\xaa\x8f\xaa\x33\x7c\x10\x6f\xe1\xaa\x9e\x7f\x9b\x7f\x28\x6f\xe5\xaa\x76\x6a\xdb\x16\xe8\xaa\xf1\x10\x66\x13\x97\x12\xec\xaa\xd9\x16\x0e\x05\xef\xaa\xc8\x68\xf1\xaa\x5a\x6d\x37\x18 
Cash.5160000.name \x12\x6c\xaa\x12\x14\x6c\xac\x12 
Cash.5160000.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x7a\x7b\x83\x7f\x48\x18\xfd\xaa\x82\x7e\xca\x62\xa4\x6d\xc1\xaa\xbe\x7f\x07\x18\xca\xaa 
Cash.5160001.name \x62\x7f\xda\x06\x64\x7f\xdc\x06 
Cash.5160001.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x23\x18\xb2\x7c\x84\x7f\x49\x18\xfe\xaa\x83\x7e\xf5\x62\xa5\x6d\xc2\xaa\xbf\x7f\x00\x18\xcb\xaa 
Cash.5160002.name \x2e\x04\x8f\x6c 
Cash.5160002.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x3a\x68\x43\x1a\x84\x7f\x49\x18\xfe\xaa\x83\x7e\xf5\x62\xa5\x6d\xc2\xaa\xbf\x7f\x00\x18\xcb\xaa 
Cash.5160003.name \xea\x15\xeb\x15 
Cash.5160003.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x9a\x15\x9b\x15\x84\x7f\x49\x18\xfe\xaa\x83\x7e\xf5\x62\xa5\x6d\xc2\xaa\xbf\x7f\x00\x18\xcb\xaa 
Cash.5160004.name \xb3\x6d\xc7\x7a 
Cash.5160004.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\xc3\x6d\xb7\x7a\x84\x7f\x49\x18\xfe\xaa\x83\x7e\xf5\x62\xa5\x6d\xc2\xaa\xbf\x7f\x00\x18\xcb\xaa 
Cash.5160005.name \xa2\x18\x97\x11\xa1\x66 
Cash.5160005.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x9e\x6f\xd7\x79\x84\x7f\x49\x18\xfe\xaa\x83\x7e\xf5\x62\xa5\x6d\xc2\xaa\xbf\x7f\x00\x18\xcb\xaa 
Cash.5160006.name \xa2\x67\xda\x12\xa4\x67\xdc\x12 
Cash.5160006.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\xd2\x67\xaa\x12\xd4\x67\xac\x12\x82\x7f\xff\xaa\xbc\x7e\xf4\x62\xa6\x6d\xc3\xaa\xb8\x7f\x01\x18\xc8\xaa 
Cash.5160007.name \xf6\x7c\xf7\x7c 
Cash.5160007.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\x86\x7c\x87\x7c\x1c\x7a\x49\x18\xfe\xaa\x30\x1e\xbc\x7f\xc1\xaa\xbe\x7e\xf6\x62\xa0\x6d\xc5\xaa\xba\x7f\x03\x18\xc6\xaa 
Cash.5160008.name \xb2\x16\x76\x63\xb4\x16\x70\x63 
Cash.5160008.desc \xee\x6f\xdf\x6d\xf4\x65\xe9\x6d\x8e\xaa\xfb\x19\xa4\x14\xc5\x7a\x1f\x13\xeb\x7f\xc4\x06\x2d\x1a\x96\xaa\x13\x7a\x98\xaa\x9d\x6b\xaf\x62\x6b\x6f\xa0\x6b\x9d\xaa\x6e\x6c\xe7\x7f\x54\x18\xe1\xaa\x66\x7a\x13\x6f\xe4\xaa\xe1\x6b\xd3\x62\x9b\x7f\xe8\xaa\x0d\x7c\xea\xaa\xbf\x7f\x35\x18\xed\xaa\x6a\x7a\xb3\x13\xf0\xaa\xd5\x18\xa6\x13\xa7\x10\xf4\xaa\x45\x64\x7b\x13\xe7\x7b\xd8\x06\xf9\xaa\xc2\x16\x06\x63\xc4\x16\x00\x63\x86\x7f\x4b\x18\xc0\xaa\xbd\x7e\xf7\x62\xa7\x6d\xc4\xaa\xb9\x7f\x02\x18\xc9\xaa
## Post #186
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-01T01:09:19+00:00
- Post Title: 

> Reply from Omega
>
> nicoli_s wrote:MMODB http://ms.mmodb.com
Extracted  sorry for the plug, but couldn't resist 
btw, is the problem with unicode strings that python doesn't have a way to handle them, or that we don't know how to decode them?
Guess i should put my plug as well 
http://strategywiki.org/wiki/MapleStory
I'm going to be putting up whatever info I can there.  Also going to try and extract data from the other versions and post the data.

About unicode, the strings are extracted properly, the difficulty is displaying them.  Any web browser should be able to display it properly, its just a matter of figuring out how to indicate you're displaying unicode not regular text.

EDIT: Try this
replace the line in transStr16:    
s += struct.pack("h",  xor16(a,p))
with this:
s += "&#" + str(xor16(a,p))

If you are using lambda's code, do this fix, and when opening the file in your web browser it should display the text in its original korean
## Post #187
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-01T13:23:43+00:00
- Post Title: 

The problem is, I don't no where to run this thing.
## Post #188
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-01T19:00:16+00:00
- Post Title: 

> Reply from era
>
> The problem is, I don't no where to run this thing.
can you be a bit more specific? ("this thing" being lambda's code?)
## Post #189
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-02T14:01:43+00:00
- Post Title: 

Oh, sorry for not being specific.

yeah, I did mean lambada's code
## Post #190
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-02T14:48:50+00:00
- Post Title: 

> Reply from era
>
> Oh, sorry for not being specific.

yeah, I did mean lambada's code
You will first need to install Python ([http://www.python.org](http://www.python.org))
put the dump.py file in the same directory as your data.wz (possibly backup the data.wz and run it in a separate folder)
double click on dump.py and it should run for a while (read: 1 - 3+ hours depending on your comp speed) and it will create a directory called dump.

to edit the file like i said, open the dump.py in any text editor, just make sure you keep all the spacing correct.

Hope that helps
## Post #191
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-02T14:54:14+00:00
- Post Title: 

I already got all of the files out.

Also, I'm working with the korean version and the strings are all at string.wz(if that matters)


I change the file name to data.wz and then ran the dump.py file.

I did the fix you asked for; however, the text appeared to be the same as  when I extracted a while ago.

here's the link for string.wz : [http://maplestory.net2.eu:8014/userno49 ... /string.wz](http://maplestory.net2.eu:8014/userno4905432/files~/string.wz)



EDIT : I also changed       "return hexStr(result)" to "      return result" but it turned out like this L 

Eqp.Accessory.1010000.name ?bjë™¦?í„§So 
Eqp.Accessory.1010001.name sS,ëœ§í„§So 
Eqp.Accessory.1010002.name ;m`=më •gh? 
Eqp.Accessory.1010003.name ?o 
Eqp.Accessory.1010004.name ?Khë™¦mZOë§šì¯ªNo 
Eqp.Accessory.1010005.name ?Khë™¦Qo më£µì®
## Post #192
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-02T16:17:20+00:00
- Post Title: 

heres what i get (mine isn't formatted nearly as nicely as lambda's )
data\Item.img ('Eqp', [('Accessory', [('1010000', [('name', 'ê°ˆìƒ‰ í„±ìˆ˜ì—¼')]), ('1010001', [('name', 'ë
## Post #193
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-02T16:22:46+00:00
- Post Title: 

Come on~

Tell me how to.

is there anything else I need to do?


What do I exactly have to change in dump.py (lambda's)





EDIT : I thing the hex codes I got are a bit weird. How did you get the other code for "ì
## Post #194
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-03T21:44:18+00:00
- Post Title: 

[quote="era"]Come on~

Tell me how to.

is there anything else I need to do?

What do I exactly have to change in dump.py (lambda's)

EDIT : I thing the hex codes I got are a bit weird. How did you get the other code for "ì
## Post #195
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-03T22:18:06+00:00
- Post Title: 

Ok, i changed up his code a bit, should work now
[dump.zip](https://xentaxbackup.github.io/file/882_dump.zip)
## Post #196
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-10-04T03:18:34+00:00
- Post Title: 

Yay it worked. Can you tell me what functions you've changed please? I've already editted Lambda's code to make my XML for my site.

For all you non-KMS people:

```
import zlib
import sys
import os
import re

# ===========================================
# ============= Tree Flattening =============
# ===========================================

def flattenName(parent, child):
  if(parent == ""): return child
  else: return "%s.%s" % (parent, child)

def flattenRecurse(vals, name = ""):
  global flattenReturn
  if(type(vals) == type([])):
    if(type(vals[0]) == type("")):
      if(type(vals[1]) != type([])):
        result = [flattenName(name, vals[0]), vals[1]]
        flattenReturn.append(result)
      else:
        for val in vals[1:]:
          flattenRecurse(val, flattenName(name, vals[0]))
    else:
      for val in vals:
        flattenRecurse(val, name)

def flatten(vals):
  global flattenReturn
  flattenReturn = []
  flattenRecurse(vals)
  return flattenReturn

# ===========================================
# ============== Final Output ===============
# ===========================================

# findImage should work for image*'s, but the image*'s
#  aren't always valid, or possibly point to a parent
#  class's image...

#def findImage(name, vals):
#  name = name.replace("/", ".")
#  name = "%s.image" % name
#  for val in vals:
#    if(val[0] == name): return val[1]
#
#  name = "%s*" % name
#  for val in vals:
#    if(val[0] == name): return findImage(val[1], vals)
#
#  print "Could not find image %s" % name
#  sys.exit(-1)

def endMatches(str, values):
  for s in values:
    if(str[-len(s):] == s): return 1
  return 0

def textOut(vals):
  for val in vals:
    print "%s: %s" % (val[0], val[1])
  # Code used for testing findImage... which doesn't work (see above note)
  #for val in vals:
  #  if(endMatches(val[0], ["image*"])):
  #    print "Searching for %s: %s" % (val[0], val[1])
  #    print "%s: %s)" % (val[0][:-1], findImage(val[1], vals), val[1])
  #  else:
  #    print "%s: %s" % (val[0], val[1])

def htmlOut(vals):
  print "<table>"
  for val in vals:
    if(endMatches(val[0], ["image"])):
      print "<tr><td>%s</td><td><img src='%s'></td></tr>" % (val[0], val[1])
    elif(endMatches(val[0], ["mp3"])):
      print "<tr><td>%s</td><td><a href='%s'>mp3</a></td></tr>" % (val[0], val[1])
    else:
      print "<tr><td>%s</td><td>%s</td></tr>" % (val[0], val[1])
  print "</table>"

def safe_mkdir(dirName):
  try:
    os.mkdir(dirName)
  except OSError, (errno, strerror):
    if(errno != 17):
      print "%d: %s" % (errno, strerror)
      sys.exit(-1)

# ===========================================
# ============ PNG/Image Routines ===========
# ===========================================

def pack_chunk(tag,data):
  to_check = tag + data
  return struct.pack("!I",len(data)) + \
         to_check + \
         struct.pack("!I",zlib.crc32(to_check))

def dumpToPNG(width, height, data):
  raw_data = ""
  for y in range(height):
    raw_data += chr(0)
    raw_data += data[y*width*4:(y+1)*width*4]

  return struct.pack("8B", 137, 80, 78, 71, 13, 10, 26, 10) + \
         pack_chunk('IHDR',
           struct.pack("!IIBBBBB",width,height,8,6,0,0,0)) + \
         pack_chunk('IDAT', zlib.compress(raw_data,9)) + \
         pack_chunk('IEND', '')

def image16to32(width, height, data):
  datalen = len(data)
  buf = ""
  for i in range(width*height):
    # Not all images decompress correectly. This makes up for it.
    if(i > datalen/2 - 1):
      p = [0,0]
    else:
      p = struct.unpack("BB", data[i*2:i*2+2])

    a = p[1] / 16 ; a = a*16 + a
    r = p[1] % 16 ; r = r*16 + r
    g = p[0] / 16 ; g = g*16 + g
    b = p[0] % 16 ; b = b*16 + b

    if(a >  255): a = 255
    if(r >  255): r = 255
    if(g >  255): g = 255
    if(b >  255): b = 255

    buf += struct.pack("BBBB", r, g, b, a)
  return buf

# ===========================================
# =========== Abort/Debug Routines ==========
# ===========================================

def printItem(name, value):
  print "%-30s: %s" % (name, value)

def check(flag, val, f, msg="Default Error"):
  if(flag != val):
    item  = "Unknown: %s" % repr(flag) ; value = "Expecting: %s" % repr(val)
    printItem(item, value)
    printItem("Error", msg)
    printItem("FileLocation", repr(f.tell()))
    sys.exit(-1)

def checkA(flag, vals, f, msg="Default Error"):
  if(not flag in vals):
    item  = "Unknown: %s" % repr(flag) ; value = "Expecting: %s" % repr(vals)
    printItem(item, value)
    printItem("Error", msg)
    printItem("FileLocation", repr(f.tell()))
    sys.exit(-1)

# ===========================================
# ============ Basic File Reading ===========
# ===========================================

def rU8 (f): return struct.unpack('B', f.read(1))[0]
def rS8 (f): return struct.unpack('b', f.read(1))[0]
def rU16(f): return struct.unpack('H', f.read(2))[0]
def rU32(f): return struct.unpack('I', f.read(4))[0]
def rS32(f): return struct.unpack('i', f.read(4))[0]
def rU64(f): return struct.unpack('Q', f.read(8))[0]
def rF32(f): return struct.unpack('f', f.read(4))[0]
def rF64(f): return struct.unpack('d', f.read(8))[0]

def rPackNum(f):
  size = rS8(f)
  if(size == -128): size = rS32(f)
  return size

# ===========================================
# ============ String Decryption ============
# ===========================================

def hexStr(s):
  str = ''
  for c in s:
    str += "\\x%02x" % ord(c)
  return str

def xor  (a, p): return  ((a & ~p) ^ (~a & p)) & 0xff
def xor16(a, p): return  ((a & ~p) ^ (~a & p)) & 0xffff

def transStr(str):
  s = ''
  p = 0xAA
  for cc in str:
    a = ord(cc)
    s += struct.pack("B", xor(a,p) )
    p += 1
  return s

def transStr16(encStr):
  s = ''
  p = 0xAAAA
  for i in range(len(encStr)/2):
    a = struct.unpack("h", encStr[i*2:i*2+2])[0]
    #s += struct.pack("h", xor16(a,p) )
    s += "&#" + str(xor16(a,p))
    p += 1
  return s

# ===========================================
# ========= External File Extraction ========
# ============= (MP3s and PNGs) =============
# ===========================================

def dumpImage(f, imageName):
  global dumpDir
  global dumpImages

  width  = rPackNum(f)
  height = rPackNum(f)
  val   = rPackNum(f)    ; checkA(val, [0, 1, 2, 10, 513], f)
  val2  = rU8(f)         ; checkA(val2, [0, 2, 4], f)
  nulls = f.read(4)      ; check(nulls, "\x00\x00\x00\x00", f, "Dump Image")
  bufSize = rU32(f) - 1
  flag = rU8(f)          ; check(flag,  0x00, f);

  if(not dumpImages):
    f.seek(bufSize, 1)
  else:
    obj = zlib.decompressobj()
    buf = obj.decompress(f.read(bufSize))
    if(width*height*2 != len(buf)): print "Bad image: %s" % imageName
    g = open(dumpDir + imageName, "wb")
    g.write(dumpToPNG(width, height, image16to32(width, height, buf)))
    g.close()

def dumpMp3(f, size, endOfBlock):
  startOfMP3 = endOfBlock - size
  remaining = startOfMP3 - f.tell()
  #unknown = f.read(remaining)
  #g = open("%d.mp3" % mp3count, "wb")
  #g.write(f.read(size))
  #g.close()
  #mp3count += 1
  f.seek(endOfBlock)

# ===========================================
# ================= Header ==================
# ===========================================

def extractHeader(f):
  v = {}
  v["FileIdentity"] = f.read(4)
  v["FileSize"]     = rU64(f)
  v["FileStart"]    = rU32(f)
  v["Copyright"]    = f.read(v["FileStart"] - f.tell())
  return v

# ===========================================
# ========== Directory / File Tree ==========
# ===========================================

def extractDirectory(f, baseName, blockOffset):
  global eFiles

  dirs  = []
  entryCount = rPackNum(f)
  for j in range(entryCount):
    filetype = rU8(f)    ; checkA(filetype, [0x02, 0x03, 0x04], f)
    if(filetype in [0x03, 0x04]):
      filename = rUStr(f)
    if(filetype in [0x02]):
      filenameloc  = rU32(f)
      filename = rUStrAt(f, filenameloc, blockOffset)
    filesize = rPackNum(f)
    unknown1 = rPackNum(f)
    unknown2 = rU32(f)

    v = {"Name": baseName + "/" + filename,
         "Size": filesize,
         "Unk1": unknown1,
         "Unk2": unknown2}

    if(filetype in [0x03]):
      dirs.append(v)
    if(filetype in [0x02, 0x04]):
      eFiles.append(v)

  for dir in dirs:
    extractDirectory(f, dir["Name"], blockOffset)

def computeFileOffsets(fileBase):
  global eFiles

  totalOffset = 0
  for file in eFiles:
    file["Offset"] = fileBase + totalOffset
    totalOffset += file["Size"]

def extractDirectories(f, blockOffset):
  global eFiles
  eFiles = []
  extractDirectory(f, "", blockOffset)
  computeFileOffsets(f.tell())
  return eFiles

def extractDirTree(f, blockOffset):
  v = {}
  v["Unknown"] = rU16(f)
  v["Files"]   = extractDirectories(f, blockOffset)
  return v

# ===========================================
# ============= Everything else =============
# ===========================================

def subBlock(f, count, endOfBlock = 0):
  result = []
  if(count == 0): return '-NONE-'
  for i in range(count):
    flag = rU8(f)  ; check(flag, 0x1b, f)
    type = rU32(f)
    val1 = rPackNum(f) ; val2 = 0
    if(f.tell() != endOfBlock):
      val2 = rPackNum(f)
    result.append([val1, val2])
  return result

def rUStr(f): return extract00type(f)
def rUStrAt(f, loc, baseOffset): return extract00typeAt(f, loc, baseOffset)

previousStrings = {}
parsingFileTree = 0
def extract00type(f):
  size = rS8(f)
  if(size == 0):
    return ''
  elif(size < 0):
    if(size == -128): size = rU32(f)
    else:             size = -size
    result = transStr(f.read(size))

    # Keep a list of previous translations
    global previousStrings
    previousStrings[result] = 0

    return result
  elif(size > 0):
    if(size == 127): size = rU32(f)

    global parsingFileTree
    if(parsingFileTree):
      subSize = rS8(f) ; subCount = 1
      if(subSize < 0): subSize = -subSize
      else:            subSize = rU32(f) ; subCount += 4
      subStr  = transStr(f.read(size*2 - subCount))

      for previousString in previousStrings.keys():
        if((len(previousString) == subSize) and 
           (previousString[0:size*2-1] == subStr)):
          return previousString
      print "Can't find String '%s' at %d" % (subStr, f.tell())
      sys.exit(-1)
    else:
      if(size == 1):
        val = rU16(f)
        val = xor16(val, 0x558a)
        if(val < 256):
          return chr(val)
        else:
          f.seek(-2, 1)
      
      result = f.read(size*2)
      
      result = transStr16(result)
      return result

def extract00typeAt(f, loc, baseOffset):
  pos = f.tell()
  f.seek(loc + baseOffset, 0)
  value = extract00type(f)
  f.seek(pos)
  return value

def extract01type(f, baseOffset):
  loc = rU32(f)
  return extract00typeAt(f, loc, baseOffset)

def extract02type(f):
  return rU16(f)

def extract03type(f):
  return rPackNum(f)

def extract04type(f):
  type = rU8(f) ; checkA(type, [0x00, 0x80], f, "0x04 type")
  if   (type == 0x80): return rF32(f)
  elif (type == 0x00): return 0

def extract05type(f):
  return rF64(f)

def extract08type(f, name, baseOffset):
  return dumpBlock(f, name, baseOffset)

def extract09type(f, name, baseOffset):
  size = rU32(f)
  loc = f.tell()
  endOfBlock = f.tell() + size
  result = dumpBlock(f, name, baseOffset, f.tell() + size)
  if(f.tell() != endOfBlock):
    print "Incomplete Block [%s] at offset %d, size: %d, loc: %d" % (name, loc, size, f.tell())
    f.seek(endOfBlock, 0)
    sys.exit(-1)
  return result

def extract1btype(f, name, baseOffset, endOfBlock):
  flag  = rU16(f)
  flagb = rU16(f)

  locb  = f.tell()
  
  val1 = rPackNum(f) ; val2 = 0
  if(f.tell() != endOfBlock):
    val2 = rPackNum(f)

  if(f.tell() == endOfBlock):
    return [['x', val1], ['y', val2]]

  f.seek(locb, 0)
  val1 = rU8(f)
  if(val1 == 0x00):
    val2 = rU8(f) ; subt = 0
    if(val2 not in [0x00, 0x80] and flag != 0x01):
      nil = rU16(f)  ; check(nil,  0x00, f, "Inner 1b type1")

    if(val2 == 0x80):
      size = rU32(f)
      dumpMp3(f, size, endOfBlock)
      return ["mp3", name]
    else:
      vals = []
      if(not (val1 == 0x00 and val2 == 0x00) or (flag == 0x01)):
        descCount = rPackNum(f)
        for j in range(descCount):
          qname = dumpBlock(f, name, baseOffset)
          val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
          vals.append([qname, val])

      if(f.tell() == endOfBlock):
        if(vals == []): return '-NONE-'
        else:           return vals
      else:
        imgname = name.replace('/', '.') + ".png"
        dumpImage(f, imgname)
        vals.append(['image', imgname])
        return vals
  else:
    blockval = val1
    return subBlock(f, val1, endOfBlock)

def computeName(image, name):
  name = name[0:name.rfind("/")+1]
  while(image[0:3] == "../"):
    name = name[0:-1]
    name = name[0:name.rfind("/")+1]
    image = image[3:]
  return name + image

def extract73type(f, name, baseOffset, endOfBlock):
  iname = rUStr(f)
  if(iname == "Shape2D#Convex2D"):
    count = rPackNum(f)
    return subBlock(f, count, endOfBlock)
  if(iname == "Shape2D#Vector2D"):
    val1 = rPackNum(f)
    val2 = rPackNum(f)
    return [["x", val1], ["y", val2]]
  if(iname == "Canvas"):
    space = rU16(f)  ; checkA(space, [0, 256], f)
    if(space == 256):
      nil = rU16(f)
      count = rU8(f)
      for i in range(count):
        qname = dumpBlock(f, name, baseOffset)
        val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
    imgname = name.replace('/', '.') + ".png"
    dumpImage(f, imgname)
    return ['image', imgname]
  if(iname == "UOL"):
    nil = rU8(f)
    image = dumpBlock(f, name, baseOffset)
    cName = computeName(image, name)
    return ['image*', cName]
  if(iname == "Sound_DX8"):
    nil = rU8(f)
    size = rPackNum(f)
    dumpMp3(f, size, endOfBlock)
    return ["mp3", name]
# ---------------------------------------------

def dumpBlock(f, name, baseOffset, endOfBlock = 0):
  global vals
  type = rU8(f)

  if   (type == 0x00): return extract00type(f)
  elif (type == 0x01): return extract01type(f, baseOffset)
  elif (type == 0x1b): return extract1btype(f, name, baseOffset, endOfBlock)
  elif (type == 0x73): return extract73type(f, name, baseOffset, endOfBlock)

def dumpEntryValue(f, name, baseOffset):
  global vals
  type = rU8(f)

  if   (type == 0x00): return "-NIL-"
  elif (type == 0x02): return extract02type(f)
  elif (type == 0x03): return extract03type(f)
  elif (type == 0x04): return extract04type(f)
  elif (type == 0x05): return extract05type(f)
  elif (type == 0x08): return extract08type(f, name, baseOffset)
  elif (type == 0x09): return extract09type(f, name, baseOffset)

def dumpFile(f, sname, baseOffset):
  global vals
  vals = {}

  flag = rU8(f)      ; check(flag, 0x73, f)
  imgName = rUStr(f) ; check(imgName, "Property", f)
  space = rU8(f)     ; check(space, 0x00, f, "File Outer Space")
  space = rU8(f)     ; check(space, 0x00, f, "File Outer Space 2")
  entries = rPackNum(f)
  
  vals = []
  for i in range(entries):
    name  = dumpBlock(f, sname, baseOffset)
    value = dumpEntryValue(f, str(name), baseOffset)
    vals.append([name, value])
  return vals


def dump():
  global dumpImages, dumpHTML
  global dumpDir, dumpDirBase
  f = open("data.wz", "rb")

  if(dumpImages or dumpHTML):
    safe_mkdir(dumpDirBase)
    origstdout = sys.stdout

  header = extractHeader(f)
  DirTreeOffset = f.tell()

  global parsingFileTree
  parsingFileTree = 1
  dirTree = extractDirTree(f, DirTreeOffset)
  parsingFileTree = 0

  for i in range(len(dirTree["Files"])):
    file = dirTree["Files"][i]
    f.seek(file["Offset"], 0)
    if (re.search("String", file["Name"])):
      if(dumpImages or dumpHTML):
        dumpDir = dumpDirBase + file["Name"].replace("/", ".") + "/"
        safe_mkdir(dumpDir)

      print "%4d: %s, %d, %d" % (i, repr(file["Name"])[1:-1], file["Size"], file["Offset"])

      vals = dumpFile(f, file["Name"], file["Offset"])
      vals = flatten(vals)
      if(dumpHTML):
        g = open(dumpDir + "index.html", "w")
        sys.stdout = g

        htmlOut(vals)

        g.close
        sys.stdout = origstdout
      else:
        textOut(vals)

dumpImages = 1
dumpHTML = 1

dumpDirBase = "dump2/"
dumpDir     = dumpDirBase

dump()

```
## Post #197
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-04T04:22:27+00:00
- Post Title: 

Here's a diff.
Are you making a sauna for kms?

Compare: (<)dumpNew.py (16616 bytes)
   with: (>)dump.py (16796 bytes)

198,204c198,203
< def transStr16(encStr):
<   s = ''
<   p = 0xAAAA
<   for i in range(len(encStr)/2):
<     a = struct.unpack("h", encStr[i*2:i*2+2])[0]
<     #s += struct.pack("h", xor16(a,p) )
<     s += "&#" + str(xor16(a,p))
---
> def transStr16(str):
>   s = ''
>   p = 0xAAAA
>   for i in range(len(str)/2):
>     a = struct.unpack("h", str[i*2:i*2+2])
>     s += struct.pack("h", xor16(a,p) )


373,374c372,377
<       result = transStr16(result)
<       return result
---
>       ##transStr16 does not work in all cases...
>       ## plus it needs extra UTF-16 to UTF-8 encoding
>       ## handling.  So for now, just return the hexStr
>       ## of it.  Maybe someone else can figure it out.
>       # results = transStr16(result)
>       return hexStr(result)


542c545
<   f = open("string.wz", "rb")
---
>   f = open("data.wz", "rb")
## Post #198
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-04T18:52:15+00:00
- Post Title: 

Wow, thanx alot!



How come the MP3 files are not extracted?
## Post #199
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-10-05T03:20:01+00:00
- Post Title: 

My MS site: [http://www.themfund.com](http://www.themfund.com)

In alpha stage.

To extract MP3's uncomment the "extractMp3" function.
## Post #200
- Username: SpareParts
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Thu Oct 05, 2006 6:48 pm
- Post datetime: 2006-10-05T10:53:47+00:00
- Post Title: 

I think I need severe help on this.

So, I started the dump, allowed it to run, waited for 2 hours, and..

it died somewhere in the middle.

The extraction stopped at ".Map.Obj.etc.img".

Is it because of the MP3 Extraction? I decommented it during both of my tries. 

Anyway, it there a way to freeze the frame before it closes? In other words, get the program to stop and wait for any key on the keyboard before it closes. That way, I can see what is the error message shown on the screen.

Oh thanks man, I have been editing the code here and there, and couldn't figure out what's wrong. =S
## Post #201
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-05T14:50:35+00:00
- Post Title: 

> Reply from SpareParts
>
> I think I need severe help on this.

So, I started the dump, allowed it to run, waited for 2 hours, and..

it died somewhere in the middle.

The extraction stopped at ".Map.Obj.etc.img".

Is it because of the MP3 Extraction? I decommented it during both of my tries. 

Anyway, it there a way to freeze the frame before it closes? In other words, get the program to stop and wait for any key on the keyboard before it closes. That way, I can see what is the error message shown on the screen.

Oh thanks man, I have been editing the code here and there, and couldn't figure out what's wrong. =S
Open a command prompt, browse to the location of the dump.py file and type (at the command prompt) dump.py.  It should run, and when it finishes it shouldnt close the window.
## Post #202
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-10-06T02:57:57+00:00
- Post Title: 

Or you use Python IDLE. Start > Programs> Python> IDLE
## Post #203
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-06T18:14:27+00:00
- Post Title: 

> Reply from themoviefund
>
> Or you use Python IDLE. Start > Programs> Python> IDLE
Yes, but it doesn't feel as 1337 to type into idle as it does to type into cmd
## Post #204
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-10T14:51:27+00:00
- Post Title: 

Q1 - Can you extract the questions given when you attempt the 3rd advancement(?), for example when you turn from an assassin into a hermit.


Q2 - When you try to extract, is there any way you can exclude the files already extracted and only extract the new files.


Q3 - The big bird that appears on the boat heading for Lipre is not extracted properly, is there some problem?(Actually, almost the whole Lipre place is not extracted properly.)


I'll be Waiting
## Post #205
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-10T16:28:01+00:00
- Post Title: 

> Reply from era
>
> Q1 - Can you extract the questions given when you attempt the 3rd advancement(?), for example when you turn from an assassin into a hermit.


Q2 - When you try to extract, is there any way you can exclude the files already extracted and only extract the new files.


Q3 - The big bird that appears on the boat heading for Lipre is not extracted properly, is there some problem?(Actually, almost the whole Lipre place is not extracted properly.)


I'll be Waiting
1. I did a quick search through a few directories but couldn't find anything.  The info should be there though.  Do you know any of the questions that were asked (exact strings), or the name of the map that the questions are asked in?

2.  With the way it's written now, no.
3.  I'm guessing you mean Riprey?  Well the problem with images is that they aren't properly labeled in the data file.  We don't actually know how to tell them apart 100%.  The best way I've found is based on the name of the block containing the file, though that isn't perfect either.  I'm going to try by where the file is referenced and that might work better.
## Post #206
- Username: Ghastly
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Wed Oct 11, 2006 7:55 am
- Post datetime: 2006-10-11T01:29:04+00:00
- Post Title: 

Hi I'm new here, I'm wondering if there is a KMS script? They have different folders such as;
String.wz,Effect.wz,Map.wz,Character.wz,Base.wz,Quest.wz,NPC.wz,sound.wz,Mob.wz and UI.wz
I wonder if it's possible to extract those?

Also I got a "Bad Image back.0.img" Any help?
## Post #207
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-11T04:48:35+00:00
- Post Title: 

> Reply from Ghastly
>
> Hi I'm new here, I'm wondering if there is a KMS script? They have different folders such as;
String.wz,Effect.wz,Map.wz,Character.wz,Base.wz,Quest.wz,NPC.wz,sound.wz,Mob.wz and UI.wz
I wonder if it's possible to extract those?

Also I got a "Bad Image back.0.img" Any help?
I think this has been answered before, but anywayz
Inside the dump.py file, there is a place where it tells filename (data.wz)
Change that to the filename of each and run the program one at a time.  They will all extract to the dump folder, so make sure you rename the created folder to something unique after each run.  That should work I think
## Post #208
- Username: Lambda
- Rank: beginner
- Number of posts: 20
- Joined date: Sat Aug 19, 2006 5:42 pm
- Post datetime: 2006-10-11T05:50:07+00:00
- Post Title: 

> Reply from Ghastly
>
> Hi I'm new here, I'm wondering if there is a KMS script? They have different folders such as;
String.wz,Effect.wz,Map.wz,Character.wz,Base.wz,Quest.wz,NPC.wz,sound.wz,Mob.wz and UI.wz
I wonder if it's possible to extract those?

Also I got a "Bad Image back.0.img" Any help?

The bad image is bad data on the part of Wizet, or so I believe.  Images are compressed using the same compression used for png.  The "Bad Image" message comes up when the uncompression fails.
## Post #209
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2006-10-16T16:37:36+00:00
- Post Title: 

> Reply from era
>
> Q1 - Can you extract the questions given when you attempt the 3rd advancement(?), for example when you turn from an assassin into a hermit.Non-quest related NPC text is all serverside (sent to client when you talk to it), so no, sorry.
## Post #210
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2006-10-19T02:51:37+00:00
- Post Title: 

With the new patch, it stops at weddingGL because of an incorrect value.
## Post #211
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-21T05:15:12+00:00
- Post Title: 

> Reply from kiler
>
> With the new patch, it stops at weddingGL because of an incorrect value.
This might have to do with the fact that there are two "files" with the same weddingGL name.
## Post #212
- Username: Ghastly
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Wed Oct 11, 2006 7:55 am
- Post datetime: 2006-10-22T08:48:08+00:00
- Post Title: 

> Reply from Omega
>
> I think this has been answered before, but anywayz
Inside the dump.py file, there is a place where it tells filename (data.wz)
Change that to the filename of each and run the program one at a time.  They will all extract to the dump folder, so make sure you rename the created folder to something unique after each run.  That should work I think
...Tried that, only thing that happened was it flashes up for less than a second, dump folder created, inside empty.
## Post #213
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-23T02:27:20+00:00
- Post Title: 

> Reply from Ghastly
>
> Omega wrote:I think this has been answered before, but anywayz
Inside the dump.py file, there is a place where it tells filename (data.wz)
Change that to the filename of each and run the program one at a time.  They will all extract to the dump folder, so make sure you rename the created folder to something unique after each run.  That should work I think
...Tried that, only thing that happened was it flashes up for less than a second, dump folder created, inside empty.
Run it from the command prompt. (start->run->"cmd"->browse to the directory with dump.py->type "dump.py")
Tell us what the error you get is.
## Post #214
- Username: Ghastly
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Wed Oct 11, 2006 7:55 am
- Post datetime: 2006-10-23T11:04:31+00:00
- Post Title: 

...I tried cmd But even if I try it it's still stuck at C:\Documents and Settings\(I don't want my real name revealed)

How do you change where the command prompt goes?
## Post #215
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-23T15:45:11+00:00
- Post Title: 

> Reply from Ghastly
>
> ...I tried cmd But even if I try it it's still stuck at C:\Documents and Settings\(I don't want my real name revealed)

How do you change where the command prompt goes?
"cd .." will take you up a folder
so if your are in C:\Documents and settings\Omega\
typing cd .. will take you to C:\Documents and Settings

if there are 3 folders there named: "Omega, Alpha, Gamma"
type "cd Omega" to access Omega, "cd Alpha" to access Alpha, etc
To see a list of files and folders in the directory, type "dir"
For more help, try wikipedia or google, but that should be enough
## Post #216
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-10-23T21:20:50+00:00
- Post Title: 

Did you try copying Data.wz to the folder with the script?
## Post #217
- Username: Ghastly
- Rank: ultra-n00b
- Number of posts: 6
- Joined date: Wed Oct 11, 2006 7:55 am
- Post datetime: 2006-10-24T06:33:46+00:00
- Post Title: 

Thanks, heres the error


Oh, themoviefund, Sorry but KMS doesn't have a Data.wz
## Post #218
- Username: szevvy
- Rank: n00b
- Number of posts: 15
- Joined date: Thu Sep 21, 2006 2:20 pm
- Post datetime: 2006-10-24T08:53:53+00:00
- Post Title: 

What happened to your backslashes?
## Post #219
- Username: Manias
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Tue Oct 24, 2006 7:03 pm
- Post datetime: 2006-10-24T11:16:51+00:00
- Post Title: 

Korea MapleStory Error...
-------------------------------------------------------------
cd c:\new
string.py
-------------------------------------------------------------
22 : Invalid argument...
hm...
How to solve this problem?
## Post #220
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2006-10-24T15:03:08+00:00
- Post Title: 

> Reply from Manias
>
> Korea MapleStory Error...
-------------------------------------------------------------
cd c:\new
string.py
-------------------------------------------------------------
22 : Invalid argument...
hm...
How to solve this problem?KMS, or KMST?
## Post #221
- Username: Manias
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Tue Oct 24, 2006 7:03 pm
- Post datetime: 2006-10-24T15:46:51+00:00
- Post Title: 

> Reply from Rick
>
> Manias wrote:Korea MapleStory Error...
-------------------------------------------------------------
cd c:\new
string.py
-------------------------------------------------------------
22 : Invalid argument...
hm...
How to solve this problem?KMS, or KMST?

KMST..  

File (String.wz) : [http://ciger166.dothome.co.kr/String.zip](http://ciger166.dothome.co.kr/String.zip)
## Post #222
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2006-10-24T16:53:02+00:00
- Post Title: 

> Reply from Manias
>
> KMST..  

File (String.wz) : http://ciger166.dothome.co.kr/String.zipWizet's response to public information on accessing Data.wz: new encryption.
## Post #223
- Username: era
- Rank: ultra-n00b
- Number of posts: 9
- Joined date: Sun Oct 01, 2006 3:02 am
- Post datetime: 2006-10-24T17:37:15+00:00
- Post Title: 

> Reply from Rick
>
> Manias wrote:KMST..  

File (String.wz) : http://ciger166.dothome.co.kr/String.zipWizet's response to public information on accessing Data.wz: new encryption.

Then dya guys have to work all over again?
## Post #224
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2006-10-25T04:11:12+00:00
- Post Title: 

> Reply from era
>
> Rick wrote:Manias wrote:KMST..  

File (String.wz) : http://ciger166.dothome.co.kr/String.zipWizet's response to public information on accessing Data.wz: new encryption.  

Then dya guys have to work all over again?
We'll see when these changes get to GMS
## Post #225
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2006-10-26T05:22:40+00:00
- Post Title: 

Noooo! Don't change encryption. How 'bout deleting this thread so that they won't know we extracted?
## Post #226
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-10-27T12:26:29+00:00
- Post Title: 

> Reply from themoviefund
>
> Noooo! Don't change encryption. How 'bout deleting this thread so that they won't know we extracted?
it seems that..
Wizet change something make dump can't extract
## Post #227
- Username: singga
- Rank: n00b
- Number of posts: 19
- Joined date: Sat Aug 19, 2006 4:08 pm
- Post datetime: 2006-10-27T12:38:08+00:00
- Post Title: 

> Reply from singga
>
> themoviefund wrote:Noooo! Don't change encryption. How 'bout deleting this thread so that they won't know we extracted?
it seems that..
Wizet change something make dump can't extract
I am talking about KMST
## Post #228
- Username: masterburner
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Fri Sep 01, 2006 3:31 am
- Post datetime: 2006-11-07T21:16:47+00:00
- Post Title: 

good that i have the old 0.27 Data.wz    with the mapdump
## Post #229
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2006-12-07T04:35:34+00:00
- Post Title: 

Now it really doesn't work due to some issues in the new patch
## Post #230
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-01-11T21:09:25+00:00
- Post Title: 

I hadn't done much with this for a while since my comp died.  I went back to it recently to figure out the new problems.  I'm not going to provide code as they seem to have added this new encryption stuff to prevent it.  Coders out there can use what I say to figure it out I guess, but I'll leave it at that.

Global:
They added a new entry type to the directory structure.  I just seek past the unknown info, and all the files seem to break up properly.  It might be a comment or something, but skipping it doesn't break anything.

Korean:
They changed the way strings are encoded.  Everything works essentially the same.  Previously, it was start with key=0xAA, then increment to find the next key.  Now the initial key is different, and I haven't managed to figure out the pattern to get the next one yet.

After I got that part working again, I tried extracting the directory structure again.  All the files seem to be out of order.  I'm not sure if that was there before, but I'm guessing it's supposed to make figuring out the string encryption more difficult.

For example in the sound folder the files are found in this order (rather than alphabetically):
Bgm14.img
Bgm01.img
Bgm13.img
Bgm07.img
Bgm12.img
Pet.img
Bgm06.img
UI.img
BgmTH.img
etc...
## Post #231
- Username: baomizhu
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sun Jan 14, 2007 5:22 pm
- Post datetime: 2007-01-18T11:38:55+00:00
- Post Title: 

> ......
## Post #232
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-01-18T16:56:44+00:00
- Post Title: 

Don't use cave speak please. Well generally it seems the reason encryptions are made is to protect their files. But it is also kinda silly to be so protective if you own the copywrights to the files anyways. So if they steal them and claim them as their own they can just sue them.
## Post #233
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2007-01-23T00:22:16+00:00
- Post Title: 

> Reply from Omega
>
> I hadn't done much with this for a while since my comp died.  I went back to it recently to figure out the new problems.  I'm not going to provide code as they seem to have added this new encryption stuff to prevent it.  Coders out there can use what I say to figure it out I guess, but I'll leave it at that.

Global:
They added a new entry type to the directory structure.  I just seek past the unknown info, and all the files seem to break up properly.  It might be a comment or something, but skipping it doesn't break anything.

Korean:
They changed the way strings are encoded.  Everything works essentially the same.  Previously, it was start with key=0xAA, then increment to find the next key.  Now the initial key is different, and I haven't managed to figure out the pattern to get the next one yet.

After I got that part working again, I tried extracting the directory structure again.  All the files seem to be out of order.  I'm not sure if that was there before, but I'm guessing it's supposed to make figuring out the string encryption more difficult.

For example in the sound folder the files are found in this order (rather than alphabetically):
Bgm14.img
Bgm01.img
Bgm13.img
Bgm07.img
Bgm12.img
Pet.img
Bgm06.img
UI.img
BgmTH.img
etc...

Extracting in a different order is not a problem since you can use Windows to sort it alphabetically..
## Post #234
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2007-03-21T03:44:08+00:00
- Post Title: 

Is there any way to open up the .patch files that wizet releases to update data.wz?
## Post #235
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-03-21T20:14:38+00:00
- Post Title: 

> Reply from kiler
>
> Is there any way to open up the .patch files that wizet releases to update data.wz?
The only person I know who has done something like this is Rick, and from what I can tell, he patches the game files and then puts up the differences.

My guess is that the patch files contain only the differences, not the actual data.  For example, if some value is changed from 200 to 201, it will just say somethign like:
at position x change the value from 0 to 1

Short answer, no.
## Post #236
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-05-01T10:52:17+00:00
- Post Title: 

Hi, my first post here.

I want to ask, if someone tried to translate the Python script to some other language.
I writing a Object Pascal tool to view the .wz files (so some kind of a "wz Explorer").

But as I'm not good in Python I'd like to know if someone created a general overview about the wz file format. (Reverse Engeneering a code of a programming language you don't know is really hard...)

Header reading is no problem.
PNG routines will need some work, but you described the way in the first few posts of the thread, so that won't be too hard.

Problems will come up on the String encryption and the zlib stuff. If I got this right, the strings are Unicode strings, aren't they? Object pascal is not very "Unicode ready"... And I have to find a good zlib library to deal with the compression.

Did anybody try something like that in any other language beside Python? I will do it in Object Pascal (I use Lazarus with FPC), but some code snippets in C would help me, too. (I have more experience in C than in Python  )

As far as I know, Rick wrote his tool in C++. (I saw him posting a screenshot a while ago)
## Post #237
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-03T04:44:32+00:00
- Post Title: 

> Reply from kolli
>
> Hi, my first post here.

I want to ask, if someone tried to translate the Python script to some other language.
I writing a Object Pascal tool to view the .wz files (so some kind of a "wz Explorer").

But as I'm not good in Python I'd like to know if someone created a general overview about the wz file format. (Reverse Engeneering a code of a programming language you don't know is really hard...)

Header reading is no problem.
PNG routines will need some work, but you described the way in the first few posts of the thread, so that won't be too hard.

Problems will come up on the String encryption and the zlib stuff. If I got this right, the strings are Unicode strings, aren't they? Object pascal is not very "Unicode ready"... And I have to find a good zlib library to deal with the compression.

Did anybody try something like that in any other language beside Python? I will do it in Object Pascal (I use Lazarus with FPC), but some code snippets in C would help me, too. (I have more experience in C than in Python  )

As far as I know, Rick wrote his tool in C++. (I saw him posting a screenshot a while ago)
I've seen one in delphi, and C/C++.  There are two types of strings if you check through the code.  One set are standard ascii, other are unicode (two bytes).  use zlib itself for decompression, though pascal might have it built in somewhere.
## Post #238
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-03T13:53:42+00:00
- Post Title: 

hmm i got virson 0.13.
i can uplaot it.
in this virson the "DefFnce" are wecker and it esier to hack Data.wz
0.13 GMS
## Post #239
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-09T07:29:41+00:00
- Post Title: 

I can't seem to extract MP3s from the archive. Uncommenting those in the dumpMp3 will make it extract nothing.
## Post #240
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-09T19:31:07+00:00
- Post Title: 

any pograsive have been done?
## Post #241
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-10T05:50:07+00:00
- Post Title: 

Any hints on extracting the SOUND.WZ?
## Post #242
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-14T11:33:22+00:00
- Post Title: 

Puplis what hapeen?
nobday is posting here anymore...
you all qhit?
## Post #243
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-16T00:17:57+00:00
- Post Title: 

Apart from the new tester encryption (which we aren't going to solve), there's really nothing left to do.  The necessary code has all been released.  There are some minor things which haven't been solved, but they rarely occur in the files.
## Post #244
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-16T14:26:44+00:00
- Post Title: 

> Reply from Omega
>
> Apart from the new tester encryption (which we aren't going to solve), there's really nothing left to do.  The necessary code has all been released.  There are some minor things which haven't been solved, but they rarely occur in the files.
huh?
nobday extraz more then 5% of the game O=
and can you giav me link to the most Extraz that have been realse.
and in the new virson maple had change the Data.wz to parts.
so can you giav me links to download fast virson with data.wz?
i am on gms.
## Post #245
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-17T04:12:18+00:00
- Post Title: 

> Reply from ninjalm
>
> Omega wrote:Apart from the new tester encryption (which we aren't going to solve), there's really nothing left to do.  The necessary code has all been released.  There are some minor things which haven't been solved, but they rarely occur in the files.
huh?
nobday extraz more then 5% of the game O=
and can you giav me link to the most Extraz that have been realse.
and in the new virson maple had change the Data.wz to parts.
so can you giav me links to download fast virson with data.wz?
i am on gms.
The info is all on sauna already (and strategywiki)  As for the parts stuff, just go through them one file at a time and it should work.  Figuring that out is up to you.  Also, please use a spell check.
## Post #246
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-17T10:20:56+00:00
- Post Title: 

ANY hints on the sounds and floor tiles? Omega?
## Post #247
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-17T11:20:51+00:00
- Post Title: 

> Reply from Omega
>
> ninjalm wrote:Omega wrote:Apart from the new tester encryption (which we aren't going to solve), there's really nothing left to do.  The necessary code has all been released.  There are some minor things which haven't been solved, but they rarely occur in the files.
huh?
nobday extraz more then 5% of the game O=
and can you giav me link to the most Extraz that have been realse.
and in the new virson maple had change the Data.wz to parts.
so can you giav me links to download fast virson with data.wz?
i am on gms.
The info is all on sauna already (and strategywiki)  As for the parts stuff, just go through them one file at a time and it should work.  Figuring that out is up to you.  Also, please use a spell check.
i download the pograme and the Pun.py but it doesnt work bcz i fhink it sut to Data.wz and theresnt anymore.
so it open for a sce and then exit.
pliz help me jast at the start and i will procerd alone.
## Post #248
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-17T14:35:01+00:00
- Post Title: 

Anyone? Sounds + floor tiles...
## Post #249
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-17T23:55:29+00:00
- Post Title: 

> Reply from AngelSL
>
> Anyone? Sounds + floor tiles...
As a quick answer, sounds can be played by just running the sound.wz file in media player (may have to rename to .mp3).

I think the actual mp3 extraction stuff is there in the dumpMp3 function, it's just commented out (get rid of the # symbols, but I can't promise anything)

As for the tiles.....it should work, but can you give me a specific file name?
## Post #250
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-18T09:47:19+00:00
- Post Title: 

Map.wz + Sound.wz
Anyway, the dumpMp3 doesn't work!
## Post #251
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-05-19T06:46:54+00:00
- Post Title: 

> Reply from ninjalm
>
> Omega wrote:ninjalm wrote:
huh?
nobday extraz more then 5% of the game O=
and can you giav me link to the most Extraz that have been realse.
and in the new virson maple had change the Data.wz to parts.
so can you giav me links to download fast virson with data.wz?
i am on gms.
The info is all on sauna already (and strategywiki)  As for the parts stuff, just go through them one file at a time and it should work.  Figuring that out is up to you.  Also, please use a spell check.
i download the pograme and the Pun.py but it doesnt work bcz i fhink it sut to Data.wz and theresnt anymore.
so it open for a sce and then exit.
pliz help me jast at the start and i will procerd alone.
HMM?
## Post #252
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-05-19T07:04:33+00:00
- Post Title: 

Hmmmm..........................very hard to decipher that message.
## Post #253
- Username: itg
- Rank: beginner
- Number of posts: 31
- Joined date: Sat May 12, 2007 10:11 pm
- Post datetime: 2007-05-19T07:34:05+00:00
- Post Title: 

Hm, guys can anyone tell me is a tool for this game done? (wont read 20 pages   I mean tool not some script or some thing else which searching for signatures, if no then Ill download that game, thnx.

_______________________________

Inside the game [http://int0thegame.blogspot.com/](http://int0thegame.blogspot.com/)
## Post #254
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-05-19T15:49:43+00:00
- Post Title: 

> Reply from itg
>
> Hm, guys can anyone tell me is a tool for this game done? (wont read 20 pages   I mean tool not some script or some thing else which searching for signatures, if no then Ill download that game, thnx.

_______________________________

Inside the game http://int0thegame.blogspot.com/
There is a tool. It's called mapledump. But it's on Korean (or Japanese or something like that). It's written in Delphi and it's closed source.
I think that this tool is just a "translation" of the Python Script as the output looks the same.

I wanted to write a Object Pascal Tool, too (With FPC and Lazarus). But I'm still having trouble to read the Python script... I know the general process of what the script does, but my Python knowledge is to small to fully understand it...
And another reason, why I am not coming further: It's hard to find all the needed functions and types for Object Pascal - zlib, all the datatypes, the basic file reading - just everything is different...

Anyone else made a script or a tool in another language and likes to share his knowledge?

If the script was at least in C, but Python? Why it had to be in Python?
Yes, it extracts all Images, fine. But it would be better to have a tool to browse the wz-files.
## Post #255
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-21T15:05:57+00:00
- Post Title: 

> Reply from kolli
>
> itg wrote:Hm, guys can anyone tell me is a tool for this game done? (wont read 20 pages   I mean tool not some script or some thing else which searching for signatures, if no then Ill download that game, thnx.

_______________________________

Inside the game http://int0thegame.blogspot.com/
There is a tool. It's called mapledump. But it's on Korean (or Japanese or something like that). It's written in Delphi and it's closed source.
I think that this tool is just a "translation" of the Python Script as the output looks the same.

I wanted to write a Object Pascal Tool, too (With FPC and Lazarus). But I'm still having trouble to read the Python script... I know the general process of what the script does, but my Python knowledge is to small to fully understand it...
And another reason, why I am not coming further: It's hard to find all the needed functions and types for Object Pascal - zlib, all the datatypes, the basic file reading - just everything is different...

Anyone else made a script or a tool in another language and likes to share his knowledge?

If the script was at least in C, but Python? Why it had to be in Python?
Yes, it extracts all Images, fine. But it would be better to have a tool to browse the wz-files.
The point was to figure out the file structure, and python is a very good language to quickly put together a prototype.  If you believe it's better to have a tool to browse the files, why don't you make one and release it?

Python is a very easy language to learn, and lambda didn't use anything too exotic to write the script (apart from zlib, but that's a standard dll).  If you have any questions, there are plenty of places to ask (here included).
## Post #256
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-22T05:55:26+00:00
- Post Title: 

Anyone? Sounds and the floor tiles.. OMEGA?
## Post #257
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-05-22T14:23:32+00:00
- Post Title: 

> Reply from Omega
>
> kolli wrote:itg wrote:Hm, guys can anyone tell me is a tool for this game done? (wont read 20 pages   I mean tool not some script or some thing else which searching for signatures, if no then Ill download that game, thnx.

_______________________________

Inside the game http://int0thegame.blogspot.com/
There is a tool. It's called mapledump. But it's on Korean (or Japanese or something like that). It's written in Delphi and it's closed source.
I think that this tool is just a "translation" of the Python Script as the output looks the same.

I wanted to write a Object Pascal Tool, too (With FPC and Lazarus). But I'm still having trouble to read the Python script... I know the general process of what the script does, but my Python knowledge is to small to fully understand it...
And another reason, why I am not coming further: It's hard to find all the needed functions and types for Object Pascal - zlib, all the datatypes, the basic file reading - just everything is different...

Anyone else made a script or a tool in another language and likes to share his knowledge?

If the script was at least in C, but Python? Why it had to be in Python?
Yes, it extracts all Images, fine. But it would be better to have a tool to browse the wz-files.
The point was to figure out the file structure, and python is a very good language to quickly put together a prototype.  If you believe it's better to have a tool to browse the files, why don't you make one and release it?

Python is a very easy language to learn, and lambda didn't use anything too exotic to write the script (apart from zlib, but that's a standard dll).  If you have any questions, there are plenty of places to ask (here included).
"If you want one why don't you make one?" - That's a really dumb argument. It's the same like "So, you want a Mercedes S Class? Why don't you built it yourself or why don't you earn all the money and buy it?"
You don't need to be able to make anything better to see that something is not perfect. If I could do it better I wouldn't ask but do it.

Yes, the goal was to find out the file structure. But I can't see it here. All I see is a Python script. People who don't know Python can't write a tool in another language. I could write a tool in Object Pascal (maybe also in C# .NET, what I am currently learning) - if I just could read the full Python script to find out the file structure.
It's not so much about the algorithms (loops, calculations, boolean operations etc.), they are almost the same in any language. But the problems for many people are the "Pythonish" stuff (e.g. the struct.pack and .unpack stuff, the string handling, file access is easier than in other languages, in my oppinion Python code is hard to read etc.)
So it's not possible to just "translate" the script.

That's why I asked if someone already made up a general, language independent overview about the file structure. That's all I need to write a tool.
## Post #258
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-23T03:26:44+00:00
- Post Title: 

> Reply from kolli
>
> Omega wrote:kolli wrote:
There is a tool. It's called mapledump. But it's on Korean (or Japanese or something like that). It's written in Delphi and it's closed source.
I think that this tool is just a "translation" of the Python Script as the output looks the same.

I wanted to write a Object Pascal Tool, too (With FPC and Lazarus). But I'm still having trouble to read the Python script... I know the general process of what the script does, but my Python knowledge is to small to fully understand it...
And another reason, why I am not coming further: It's hard to find all the needed functions and types for Object Pascal - zlib, all the datatypes, the basic file reading - just everything is different...

Anyone else made a script or a tool in another language and likes to share his knowledge?

If the script was at least in C, but Python? Why it had to be in Python?
Yes, it extracts all Images, fine. But it would be better to have a tool to browse the wz-files.
The point was to figure out the file structure, and python is a very good language to quickly put together a prototype.  If you believe it's better to have a tool to browse the files, why don't you make one and release it?

Python is a very easy language to learn, and lambda didn't use anything too exotic to write the script (apart from zlib, but that's a standard dll).  If you have any questions, there are plenty of places to ask (here included).
"If you want one why don't you make one?" - That's a really dumb argument. It's the same like "So, you want a Mercedes S Class? Why don't you built it yourself or why don't you earn all the money and buy it?"
You don't need to be able to make anything better to see that something is not perfect. If I could do it better I wouldn't ask but do it.

Yes, the goal was to find out the file structure. But I can't see it here. All I see is a Python script. People who don't know Python can't write a tool in another language. I could write a tool in Object Pascal (maybe also in C# .NET, what I am currently learning) - if I just could read the full Python script to find out the file structure.
It's not so much about the algorithms (loops, calculations, boolean operations etc.), they are almost the same in any language. But the problems for many people are the "Pythonish" stuff (e.g. the struct.pack and .unpack stuff, the string handling, file access is easier than in other languages, in my oppinion Python code is hard to read etc.)
So it's not possible to just "translate" the script.

That's why I asked if someone already made up a general, language independent overview about the file structure. That's all I need to write a tool.
I'll answer your questions in order:
"Anyone else made a script or a tool in another language and likes to share his knowledge?" done, but i'm not sharing code, though I can tell how it works
"If the script was at least in C, but Python? Why it had to be in Python? " that's what I answered above.
If you want the answer that goes with your mercedes allegory, you can pay someone to make it for you.
Now, if you have specific questions, I'm willing to help.
@AngelSL: I'm kinda short on time in general, so can't really look at the code, but is there an error message (are you running it from the command prompt?)?  Are you running the program directly on sound.wz?
## Post #259
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-24T05:34:12+00:00
- Post Title: 

Error:
D:\MapleStory\Dump_Store\Sound>Extractor.py
   0: /Bgm00.img, 7430599, 922
Traceback (most recent call last):
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 589, in <module>
    dump()
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 570, in dump
    vals = dumpFile(f, file["Name"], file["Offset"])
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 537, in dumpFile
    value = dumpEntryValue(f, str(name), baseOffset)
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 522, in dumpEntryValu
e
    elif (type == 0x09): return extract09type(f, name, baseOffset)
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 411, in extract09type

    result = dumpBlock(f, name, baseOffset, f.tell() + size)
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 510, in dumpBlock
    elif (type == 0x73): return extract73type(f, name, baseOffset, endOfBlock)
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 499, in extract73type

    dumpMp3(f, size, endOfBlock)
  File "D:\MapleStory\Dump_Store\Sound\Extractor.py", line 238, in dumpMp3
    g = open("%d.mp3" % mp3count, "wb")
UnboundLocalError: local variable 'mp3count' referenced before assignment

Anyway, if I put mp3count = 0 in the start of the dumpMp3 block, then it just extracts ONE mp3.
## Post #260
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-24T19:22:59+00:00
- Post Title: 

try this:

```
  startOfMP3 = endOfBlock - size
  remaining = startOfMP3 - f.tell()
  unknown = f.read(remaining)
  g = open("%d.mp3" % remaining, "wb")
  g.write(f.read(size))
  g.close()
  f.seek(endOfBlock)

```

filenames will be pretty ugly, and it may not work on older computers, but it should work....
## Post #261
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-25T04:17:50+00:00
- Post Title: 

That only extracted 3 sounds, 1 throwing star, 1 arrow shot, and one other silent sound. The rest were just htmls..
## Post #262
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-27T15:53:16+00:00
- Post Title: 

I hate to bump this, but Sound.wz is the only barrier that blocks me from releasing 00042 extract of MapleSEA
## Post #263
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-28T02:16:43+00:00
- Post Title: 

> Reply from AngelSL
>
> That only extracted 3 sounds, 1 throwing star, 1 arrow shot, and one other silent sound. The rest were just htmls..
Are there more error messages?
## Post #264
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-29T00:21:14+00:00
- Post Title: 

No. No errors. But they only extract 3
Still, the floor tiles aren't in Map.wz... Anyone know where it is?
## Post #265
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-05-30T02:27:23+00:00
- Post Title: 

> Reply from AngelSL
>
> No. No errors. But they only extract 3
Still, the floor tiles aren't in Map.wz... Anyone know where it is?
Which floor tiles? They seem to be in sub folders of Map.wz/Tile/

And if there are no more errors, the problem is probably deeper than what I can solve right now.
## Post #266
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-05-30T04:31:32+00:00
- Post Title: 

Theres no Tile folder!
EDIT: Found out why. Theres an error right after it tries to extract the Tiles.
Its something like:
Unknown: 115 Expecting: 15 or something.
## Post #267
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-06-05T03:17:53+00:00
- Post Title: 

> Reply from AngelSL
>
> Theres no Tile folder!
EDIT: Found out why. Theres an error right after it tries to extract the Tiles.
Its something like:
Unknown: 115 Expecting: 15 or something.
That means that there is a bug somewhere in the decoding....it might be that it's expecting a 0x1B block, but getting something else, or vice versa...

Maybe someone else can provide a solution? (too deep an error for me to solve)
## Post #268
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-06-14T12:29:12+00:00
- Post Title: 

Omega why cant you share you files you have exetraded?
## Post #269
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-06-16T02:59:47+00:00
- Post Title: 

> Reply from ninjalm
>
> Omega why cant you share you files you have exetraded?
Easy answer, because I choose to.  Long answer, it contains the code to decode the new kmst encryption, and I don't have the time to rip it out.  Soon after we figured the regular version out, they changed to this new encryption.  I'd rather not have to figure out a new encryption scheme.
## Post #270
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-06-16T09:54:20+00:00
- Post Title: 

> Reply from Omega
>
> ninjalm wrote:Omega why cant you share you files you have exetraded?
Easy answer, because I choose to.  Long answer, it contains the code to decode the new kmst encryption, and I don't have the time to rip it out.  Soon after we figured the regular version out, they changed to this new encryption.  I'd rather not have to figure out a new encryption scheme.
so can you jast upload the files you extraded?
to a srver?
put it all in rar put it in srver to the night and in the morning share the link?
---
and can you tell me your msn?
## Post #271
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-06-19T02:05:19+00:00
- Post Title: 

Anyone helping me?! Sighh..
## Post #272
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-06-24T21:59:31+00:00
- Post Title: 

i changed the code a little bit
now it extract mp3 files and it skips two files that cause problems in Map.wz
so it extract the Tile folder
[dump.zip](https://xentaxbackup.github.io/file/1235_dump.zip)
## Post #273
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-06-26T12:15:15+00:00
- Post Title: 

No, it still does not extract the Tile folder.
## Post #274
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-06-26T14:11:05+00:00
- Post Title: 

The error is:
...
...
1177: /Obj/NightMarketTW.img, 2738050, 134668320
1178: /Obj/SeoMoonJungTW.img, 2323918, 137406370
Unknown: 115                  : Expecting: 27
Error                         : Default Error
FileLocation                  : 137406511L

D:\MapleStory\Dump\Map>
## Post #275
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-06-26T14:25:47+00:00
- Post Title: 

oh, you tried it on another version
ok
this should work
[dump.zip](https://xentaxbackup.github.io/file/1236_dump.zip)
## Post #276
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2007-06-26T22:50:41+00:00
- Post Title: 

Erm... whats with this?!

1177: /Obj/NightMarketTW.img, 2738050, 134668320
1178: /Obj/SeoMoonJungTW.img, 2323918, 137406370
Incomplete Block [Subway/wall/0/0/foothold] at offset 137406475, size: 1061, loc: 137406476

D:\MapleStory\Dump\Map>
## Post #277
- Username: cyg
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sat Jun 10, 2006 4:26 am
- Post datetime: 2007-06-29T17:34:46+00:00
- Post Title: 

hi guys
i haven't browsed this forum for a while, but i will reread all the pages soon.

but basically has anyone got a good doc on the format yet? or do i have to piece together a lot of the info

i know the format has changed a bit since around v37 or so of global with the file splitting.

basically i will be writing a c implementation of the extractor to extract everything i am able to figure out (or what has been figured out by other people), yes it will be released.
## Post #278
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-06-29T18:22:56+00:00
- Post Title: 

> Reply from cyg
>
> hi guys
i haven't browsed this forum for a while, but i will reread all the pages soon.

but basically has anyone got a good doc on the format yet? or do i have to piece together a lot of the info

i know the format has changed a bit since around v37 or so of global with the file splitting.

basically i will be writing a c implementation of the extractor to extract everything i am able to figure out (or what has been figured out by other people), yes it will be released.
hi what is ur msn?
AND can somu1 realse Dump for Image?
i only get the Sounds.
## Post #279
- Username: baomizhu
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sun Jan 14, 2007 5:22 pm
- Post datetime: 2007-07-01T14:07:55+00:00
- Post Title: 

```

```
## Post #280
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-07-01T18:50:30+00:00
- Post Title: 

was that code for me?
if yes it doesnt work.
i am using the latest Patch on gMs.
FILE D:NEXON/MAPLESTORY/DUMP.PY LINE 47 IN MODLE
DUMP()
ILE D:NEXON/MAPLESTORY/DUMP.PY LINE 7 IN DUMP
SAFE_MDKI(DUMPDIRBASE)
NAMEERORE
Global Name 'safe_nmdir' is not Difend
## Post #281
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-03T02:39:48+00:00
- Post Title: 

> Reply from cyg
>
> hi guys
i haven't browsed this forum for a while, but i will reread all the pages soon.

but basically has anyone got a good doc on the format yet? or do i have to piece together a lot of the info

i know the format has changed a bit since around v37 or so of global with the file splitting.

basically i will be writing a c implementation of the extractor to extract everything i am able to figure out (or what has been figured out by other people), yes it will be released.
The format is essentially the same, just that the first level is stored in Base.wz and the rest are stored in the files.  Each file.wz corresponds to a "folder" in Base.wz.  Just use whatever is the latest version of the code to make it.
## Post #282
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-05T08:47:03+00:00
- Post Title: 

Hi,

it's me again.
I made some progress with my wz viewer.
Now I understand Python better, so it's easier for me to write routines in other languages.

But I have a big problem on the directory tree in Map.wz. For first testings I extract it and save the file structure like a normal directory (like "C:\Windows\System" --> "Item.wz\Cash\1234.img").
This works fine on all wz files, but only the map.wz makes problems.
It extracts the structure for "Map.wz\[all subfolders]" correct. But the *.img files are always in a wrong subfolder. The WorldMap0.img and WorldMap1.img should be in "Map.wz\WorldMap", but for me they are in "Map.wz\Map\Map9".
Also some other *.img files are wrong in Map.wz. And some gibberish folders appear (not sure if they really are in the map.wz, but I believe not).
I used recursion, similar to the one in dump.py, but made a little changes.
It works for al wz-files correct, but not for map.wz.

Can someone please explain, how the directory in map.wz are build up?

edit: I found the bug that produced the gibberish folders. But still the structure for Map.wz is not correct. It finds all *.img files and all subolders. But some img's are in the wrong subfolder.

I use a similar recursion like in the Python script. As long as there are "type 3" folders the directory tree gets extracted with the last parent directory (in py-script the parent is called basename). This works for all wz files, but not for Map.wz (where it finds all folders and img's but in the wrong order).

edit2:
OK, forget all my worries.  I managed to display the folder correctly. I still do not understand fully why it works now, but perhaps this has something to do with a Python specific thing that I didn't knew....
The array in which I store all the directories has always to be sorted alphabetically.

Now I have to go for the hard part: finding out, how to extract the filenames from the actual files (mp3, png, txt, etc) without extracting the whole file.
Is there any general way of how the files are stored?
It seems not like the directories, but different for every type of file that exists. For example, the name of a PNG file has to be extracted differently like one from a txt file.
## Post #283
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-06T03:46:53+00:00
- Post Title: 

> Reply from kolli
>
> Hi,

it's me again.
I made some progress with my wz viewer.
Now I understand Python better, so it's easier for me to write routines in other languages.

But I have a big problem on the directory tree in Map.wz. For first testings I extract it and save the file structure like a normal directory (like "C:\Windows\System" --> "Item.wz\Cash\1234.img").
This works fine on all wz files, but only the map.wz makes problems.
It extracts the structure for "Map.wz\[all subfolders]" correct. But the *.img files are always in a wrong subfolder. The WorldMap0.img and WorldMap1.img should be in "Map.wz\WorldMap", but for me they are in "Map.wz\Map\Map9".
Also some other *.img files are wrong in Map.wz. And some gibberish folders appear (not sure if they really are in the map.wz, but I believe not).
I used recursion, similar to the one in dump.py, but made a little changes.
It works for al wz-files correct, but not for map.wz.

Can someone please explain, how the directory in map.wz are build up?

edit: I found the bug that produced the gibberish folders. But still the structure for Map.wz is not correct. It finds all *.img files and all subolders. But some img's are in the wrong subfolder.

I use a similar recursion like in the Python script. As long as there are "type 3" folders the directory tree gets extracted with the last parent directory (in py-script the parent is called basename). This works for all wz files, but not for Map.wz (where it finds all folders and img's but in the wrong order).

edit2:
OK, forget all my worries.  I managed to display the folder correctly. I still do not understand fully why it works now, but perhaps this has something to do with a Python specific thing that I didn't knew....
The array in which I store all the directories has always to be sorted alphabetically.

Now I have to go for the hard part: finding out, how to extract the filenames from the actual files (mp3, png, txt, etc) without extracting the whole file.
Is there any general way of how the files are stored?
It seems not like the directories, but different for every type of file that exists. For example, the name of a PNG file has to be extracted differently like one from a txt file.
All the file names for mp3's are stored separately in one of the strings files.  File names on the other hand are stored right along with the .img file.  Note that 0x01 and 0x02 always hold this name (IIRC, haven't looked at the code in a while).  0x1B and 0x79 hold images/audio, 0x9/0x8 hold blocks within them, and the rest just hold single values (or something close to that).  I haven't figured out exactly what all the info around the mp3 files are, but they play fine all the same.  I'm not so sure about the alphabetical sorting, but all the folders are in order.
ex, 
file a, file b. folder 1
file c, folder 4, folder 5
folder 6
would turn into
file a
file b
folder 1
-file c
-folder 4
--folder 6
-folder 5

Not sure if that clears anything up, or if they started shuffling things around more than before, but it still seems to work on the latest GMS data file.

Hope that helps
## Post #284
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-07-06T04:57:37+00:00
- Post Title: 

Hi! I'm back! Remember me from page.. 4?

Anyways, I see there's still progress to be made. I don't play MapleStory anymore, so I've quit the extracting business. 

So.. just some words of encouragement: good luck xDD
## Post #285
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-06T15:09:18+00:00
- Post Title: 

I'm making large steps in extracting the file tree.

But I have one more question:

On some point (in extract73type() when iname is "UOL") in the Python script you use a function "computeName". and at this point for the output you have a string with the content "image*" and the cumputed name.
What type is this? Is this an image or a MP3 (because it seems only to appear in Sound.wz)?

edit: The whole structure of the *.img does not go into my head...
Is the structure of the imgs the same as the folder structure?
The folder structure is like: [all level0 folders, sorted alphabetically] [all level1 folders, s. alph.] [all level2 folders, s. alph.] And every subfolder as a byte that tells us, how many there are --> easy recursion.

Is this the same in the imgs for the PNGs, MP3s and other type (numbers, text, etc) files?
Are the imgs build up in a way for that we can use an easy recursion?
## Post #286
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-07T00:01:18+00:00
- Post Title: 

> Reply from kolli
>
> I'm making large steps in extracting the file tree.

But I have one more question:

On some point (in extract73type() when iname is "UOL") in the Python script you use a function "computeName". and at this point for the output you have a string with the content "image*" and the cumputed name.
What type is this? Is this an image or a MP3 (because it seems only to appear in Sound.wz)?

edit: The whole structure of the *.img does not go into my head...
Is the structure of the imgs the same as the folder structure?
The folder structure is like: [all level0 folders, sorted alphabetically] [all level1 folders, s. alph.] [all level2 folders, s. alph.] And every subfolder as a byte that tells us, how many there are --> easy recursion.

Is this the same in the imgs for the PNGs, MP3s and other type (numbers, text, etc) files?
Are the imgs build up in a way for that we can use an easy recursion?
That compute name just goes back up the directory structure to figure out what the location of the image is so that it gets a unique name (or something like that) I don't think it's that necessary.

each .wz is divided into folders which contain .img files.  Each .img contains multiple blocks.  There are 3 "types" of blocks.  Name blocks, value blocks, and content blocks (my terms...)  name blocks = 0x00 and 0x01, content blocks = 0x79, 0x1b, and the rest are value blocks (I classify 0x09/08 as value even though they are really just containers for blocks).  Essentially you can  have multiple pictures within each .img.  It's somewhat recursive, it's just that you go between three different functions.
## Post #287
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-07T12:59:49+00:00
- Post Title: 

But the "pictures" with computeName thing are no pictures. I wanted to know what this is.
If you extract the Sound.wz, you have a lot of this stuff, for example:
1012000.1.Hit.image*	1012000/0/Hit
1012000.2.Hit.image*	1012000/0/Hit
1012000.3.Hit.image*	1012000/0/Hit

There are no pictures, only these strings.

And for the recursion:
Yes, it is an recursion, I just wanted to know if someone found a easier one. Or if someone could explain, how exactly the imgs are built up.

Is it like:
0001.img
- name1(0x00 or 0x01) with content1(0x73 or 0x1B)
- name2(0x00 or 0x01) with content2(0x73 or 0x1B)
- name3(0x00 or 0x01) with content3(0x08 or 0x09)
--subname1(0x00 or 0x01) with subcontent1(0x73 or 0x1B)
--subname2(0x00 or 0x01) with subcontent2(0x73 or 0x1B)
- name4(0x00 or 0x01) with content4(0x08 or 0x09)

Or did I mixed up (0x73 or 0x1B) with (0x08 or 0x09)?

And is a "block" (how you call it) already the file (like png or mp3)? Or is the "entryValue" the file?
## Post #288
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-07T16:19:22+00:00
- Post Title: 

> Reply from kolli
>
> But the "pictures" with computeName thing are no pictures. I wanted to know what this is.
If you extract the Sound.wz, you have a lot of this stuff, for example:
1012000.1.Hit.image*	1012000/0/Hit
1012000.2.Hit.image*	1012000/0/Hit
1012000.3.Hit.image*	1012000/0/Hit

There are no pictures, only these strings.

And for the recursion:
Yes, it is an recursion, I just wanted to know if someone found a easier one. Or if someone could explain, how exactly the imgs are built up.

Is it like:
0001.img
- name1(0x00 or 0x01) with content1(0x73 or 0x1B)
- name2(0x00 or 0x01) with content2(0x73 or 0x1B)
- name3(0x00 or 0x01) with content3(0x08 or 0x09)
--subname1(0x00 or 0x01) with subcontent1(0x73 or 0x1B)
--subname2(0x00 or 0x01) with subcontent2(0x73 or 0x1B)
- name4(0x00 or 0x01) with content4(0x08 or 0x09)

Or did I mixed up (0x73 or 0x1B) with (0x08 or 0x09)?

And is a "block" (how you call it) already the file (like png or mp3)? Or is the "entryValue" the file?
Those are definately not in sound.wz....Those look more like reactor.wz.

I haven't looked if there was a set order in the files, though there probably is.  Some blocks are "interchangeable".  For example, the only entry in a 0x08 will always be a "Name" block (so 0x00 or 0x01).  Other locations will have either a 0x1b or 0x73. The third location will either have either 0x00, 0x02, 0x03, 0x04, 0x05, 0x08, or 0x09.

All files do have a "standard" structure.  Each will first have a short header (check the py file for what that is) then a number telling how many subblocks.  Each of these subblocks has a name and then info block (0x02 - 0x09 group).  Each of those info blocks can then have subblocks and you have to figure out what they are by reading the first byte of the block.

Do you have a specific .img you need help with?
## Post #289
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-07T16:34:23+00:00
- Post Title: 

Thank you. I don't have problems with a specific img file. I just want to figure out the general structure. Because the python code looks very complex (even if it only is a rather simple recursion). I try to make a simplier one. Because I don't think that the inventor of the file structure made the structure complex on purpose (the MapleStory client must be able to access the wz files fast, so there must be a simplier way).

But I think I can work with your explaination for the time being. (but any further information is still welcome )

edit, I looked it up: These image* are in sound.wz\reactor.img

edit 2: does each subblock also have a name?
## Post #290
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-07T18:22:51+00:00
- Post Title: 

> Reply from kolli
>
> Thank you. I don't have problems with a specific img file. I just want to figure out the general structure. Because the python code looks very complex (even if it only is a rather simple recursion). I try to make a simplier one. Because I don't think that the inventor of the file structure made the structure complex on purpose (the MapleStory client must be able to access the wz files fast, so there must be a simplier way).

But I think I can work with your explaination for the time being. (but any further information is still welcome )

edit, I looked it up: These image* are in sound.wz\reactor.img

edit 2: does each subblock also have a name?
Oh, I see which you are talking about.  Didn't realize that code was used elseewhere.  

UOL code means that the actual data is stored elsewhere.  For example in 1012000, it has 0, 1, 2, 3, 4
0/Hit contains an MP3
1 to 3/Hit contains a "link"
They each contain the text "../0/Hit" meaning that they use the same mp3 as 0/Hit.

Most subblocks have names, there are some which don't, though I can't remember where exactly.
## Post #291
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-08T10:08:45+00:00
- Post Title: 

Ah, I see.

Now I have a question about the data types you are using:
Some numbers you read as signed 32 bit integers, some as unsigned. What tells you what type they are? A signed integer could have the adress up to 2 Gigabyte, but none of the wz files goes even over one Gigabyte.

I only use 32 bit signed integers to store the numbers (when it comes to values with 64 bit floats, I convert them directly to string, but for adressing positiosn in the file should signed 32 integer be enough).

edit: one more question:
Did someone already found out what some (or all) of the "unknown" bytes are used for?
Could the two bytes after the header be saying how much "type 3" directorys there are (in all wz files together)?

edit2: Does someone has Europe MapleStory? Do they already have the splited wz files or do they still have the Data.wz?

edit3: I just noticed that in the Python script: in extract00type you read the size. Isn't that a packnum? At least it seems that the beginning of the function does the same as packnum.
## Post #292
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-10T04:12:49+00:00
- Post Title: 

> Reply from kolli
>
> Ah, I see.

Now I have a question about the data types you are using:
Some numbers you read as signed 32 bit integers, some as unsigned. What tells you what type they are? A signed integer could have the adress up to 2 Gigabyte, but none of the wz files goes even over one Gigabyte.

I only use 32 bit signed integers to store the numbers (when it comes to values with 64 bit floats, I convert them directly to string, but for adressing positiosn in the file should signed 32 integer be enough).

edit: one more question:
Did someone already found out what some (or all) of the "unknown" bytes are used for?
Could the two bytes after the header be saying how much "type 3" directorys there are (in all wz files together)?

edit2: Does someone has Europe MapleStory? Do they already have the splited wz files or do they still have the Data.wz?

edit3: I just noticed that in the Python script: in extract00type you read the size. Isn't that a packnum? At least it seems that the beginning of the function does the same as packnum.
The choice of data type was mostly arbitrary, whatever worked.  Some of them I'm not too sure about (for example 0x02 and 0x04) but if the numbers come out right, it must be right (I haven't verified)

I highly doubt it's the number of directories, since that number seemed to change a lot between versions.

No idea about EMS, it's been a while.

They look pretty close so you might be right.  I'd suggest you try it out and see what happens.  The only part that seems to mess with it is the extra check if it's positive or negative for unicode strings.
## Post #293
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-10T09:39:02+00:00
- Post Title: 

EMS has already the splitted wz files, I found out. I was hoping to find a Data.wz to have the pieces put all together (makes the analysing much more easier).

I thought about the packnum/00type again. The first part is a packnum, it works. But if it comes to the unicode part it does not work (I think it is because the whole function had to be changed, what I didn't tried until now).
But as we are now on the 00type: I still don't fully understand why you store some strings in this "previousStrings" array. Are these again something like you called a "link"? It seems these things only exist in the file tree (only do this if parsingFileTree is true)?

edit6 (I deleted edits 1 to 5 because the ideas were wrong):
Does it ever occur that the negative value of packnum is used?
I mean, when the byte is -128 a 32bit integer is read. But what if it is smaller than 0 and larger than -128? Are these numbers used anywhere? In extract00type they are made positive (size = -size) and all other must be positive (because there are no  images with a "negative size")

I'll try something out in this direction. Because I am still certain that the wz files are build up with "Occam's razor" in mind (if both of two ideas work, the easier one is the correct one).

edit7: No, as far I can see this, this never occurs, that a value between -128 and 0 (excluding these two) comes up. I'll try to change the packnum function so that it only gives out either positive signed bytes ( >= 0 < 128 ) or the 32 bit signed integer.
Maybe this solves the MP3 problem where some MP3s aren't read. Because there I see the only part where negative values of packnum could infect the output because the size of a MP3 could be negative with the current python code. I'll try that.

edit8:
I tried to change the extract00type. But the longer I think about it the harder it gets...
If the first size in extract00type is a packnum nothing changes. That's all because of the Unicode part with the extra if clauses...
I think, we have to find a way around the previousStrings thing (what I still did not fully understand until now) and then we can just ask if it's unicode or not (size = packnum, if size == 127 read Unicode, else read normal string).
## Post #294
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-11T02:35:40+00:00
- Post Title: 

> Reply from kolli
>
> EMS has already the splitted wz files, I found out. I was hoping to find a Data.wz to have the pieces put all together (makes the analysing much more easier).

I thought about the packnum/00type again. The first part is a packnum, it works. But if it comes to the unicode part it does not work (I think it is because the whole function had to be changed, what I didn't tried until now).
But as we are now on the 00type: I still don't fully understand why you store some strings in this "previousStrings" array. Are these again something like you called a "link"? It seems these things only exist in the file tree (only do this if parsingFileTree is true)?

edit6 (I deleted edits 1 to 5 because the ideas were wrong):
Does it ever occur that the negative value of packnum is used?
I mean, when the byte is -128 a 32bit integer is read. But what if it is smaller than 0 and larger than -128? Are these numbers used anywhere? In extract00type they are made positive (size = -size) and all other must be positive (because there are no  images with a "negative size")

I'll try something out in this direction. Because I am still certain that the wz files are build up with "Occam's razor" in mind (if both of two ideas work, the easier one is the correct one).

edit7: No, as far I can see this, this never occurs, that a value between -128 and 0 (excluding these two) comes up. I'll try to change the packnum function so that it only gives out either positive signed bytes ( >= 0 < 128 ) or the 32 bit signed integer.
Maybe this solves the MP3 problem where some MP3s aren't read. Because there I see the only part where negative values of packnum could infect the output because the size of a MP3 could be negative with the current python code. I'll try that.

edit8:
I tried to change the extract00type. But the longer I think about it the harder it gets...
If the first size in extract00type is a packnum nothing changes. That's all because of the Unicode part with the extra if clauses...
I think, we have to find a way around the previousStrings thing (what I still did not fully understand until now) and then we can just ask if it's unicode or not (size = packnum, if size == 127 read Unicode, else read normal string).
I think the whole previousStrings code is completely useless.  IIRC lambda was trying to store all the previous strings since they are sometimes reused, however it's easier just to get them directly.

semipseudocode:

```
if 0x01 - read u32 (actual string location)
    save current location
    seek to actual string location (don't remember if it's relative or absolute)
    read the string
    seek back to saved location

```


```
if <= 0 
  if - 128 read u32
  if <0 size = -size
  read size bytes and decode it
if >0
  if 127 read u32
  read size bytes and decode

```

and decode is just the basic xor thing
## Post #295
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-11T08:31:49+00:00
- Post Title: 

If I change the prevString code so that it just returns what it has read from the file (and not from the saved array) it finds a 01072279.img in Weapon and in Shoes in Character.wz.
But opposed to your example code at this point I'm not seeking in the file, just reading sequentially.

With the prevstring code, this img is only in shoes.

The only other wz file where this code is used is Map.wz. But I did not check what it finds/finds not in there.

It seems that the whole prevstring code is not really working properly. I'll try to remove it and just read from the file directly.

edit1: At some earlier point in this thread it was said that strings are always smaller than 256 characters. Was this proven false? Or was this only for the directory tree? Because if all strings are shorter than 256 characters, all the checks followed by 4 byte size reading if they have a specific value are useless (what would lead to a much simplier function).

edit2: also in extract00type, there is this if(size == 1). What is that for? Does strings with only one char exist in the wz files? Does it check if it's unicode or not?

I am currently trying to reduce the extract00type to something like this:

```
transStr(read(size))

```


But I am not an Unicode expert. Is there anything to check if a string is Unicode or not? Because this must be clear, if it's Unicode we have to read(size*2), if it's only ASCII string we have to read(size).

And what about the subsize? If I see this right that sequence is like
[0xXX 0x80 byte,byte,byte,byte] in the longest case, but is always followed by a string.

edit3: I made some researching on string storing:
There is this class called BinaryReader. Don't know if this is part of the WinAPI or if this is just randomly in the common libraries of the languages, but many languages have it.
This class has a method "ReadString()". It reads a sequence of bytes and returns a String. It has no parameters. The length of the String is stored in "7-Bit bytes" before the actual string. Like in the wz files.
If the first Bit of the byte is set (0x80), the next byte is read, too. That goes on until the first bit of a byte is 0.
Then all of the read bytes are added --> you have the size. That's even better than our "packnum".
If Wizet used this method for the strings in wz files it's actually pretty easy to read the strings (no "if if if else if if if else if else" stuff anymore).

And if the Unicode is UTF-8 we also solved the problem with "size*2".

I'll try around with that a bit. If it works this will be a large step in reading the strings. Then the functions transStr, tranStr16, extract00type, extract00typeAt, rUStr and rUStrAt could be combined to a small function called "readStr".

edit4: I tried it --> didn't worked. But I think Wizet used a similar encoding. The if(size = 127) makes me mad... Why is it suddenly 127 and not 128 anymore? I don't get Wizets ideas...
On the one hand they tried to store values as compact as possible (packnum), but on the other hand they build in these unlogical (at least to me) things...
## Post #296
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-12T01:22:37+00:00
- Post Title: 

> Reply from kolli
>
> If I change the prevString code so that it just returns what it has read from the file (and not from the saved array) it finds a 01072279.img in Weapon and in Shoes in Character.wz.
But opposed to your example code at this point I'm not seeking in the file, just reading sequentially.

With the prevstring code, this img is only in shoes.

The only other wz file where this code is used is Map.wz. But I did not check what it finds/finds not in there.

It seems that the whole prevstring code is not really working properly. I'll try to remove it and just read from the file directly.

edit1: At some earlier point in this thread it was said that strings are always smaller than 256 characters. Was this proven false? Or was this only for the directory tree? Because if all strings are shorter than 256 characters, all the checks followed by 4 byte size reading if they have a specific value are useless (what would lead to a much simplier function).

edit2: also in extract00type, there is this if(size == 1). What is that for? Does strings with only one char exist in the wz files? Does it check if it's unicode or not?

I am currently trying to reduce the extract00type to something like this:
Code: Select allsize = packnum
transStr(read(size))


But I am not an Unicode expert. Is there anything to check if a string is Unicode or not? Because this must be clear, if it's Unicode we have to read(size*2), if it's only ASCII string we have to read(size).

And what about the subsize? If I see this right that sequence is like
[0xXX 0x80 byte,byte,byte,byte] in the longest case, but is always followed by a string.

edit3: I made some researching on string storing:
There is this class called BinaryReader. Don't know if this is part of the WinAPI or if this is just randomly in the common libraries of the languages, but many languages have it.
This class has a method "ReadString()". It reads a sequence of bytes and returns a String. It has no parameters. The length of the String is stored in "7-Bit bytes" before the actual string. Like in the wz files.
If the first Bit of the byte is set (0x80), the next byte is read, too. That goes on until the first bit of a byte is 0.
Then all of the read bytes are added --> you have the size. That's even better than our "packnum".
If Wizet used this method for the strings in wz files it's actually pretty easy to read the strings (no "if if if else if if if else if else" stuff anymore).

And if the Unicode is UTF-8 we also solved the problem with "size*2".

I'll try around with that a bit. If it works this will be a large step in reading the strings. Then the functions transStr, tranStr16, extract00type, extract00typeAt, rUStr and rUStrAt could be combined to a small function called "readStr".

edit4: I tried it --> didn't worked. But I think Wizet used a similar encoding. The if(size = 127) makes me mad... Why is it suddenly 127 and not 128 anymore? I don't get Wizets ideas...
On the one hand they tried to store values as compact as possible (packnum), but on the other hand they build in these unlogical (at least to me) things...
All the previousstring stuff is rubbish and not needed.

Not too sure what your example was saying, you'll have to be more specific.

Dunno about that <256 length thing, I think they can be as long as they need to be.

Add a message for that size==1 thing and see if it's ever run.  I don't think I have it.

I'll have to look into that binary reader thing, sounds cool.

Except for that size==127, there is no way to tell the difference.  Unicode takes two bytes per character, regular takes 1 byte per character.

Just to note that -128=0x80, 127=0x79, they're only really wasting 1 bit by doing things this way.
## Post #297
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-12T10:51:40+00:00
- Post Title: 

I try now to go through the files by hand. Maybe I make a new observation that helps to better the understanding of the files.

And I already made a step:
The first unknown value in the DirectoryTree of an img files: This is the Checksum-32:

```
     "Name": baseName + "/" + filename,
     "Size": filesize,
     "Unk1": unknown1,  #### This is a Checksum-32
     "Unk2": unknown2
}

```


I tried this in a hex editor that can calculate checksums. I copied the whole img files and stored it in a new file and let the hex editor calculate the Checksum-32 of it. It was the same as "Unk1".

"type-3" directorys have no checksum (one byte with 0x00).

Now I go for the second unknown value.

edit: I don't know if this is important, but the second value seems alwys to be dividable by 8 (I picked some random ones). I tried this because I thought that this could also be a number of bytes or bits.
But it could just be random.
Another idea was, that Unk2 is not a 32bit value, but maybe 4 single bytes or two words or a [byte word byte] sequence. But I could not refer any value of these 4 bytes to any property of the img file.

Maybe I'll put a new version of the dump.py up, when it's tested enough with the new results (renaming, removing the prevstring part, these small things). But I am testing everything in my Delphi application (what is mainly a copy of large parts of the Python script), that's why I almost never touched the script for testings until now.

And I'll try to rewrite the whole extract00type from the beginning. Maybe I find a shorter version (shorter = faster and means less bugs possible)

edit2:
Ah.. now I understand what all the prevstring and subsize thing was for. The "link" (extract00typeAt) points to another, already existing file, because it has the same name (but other content). And the subsize reads the size from the name of this file again.
I think with this knowledge I can rewrite all the string functions.

edit3:
So, here's a shorter code for the strings. But I am still not totally happy with that. But at least it's a lot cleaner than before. I tried it on String.wz (what should be the "ultimate" test fpr a string function  )

```
  pos = f.tell()
  f.seek(loc + baseOffset, 0)
  rU8(f)
  value = extract00type(f)
  f.seek(pos)
  return value

def extract00type(f):
  size = rS8(f)
  if(size == 0):
    return ""

  if(size < 0):
    if(size == -128): size = rS32(f)
    else:             size = -size
    return transStr(f.read(size)) 
  
  if(size > 0):
    if(size == 127): size = rS32(f)
    return transStr16(f.read(size*2))

```


The size==1 thing isn't needed. If it's Unicode always 2 byte have to be read (what the function does). With the size==1 check the function either does reading two bytes and return the character or does reading the two bytes twice and return the character or the string.
So this could be removed compeltly.
My idea that it could be UTF-8 seemed false, by the way. It seems only to be either ASCII or the Basic Multilingual Plane of Unicode (what HTML uses, too) with the first ~65.000 characters (that also include the Korean Hanguel characters). So this seems fine.

But besides that, I tried also some things with the two unknown bytes directly after the header. But found out nothing until now.
But I can say that it's no 16 bit checksum or something like that, I tried a lot of combinations with that. And then all wz files should have different two bytes (what they don't have).
My idea on that two bytes is, that they are an "internal" version check, so that the client recognizes, if the wz files are the correct ones for the Client version.

edit4:
If someone is interested in the checksum calculation:
the mathematical form goes like that:
Ckecksum = Sum(byte_0..byte_EOF) modulo 2^32

In words: Sum up all bytes, devide that by 2^32 and take the modulo.
## Post #298
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-13T01:42:45+00:00
- Post Title: 

> Reply from kolli
>
> I try now to go through the files by hand. Maybe I make a new observation that helps to better the understanding of the files.

And I already made a step:
The first unknown value in the DirectoryTree of an img files: This is the Checksum-32:
Code: Select allv = {
     "Name": baseName + "/" + filename,
     "Size": filesize,
     "Unk1": unknown1,  #### This is a Checksum-32
     "Unk2": unknown2
}


I tried this in a hex editor that can calculate checksums. I copied the whole img files and stored it in a new file and let the hex editor calculate the Checksum-32 of it. It was the same as "Unk1".

"type-3" directorys have no checksum (one byte with 0x00).

Now I go for the second unknown value.

edit: I don't know if this is important, but the second value seems alwys to be dividable by 8 (I picked some random ones). I tried this because I thought that this could also be a number of bytes or bits.
But it could just be random.
Another idea was, that Unk2 is not a 32bit value, but maybe 4 single bytes or two words or a [byte word byte] sequence. But I could not refer any value of these 4 bytes to any property of the img file.

Maybe I'll put a new version of the dump.py up, when it's tested enough with the new results (renaming, removing the prevstring part, these small things). But I am testing everything in my Delphi application (what is mainly a copy of large parts of the Python script), that's why I almost never touched the script for testings until now.

And I'll try to rewrite the whole extract00type from the beginning. Maybe I find a shorter version (shorter = faster and means less bugs possible)

edit2:
Ah.. now I understand what all the prevstring and subsize thing was for. The "link" (extract00typeAt) points to another, already existing file, because it has the same name (but other content). And the subsize reads the size from the name of this file again.
I think with this knowledge I can rewrite all the string functions.

edit3:
So, here's a shorter code for the strings. But I am still not totally happy with that. But at least it's a lot cleaner than before. I tried it on String.wz (what should be the "ultimate" test fpr a string function  )
Code: Select alldef extract00typeAt(f, loc, baseOffset):
  pos = f.tell()
  f.seek(loc + baseOffset, 0)
  rU8(f)
  value = extract00type(f)
  f.seek(pos)
  return value

def extract00type(f):
  size = rS8(f)
  if(size == 0):
    return ""

  if(size < 0):
    if(size == -128): size = rS32(f)
    else:             size = -size
    return transStr(f.read(size)) 
  
  if(size > 0):
    if(size == 127): size = rS32(f)
    return transStr16(f.read(size*2))


The size==1 thing isn't needed. If it's Unicode always 2 byte have to be read (what the function does). With the size==1 check the function either does reading two bytes and return the character or does reading the two bytes twice and return the character or the string.
So this could be removed compeltly.
My idea that it could be UTF-8 seemed false, by the way. It seems only to be either ASCII or the Basic Multilingual Plane of Unicode (what HTML uses, too) with the first ~65.000 characters (that also include the Korean Hanguel characters). So this seems fine.

But besides that, I tried also some things with the two unknown bytes directly after the header. But found out nothing until now.
But I can say that it's no 16 bit checksum or something like that, I tried a lot of combinations with that. And then all wz files should have different two bytes (what they don't have).
My idea on that two bytes is, that they are an "internal" version check, so that the client recognizes, if the wz files are the correct ones for the Client version.

edit4:
If someone is interested in the checksum calculation:
the mathematical form goes like that:
Ckecksum = Sum(byte_0..byte_EOF) modulo 2^32

In words: Sum up all bytes, devide that by 2^32 and take the modulo.
Wow, nice work.  I knew it was a checksum, but good work figuring out the actual algorithm.  So, the function to calculate checksums would to just keep on adding and keep only the lower 32 bits.  Why couldn't they just use crc32 >.< (which I tried).

The 2nd unk is really weird.  I think it's some kind of location because all the numbers changed when there was a new patch (unlike a checksum which wouldn't have changed unless the file was).  It's the only logical thing that is remaining to include.  

For the two header bytes, The version was lambda and my guess as well.
## Post #299
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-13T07:02:40+00:00
- Post Title: 

So, here is the new version with the updated names and the easy string extrcation.

The new function includes all the stuff that is needed to read a string (only the transStr is seperarted, maybe I include that later).
The parameters of the function are:
 the file "f"
 the integer "offset" (contains the offset from the parent block, if it's a link)
 the bool link (must be true, when it's a link to an existing filename)
 the bool pft (must be true, when called from extractDirectories)

```
  if(link):
    loc = rS32(f)
    pos = f.tell()
    f.seek(loc + offset)
    if(pft): flag = rU8()
  size = rS8(f)
  if(size == 0): result = ""
  if(size > 0):
    if(size == 127): size = rS32(f)
    result = transStr16(f.read(size*2))
  if(size < 0):
    if(size == -128): size = rS32(f)
    else:             size = -size
    result = transStr(f.read(size))
  if(link): f.seek(pos)
  return result

```


Now, finally for some new stuff. 

edit1:
I came to a really logical idea, what the unk2 could be. But unfortunatly I yet do not know how/if it's encrypted.
What properties do files normally have (besides the content)? Correct: a name, a size, a checksum (that's all there) and what else? A date! My only problem is now, that I couldn't figure out it's format. It's no Unix timestamp.
I'll try around with that a bit, because this seems the only logical explanation for these bytes..

edit2:
I wrote a testing routine that saves all the infos about the imgs to txt files.
Currently the last unk is displayed as a unsigned 32 bit integer, but that's not sure. It could also be a signed 32bit integer or something completly different.
I uploded a pack of txt files that contain all the img headers from 0.39 from all wz files.
Ah, you only can post 1 attachment... O included the txts in the old attachment.

edit3:
I checked around a bit with these numbers.... I tried also to display them as signed 32 bit integers --> some of them get negative.
My first idea, that they always can be devided by 8, is false. There were some, that can't.
But still no progress, what they could mean. I still believe, it's some timestamp.
[dump.rar](https://xentaxbackup.github.io/file/1262_dump.rar)
## Post #300
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-14T00:02:30+00:00
- Post Title: 

I highly doubt it's a date.  A while back I had saved all the unk1 and unk2s, and then compared them to the after-patch values, and monitored which files changed.  The files which didn't change, unk1 stayed the same; the files which did change, unk1 changed as well.  The conclusion was that it was some kind of checksum (though it could also have been the date, should have thought of that).  unk2 on the other hand changed for every file, even those that were unpatched.  This is most likely not a date.  As you were going based on logic earlier, the date is completely useless from a gameplay perspective.  The name is required to reference other parts, the size is required to know what to read, the checksum is required for file integrity.  The only remaining thing that could be of use is a direct pointer to where the .img file is in the bigger data file.  I highly doubt they read through the data files sequentially.
## Post #301
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-14T08:12:59+00:00
- Post Title: 

Hm.. Good point there.
But a pointer does not make sense either. When you have the sizes, you automatically know, where the following file is located (what the computeFileOffset function does).
Because if we compare how Wizet stores numbers and pictures (compressed to it's most), it's really unlikely that they waste 4 bytes for every img for a number that they already have.

Today I'll concentrate on this. I'm going to compare the extracted stuff and the unextracted imgs with the 4 bytes.
Hopefully I'll find something...
## Post #302
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-07-14T10:58:36+00:00
- Post Title: 

Every fhinge I extor is a "FireFox" File how do I make it an Image file…?
## Post #303
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-14T13:03:33+00:00
- Post Title: 

> Reply from ninjalm
>
> Every fhinge I extor is a "FireFox" File how do I make it an Image file…?

With the following two boolean variables you can say, what should be dumped.

```
dumpHTML = 1

```


In my upload the dumpImages was false, because for testing I disable it.

Here is a version where this is enabled again. But you could have done this yourself...
[dump.rar](https://xentaxbackup.github.io/file/1264_dump.rar)
## Post #304
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-07-14T16:47:01+00:00
- Post Title: 

it extor ".0001.img"
and
".0002.img"
they are both "FireFox" file.
and then it stop and say it alreday exit or somefhinge..
## Post #305
- Username: kolli
- Rank: n00b
- Number of posts: 15
- Joined date: Tue May 01, 2007 1:57 am
- Post datetime: 2007-07-15T13:27:41+00:00
- Post Title: 

> Reply from ninjalm
>
> it extor ".0001.img"
and
".0002.img"
they are both "FireFox" file.
and then it stop and say it alreday exit or somefhinge..
Uhm... You have to tell the script what file it should extract. My uploaded version is set to TamingMob.wz, because that is the smallest file (--> fast to test changes).

Just change the following line to the file you want to extract:

```
f = open("TamingMob.wz", "rb")
```


If you want to extract Npc.wz then change "TamingMob.wz" to "Npc.wz".
## Post #306
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-07-16T21:33:32+00:00
- Post Title: 

Works.
hmm but to puts all the code and stuff to make this game work in a priavte srver is imposble no?
## Post #307
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-07-17T01:25:06+00:00
- Post Title: 

> Reply from ninjalm
>
> Works.
hmm but to puts all the code and stuff to make this game work in a priavte srver is imposble no?
None of this info is even useful for making a private server....Making a private server usually involves writing your own server code and pointing the already existing client at your private server.  That involves decoding the game's internet protocol, which we haven't done (and aren't going to do).

After you figure out how they're sending stuff, you have to figure out what they're sending, and then write some server code which can understand that, add a database to understand all that code, then find some people to join your server.  That's how the WoW private servers work (which is why they are somewhat buggy and usually missing quests).

But, good luck all the same.
## Post #308
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-03T16:51:11+00:00
- Post Title: 

So, did anyone get something new??
## Post #309
- Username: Texel
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Sat Aug 04, 2007 6:33 am
- Post datetime: 2007-08-03T23:08:52+00:00
- Post Title: 

[http://www.cursedsanctuary.com/forums/i ... opic=37160](http://www.cursedsanctuary.com/forums/index.php?showtopic=37160)
## Post #310
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2007-08-03T23:19:17+00:00
- Post Title: 

Nice going, Texel, sad to see you leave the MS community, but as a father of a child of two, I can relate to you. Releases of MultiEx Commander has halved in terms of time.  

Thanks for the tool and source. I'm sure other people can pick up on it and continue the work. 

[http://www.xentax.com/uploads/author/mr ... aplext.zip](http://www.xentax.com/uploads/author/mrmouse/Maplext.zip)
## Post #311
- Username: Texel
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Sat Aug 04, 2007 6:33 am
- Post datetime: 2007-08-04T02:52:58+00:00
- Post Title: 

ah, I should mention that the patcher code is Rick's. The rest is mine, however. If he objects to its distribution then it might be wise to take it out.

I just poked through the code for the first time in a long time, and noticed I left a lot of things out... so if there are any specific questions about the code within the next few weeks I'll check here and answer.
## Post #312
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-04T16:41:25+00:00
- Post Title: 

So how do u use this tool?
## Post #313
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-06T00:43:25+00:00
- Post Title: 

so can anyone pls teach me how to use this?
## Post #314
- Username: Manias
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Tue Oct 24, 2006 7:03 pm
- Post datetime: 2007-08-10T13:31:42+00:00
- Post Title: 

said it is possible to extract KMS files, but I failed. Please check it again.
## Post #315
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-08-10T16:52:15+00:00
- Post Title: 

> Reply from Manias
>
> said it is possible to extract KMS files, but I failed. Please check it again.

KMS uses a different encryption key which dump.py (and probably maplext) don't have. The only one I know of who cracked it is Omega (EDIT: and probably Rick), and he won't share the program with anyone.
## Post #316
- Username: Manias
- Rank: ultra-n00b
- Number of posts: 4
- Joined date: Tue Oct 24, 2006 7:03 pm
- Post datetime: 2007-08-10T17:18:46+00:00
- Post Title: 

> Reply from hello?
>
> Manias wrote:said it is possible to extract KMS files, but I failed. Please check it again.

KMS uses a different encryption key which dump.py (and probably maplext) don't have. The only one I know of who cracked it is Omega (EDIT: and probably Rick), and he won't share the program with anyone.

hm...? maplext    
[http://www.cursedsanctuary.com/forums/i ... opic=37160](http://www.cursedsanctuary.com/forums/index.php?showtopic=37160)
maplext... who knows... language type difference?

oh, and it doesn't work on KMST files created since they changed the encryption scheme.. but it should work fine on production KMS, JMS, CMS, GMS, EMS, etc. data files.
## Post #317
- Username: Texel
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Sat Aug 04, 2007 6:33 am
- Post datetime: 2007-08-10T18:27:38+00:00
- Post Title: 

Last I checked production KMS was not encrypted the same as KMST.

Keep in mind, however, that I haven't messed with this stuff since last year 

.. so it's quite possible they've extended the newer encryption to production KMS.

edit: Rick does indeed know the new encryption scheme, and I've dabbled in it some. I don't believe it's reverse-engineerable from looking at unencrypted/encrypted strings side-by-side - you'll need to jump in deep with a good decompiler and figure it out from there.

At any rate, the point of my contribution was not to distribute some tool that anyone can just download and go to town with, though it may work well enough for some purposes. The point is for there to be SOME code out there aside from the much-bandied-about Python scripts that can do the job.

Up until they implemented the newer encryption for KMST it worked flawlessly on all versions of MS - if it's not working now it's because they changed something in the meantime.
## Post #318
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-10T20:31:11+00:00
- Post Title: 

so do u mean that with your tool, there's something missing before we can use it to extract it?
## Post #319
- Username: Texel
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Sat Aug 04, 2007 6:33 am
- Post datetime: 2007-08-11T00:07:36+00:00
- Post Title: 

No, there's nothing missing. Have you read anything I've written?

I think I've explained it pretty clearly..

> Up until they implemented the newer encryption for KMST it worked flawlessly on all versions of MS - if it's not working now it's because they changed something in the meantime.

Last time I used it was a few months ago, and it worked fine on some JMS data - I only said it wouldn't work on KMST data because the encryption is different, and that in the future it may stop working if the newer KMST encryption is spread around.

However, if you're not familiar with C-style programming languages or command-line applications then the code and executable I supplied aren't going to do you much good. Wait for people who actually know what they're doing to write a "tut" for you.
## Post #320
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-11T01:26:22+00:00
- Post Title: 

can't u pls write a tut for me? Pls??
## Post #321
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-08-11T01:41:37+00:00
- Post Title: 

Are you even reading what is being posted? Asking a whole bunch of the same thing multiple times isn't going to get it done any faster.

As Texel said:

> However, if you're not familiar with C-style programming languages or command-line applications then the code and executable I supplied aren't going to do you much good. Wait for people who actually know what they're doing to write a "tut" for you.
## Post #322
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2007-08-11T17:02:20+00:00
- Post Title: 

> Reply from Texel
>
> ah, I should mention that the patcher code is Rick's. The rest is mine, however. If he objects to its distribution then it might be wise to take it out.I'm fine with this - many other people have done the same thing and it's not hard to figure out.
## Post #323
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-08-28T06:56:57+00:00
- Post Title: 

I expect the C version is faster than the Python one?

I can't test this because I don't have MS installed; I quit few years ago o.o
## Post #324
- Username: Texel
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Sat Aug 04, 2007 6:33 am
- Post datetime: 2007-08-28T13:09:38+00:00
- Post Title: 

Actually, I would imagine that the largest bottleneck here is disk access. I've never run the python script here, but I just did a full image extract from a somewhat older JMS Map.wz (293MB) and it took roughly 16 minutes to extract 16,559 images.

I seem to remember it being faster than that, but that may have been a long time ago before Map.wz got so bloated.
## Post #325
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2007-08-28T17:32:08+00:00
- Post Title: 

It is possible to make this dump.py script to output a proper PHP file instead of an html file which eases dynamic input.

I use this one for my site:

```
  print "<?\n"
  for val in vals:
    fixedval = val[1]
    if(endMatches(val[0], ["image"])):
       print "$safe_%s = '%s';" % (val[0].replace(".", ""), val[1].replace(".", ""))
    elif(endMatches(val[0], ["mp3"])):
      print "$safe_%s = '%s';" % (val[0].replace(".", ""), val[1].replace("*", ""))
    else:
        if type(val[1]) is int:
           fixedval = val[1]
        else:
           if type(val[1]) is float:
               fixedval = val[1]
           else:
               fixedval = val[1].replace("'", "&apos;")
    print "$safe_%s = '%s';" % (val[0].replace(".", "_"), fixedval)
  print "?>"
```


Let me know 

Also, if any clues as to how to figure out the encryption of kMST would be helpful. Because sooner or later, it will come out and many websites based on this dump script will be affected severely.
## Post #326
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-08-29T04:45:05+00:00
- Post Title: 

> Reply from kiler
>
> It is possible to make this dump.py script to output a proper PHP file instead of an html file which eases dynamic input.

I use this one for my site:

Let me know 

Also, if any clues as to how to figure out the encryption of kMST would be helpful. Because sooner or later, it will come out and many websites based on this dump script will be affected severely.
Sorry, can't help with php.  And I would highly recommend that noone post significant amounts of info about the new encryption (or code for that matter).  As we were getting close with this thread, they changed the encryption on the latest versions, suggesting that perhaps they would rather keep it closed.

The string encryption is not difficult to decrypt, it just takes some guessing.  The image encryption is a bit more difficult (still stuck on that ).  And if people properly release the KTMS code elsewhere significant, then I'm sure we can incorporate it into here fairly easily.
## Post #327
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-08-29T05:25:02+00:00
- Post Title: 

Can Someone Pls Write A Tut For Me Pls???
## Post #328
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2007-08-29T07:49:10+00:00
- Post Title: 

> Reply from Omega
>
> kiler wrote:It is possible to make this dump.py script to output a proper PHP file instead of an html file which eases dynamic input.

I use this one for my site:

Let me know 

Also, if any clues as to how to figure out the encryption of kMST would be helpful. Because sooner or later, it will come out and many websites based on this dump script will be affected severely.
Sorry, can't help with php.  And I would highly recommend that noone post significant amounts of info about the new encryption (or code for that matter).  As we were getting close with this thread, they changed the encryption on the latest versions, suggesting that perhaps they would rather keep it closed.

The string encryption is not difficult to decrypt, it just takes some guessing.  The image encryption is a bit more difficult (still stuck on that ).  And if people properly release the KTMS code elsewhere significant, then I'm sure we can incorporate it into here fairly easily.

Actually, it made a PHP script instead of an HTML file so you can dynamically input data into places like strategywiki, etc.
## Post #329
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-03T06:55:03+00:00
- Post Title: 

Hi, everyone.

This might interest some of you:
I worked on a WZ file Browser (not an extractor). No need to extract the whole files for one single picture anymore. 
You can get it there:
[http://maplestory.maststef.de](http://maplestory.maststef.de)

Please let me know bugs and feature requests.
## Post #330
- Username: gid
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Aug 29, 2007 8:38 pm
- Post datetime: 2007-09-03T08:40:50+00:00
- Post Title: 

anyone knows where the Maple TV graphics are stored? I can't seem to be able to find it.
## Post #331
- Username: gid
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Aug 29, 2007 8:38 pm
- Post datetime: 2007-09-03T08:43:52+00:00
- Post Title: 

> Reply from maststef
>
> Hi, everyone.

This might interest some of you:
I worked on a WZ file Browser (not an extractor). No need to extract the whole files for one single picture anymore. 
You can get it there:
http://maplestory.maststef.de

Please let me know bugs and feature requests.

i've just downloaded it, thank you! But i'm not sure of how to use it. when i click on it i get an error (.NET Framework Initialization Error)
## Post #332
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-03T09:39:40+00:00
- Post Title: 

> Reply from gid
>
> maststef wrote:Hi, everyone.

This might interest some of you:
I worked on a WZ file Browser (not an extractor). No need to extract the whole files for one single picture anymore. 
You can get it there:
http://maplestory.maststef.de

Please let me know bugs and feature requests. 

i've just downloaded it, thank you! But i'm not sure of how to use it. when i click on it i get an error (.NET Framework Initialization Error)
Do you have the .NET Framework 2.0 installed? You need it to run the tool. Search the Microsoft site for it, you should easiliy find it.

And do you mean the MapleTV devices or the shows that are running? The devices are NPCs (npc.wz) and the shows are on two position:
1) Nexon's patch ftp server (swf files)
2) UI.wz\MapleTV.img (single PNG picture)
## Post #333
- Username: gid
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Aug 29, 2007 8:38 pm
- Post datetime: 2007-09-03T09:46:40+00:00
- Post Title: 

These.. Thanks for your help!
## Post #334
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-03T09:52:41+00:00
- Post Title: 

As I already posted:
The "borders" of the TVs in Npc.wz. And the shows of the TVs are in UI.wz.

Did you managed to get my tool running with the .NET Framework?
## Post #335
- Username: gid
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Aug 29, 2007 8:38 pm
- Post datetime: 2007-09-03T09:56:05+00:00
- Post Title: 

ooh awesome i found the TV.

anyway. I'm sorry but I duno how to go about 'fixing' the .net framework thingy ><
## Post #336
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-03T10:14:34+00:00
- Post Title: 

> Reply from gid
>
> ooh awesome i found the TV.

anyway. I'm sorry but I duno how to go about 'fixing' the .net framework thingy ><
Download and install the .NET Framework 2.0 from there:
[http://www.microsoft.com/downloads/deta ... b15c5e04f5](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=0856eacb-4362-4b0d-8edd-aab15c5e04f5)
## Post #337
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-03T13:28:45+00:00
- Post Title: 

can u write me a tut for using maplext?
## Post #338
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-03T14:09:09+00:00
- Post Title: 

> Reply from Tiger
>
> can u write me a tut for using maplext?
Open a command line and run maplext. It will tell you what to do.

Or just use my WZ browser. (look in my signature to find the link)
## Post #339
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-03T14:11:36+00:00
- Post Title: 

I don't know how to do the command line, pls explain
## Post #340
- Username: gid
- Rank: ultra-n00b
- Number of posts: 5
- Joined date: Wed Aug 29, 2007 8:38 pm
- Post datetime: 2007-09-03T15:21:50+00:00
- Post Title: 

yea i had no idea how to use maplext...

and maststef, your program is awesome!
## Post #341
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-05T23:31:23+00:00
- Post Title: 

maststef, pls?
## Post #342
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-08T21:42:28+00:00
- Post Title: 

maststef, can u pls add an option to your wz extractor extract all images? Also, does ur tool also get information from the wz files? For example, a monster's level, money, exp and etc.
## Post #343
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-09T07:50:20+00:00
- Post Title: 

> Reply from Tiger
>
> maststef, can u pls add an option to your wz extractor extract all images? Also, does ur tool also get information from the wz files? For example, a monster's level, money, exp and etc.
Extracting is planned, yes. I'm start working today on some things. But it's done when it's done, I won't give release dates.

The tool displays everything what's in the wz files. So yes, it also can tell you the monster stats if it's in the wz file.
## Post #344
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-09T23:59:53+00:00
- Post Title: 

Thx, Also, can u pls give a step by step tut using Maplext?
## Post #345
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-10T19:34:41+00:00
- Post Title: 

> Reply from Tiger
>
> Thx, Also, can u pls give a step by step tut using Maplext?
There's no need for a tutorial. There's only one thing you have to learn to use Maplext: How to use the Comman Prompt provided in any Windows version.

But for now you can use WZextract: 
I uploaded a new version of my tool. It can now extract all pictures at once:
[maplestory.maststef.de](http://maplestory.maststef.de)

Please let me know if an error occurs.
## Post #346
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-09-11T02:32:58+00:00
- Post Title: 

> Reply from kiler
>
> Actually, it made a PHP script instead of an HTML file so you can dynamically input data into places like strategywiki, etc.

Um, you can't dynamically input data into strategywiki, it has to be static.

And maststef, thanks for that program, it's really cool
## Post #347
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-11T06:29:53+00:00
- Post Title: 

Thx, also, can u try to intergrate the maual patcher, the one where u can patch it before everyone else using the patcher files from the ftp:? Pls?
## Post #348
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-11T07:10:57+00:00
- Post Title: 

> Reply from Tiger
>
> Thx, also, can u try to intergrate the maual patcher, the one where u can patch it before everyone else using the patcher files from the ftp:? Pls?
That's the next point on my todo list. You can expect in in the next days.

edit:
I'm currently trying to figure out the new KMSt encryption (just started today). Did anyone here already made some progress on it?

It seems that it's no simple XOR, like the old encryption.
I could not find any pattern in the new encryption until now...
## Post #349
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-12T04:35:19+00:00
- Post Title: 

Anyone have the old maple verisons wz files? Also, Maststef, can u pls finsih the patcher first before trying the new encyption? Cause I thinkt here's goign to be a patch soon and I wanna try the tool.
## Post #350
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-12T07:32:33+00:00
- Post Title: 

> Reply from Tiger
>
> Anyone have the old maple verisons wz files? Also, Maststef, can u pls finsih the patcher first before trying the new encyption? Cause I thinkt here's goign to be a patch soon and I wanna try the tool.
Yes, the patcher has highest priority.
Next thing, aftert he patcher, will maybe be a Map Renderer.

The new encryption has lowest priority since my tool focuses on gMS, and with KMS there is only one version that has this new encryption.
## Post #351
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-09-12T20:23:10+00:00
- Post Title: 

Oooh, map renderer. That sounds really cool, especially since I've been trying to piece maps together by hand (it isn't going so well, obviously)
## Post #352
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-13T17:55:44+00:00
- Post Title: 

I just uploaded a new version. I rewrote the full extract feature, it's a lot faster now (and has a cool progress bar ).

And the ManualPatcher feature also got implemented.
## Post #353
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-14T08:09:32+00:00
- Post Title: 

Nice job, however, when I tried to use it, it ran an error and had to close. Does it only work if there is actually a new patch?
## Post #354
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-14T11:51:27+00:00
- Post Title: 

> Reply from Tiger
>
> Nice job, however, when I tried to use it, it ran an error and had to close. Does it only work if there is actually a new patch?
What was the error? It should work always, because all it does is downloading the latest patch files and build the ManualPatcher.exe.
When I tested it everything worked fine.
## Post #355
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-15T15:12:03+00:00
- Post Title: 

Program had to close, whould u like to send or not send error to microsoft
## Post #356
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-15T16:09:54+00:00
- Post Title: 

> Reply from Tiger
>
> Program had to close, whould u like to send or not send error to microsoft
Microsoft could not change anything. But the Patcher wasn't working anyways.  So I fully recoded it. You now have to download the files yourself. For further information see the FAQ on my website.
## Post #357
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-16T03:42:03+00:00
- Post Title: 

Good Job Maststef, u did it!! So, what's next? Map renderer or the item thing?
## Post #358
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-16T08:12:58+00:00
- Post Title: 

> Reply from Tiger
>
> Good Job Maststef, u did it!! So, what's next? Map renderer or the item thing?
I'll work on both parallel. The item check is not really hard. That's maybe done in like 20 or 30 minutes.
## Post #359
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-16T09:28:51+00:00
- Post Title: 

Is there any way I can help you? Also, do u have msn?
## Post #360
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-16T12:33:59+00:00
- Post Title: 

> Reply from Tiger
>
> Is there any way I can help you? Also, do u have msn?
You could help me finding out the Map structure (how are tiles and objects addressed, etc). But I'm almost done with that myself now. 

I have MSN. Write me a PM and I'll add you.
## Post #361
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-18T05:17:13+00:00
- Post Title: 

Is there any way when u extract the images, to make the folder and the image name the name of the item/monster/etc.?  Like if u extract a blue snail, the image name that comes out will be named blue snail and so will the folder?
## Post #362
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-19T08:15:24+00:00
- Post Title: 

> Reply from Tiger
>
> Is there any way when u extract the images, to make the folder and the image name the name of the item/monster/etc.?  Like if u extract a blue snail, the image name that comes out will be named blue snail and so will the folder?
All the names are in String.wz. So you had to open at least two wz files at once (one for the pictures and one for the name). I won't implement that, because my tool is only for showing and browsing the wz files (it was not intended for extracting and/or connecting the several data parts).
## Post #363
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2007-09-20T22:46:18+00:00
- Post Title: 

kk
## Post #364
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2007-09-25T16:32:50+00:00
- Post Title: 

Is someone interested in also breaking up the patch files?
I already know the first steps and the general structure of the files. But I don't know if we should make it public, because I don't want that they also change their patch format (like they did with their strings and pictures).
## Post #365
- Username: kiler
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Thu Oct 19, 2006 10:50 am
- Post datetime: 2007-10-05T02:48:24+00:00
- Post Title: 

For some reason, this script isn't able to say what category an item is. For example, a Meba is a claw.. but it doesn't say that anywhere.

I know for sure that it's inside there somewhere because Rick uses it to get it. Bug?

Let me know.
## Post #366
- Username: NGKY
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Fri Oct 05, 2007 4:47 pm
- Post datetime: 2007-10-06T00:43:03+00:00
- Post Title: 

> Reply from maststef
>
> Is someone interested in also breaking up the patch files?
I already know the first steps and the general structure of the files. But I don't know if we should make it public, because I don't want that they also change their patch format (like they did with their strings and pictures).

you are referring to the .patch file?
## Post #367
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-10-13T13:54:27+00:00
- Post Title: 

Anyone went to try recode data wz to work on private srver ?
## Post #368
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-10-15T02:31:40+00:00
- Post Title: 

> Reply from ninjalm
>
> Anyone went to try recode data wz to work on private srver ?

Um, just having the client data to make your own private MapleStory server isn't going to cut it, you need to have the server data as well, which is currently unavailable. Without server data, things like quests and such will be missing, which would make your private server provide a less-than-adequate playing experience compared to the official MapleStory.
## Post #369
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-10-15T12:39:32+00:00
- Post Title: 

so how "WOW" got his files hacked but ms cant ?

i mean is a game that was invest alot more money and mS a free game from not so 'strong" company is so hard to hack the data ?
## Post #370
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-15T15:40:46+00:00
- Post Title: 

> Reply from ninjalm
>
> so how "WOW" got his files hacked but ms cant ?

i mean is a game that was invest alot more money and mS a free game from not so 'strong" company is so hard to hack the data ?

With WoW there is probably a larger and stronger community, more hands, lightens the work. There is also a lot of money involved with WoW, always a good incentive for people to invest their time...
## Post #371
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-10-15T20:41:51+00:00
- Post Title: 

> Reply from ninjalm
>
> so how "WOW" got his files hacked but ms cant ?

i mean is a game that was invest alot more money and mS a free game from not so 'strong" company is so hard to hack the data ?

A few things about that:
1) The official MapleStory is free, which reduces the incentives to make free private servers
2) Nexon may not appear "strong", but they know how to detect people that hack (especially hacking the server), if you didn't quite notice by the now-almost-extinct hacker community on Global
3) Plus, while extracting client data, etc. and sharing it isn't a punishable offense, hacking into a server is, and as I've said before, Nexon is pretty good at catching people
A culmination of those three means that for all the time MapleStory has been out, there is not even ONE fully-functional private server out there, and not much incentive exists to make one and keep one running (unlike in WoW, where you have to pay to play).
## Post #372
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-10-15T20:45:53+00:00
- Post Title: 

I agree. There's not much reason for a private server for MS as there is for WoW. It's not a good comparison as each case is different.
## Post #373
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-15T20:50:30+00:00
- Post Title: 

> Reply from Darkfox
>
> I agree. There's not much reason for a private server for MS as there is for WoW. It's not a good comparison as each case is different.

True, but some people just want to add their own content, items, quests, change things that frustrate them about the original server, change rules/spawn rates, etc... I think that is the case here.

[update]
fixed typo
## Post #374
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-15T20:53:01+00:00
- Post Title: 

By the way, hello?, it isn't realy nice to put a google adwords advertisement in your signature.... kind of rude trying to make money off of a community that is trying to help you...
## Post #375
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-10-15T21:01:55+00:00
- Post Title: 

XD! He isn't. It's just a random add that appears in the posts.

> True, but some people just want to add their own content, items, quests, change things that frustrate them about the original server, change rules/spawn rates, etc... I think that is the case here.

I have nothing against that. People may worry about cheating and little silly stuff like that but there are also serious people out there as well. I've seen forums be so anti-modding just because of a cheat phobia that could easily be controlled or avoided. I've always been the one against hindering a pursuit if it would help a game or add to the experience.

But for this it is met with several difficulties, however still. It could be interesting if made possible.
## Post #376
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-15T21:03:46+00:00
- Post Title: 

> Reply from Darkfox
>
> XD! He isn't. It's just a random add that appears in the posts.

Ok, sorry. I thought that too, but I looked thru a few pages, it only occurs in his posts...

update:

Lol, just after posting this I have it too, must be a stupid coincidence then  Sorry Hello?
## Post #377
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2007-10-15T21:05:35+00:00
- Post Title: 

> Lol, just after posting this I have it too, must be a stupid coincidence then  Sorry Hello?

LOL, it told you. XD
## Post #378
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-15T21:06:34+00:00
- Post Title: 

> Reply from Darkfox
>
> LOL, it told you. XD
## Post #379
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-10-16T20:34:14+00:00
- Post Title: 

> Reply from NKCSS
>
> By the way, hello?, it isn't realy nice to put a google adwords advertisement in your signature.... kind of rude trying to make money off of a community that is trying to help you...

it's not in my siggy. XeNTaX adds the ads in random posts throughout the page.
## Post #380
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-16T20:35:56+00:00
- Post Title: 

> Reply from hello?
>
> NKCSS wrote:By the way, hello?, it isn't realy nice to put a google adwords advertisement in your signature.... kind of rude trying to make money off of a community that is trying to help you...

it's not in my siggy. XeNTaX adds the ads in random posts throughout the page.

> Reply from NKCSS
>
> Darkfox wrote:XD! He isn't. It's just a random add that appears in the posts.

Ok, sorry. I thought that too, but I looked thru a few pages, it only occurs in his posts...

update:

Lol, just after posting this I have it too, must be a stupid coincidence then  Sorry Hello?

Sorry, I appologised after, sorry again m8.
## Post #381
- Username: hello?
- Rank: ultra-n00b
- Number of posts: 7
- Joined date: Wed Aug 08, 2007 3:07 am
- Post datetime: 2007-10-16T20:42:33+00:00
- Post Title: 

no problem NKCSS   

> Reply from NKCSS
>
> True, but some people just want to add their own content, items, quests, change things that frustrate them about the original server, change rules/spawn rates, etc... I think that is the case here.

Yeah, that makes sense. Most MapleStory versions do have a less-than-adequate exp-hp ratio for monsters (JMS and I don't know what else is 1.25 the exp, though, so it's slightly better). The only problem comes with hacking the server to get the data. While I'd support every effort to legitimately get a private server running, I'm not going to support illegal activities, such as hacking the server (for obvious reasons).
## Post #382
- Username: NKCSS
- Rank: advanced
- Number of posts: 76
- Joined date: Tue Oct 09, 2007 5:19 am
- Post datetime: 2007-10-16T20:46:18+00:00
- Post Title: 

> Reply from hello?
>
> no problem NKCSS   
NKCSS wrote:True, but some people just want to add their own content, items, quests, change things that frustrate them about the original server, change rules/spawn rates, etc... I think that is the case here.

Thanks 

> Reply from hello?
>
> 
Yeah, that makes sense. Most MapleStory versions do have a less-than-adequate exp-hp ratio for monsters (JMS and I don't know what else is 1.25 the exp, though, so it's slightly better). The only problem comes with hacking the server to get the data. While I'd support every effort to legitimately get a private server running, I'm not going to support illegal activities, such as hacking the server (for obvious reasons).

I don't think you'd have to hack the server (and of cource I can't condone it eather), as long as you know what you need (e.g. what content the client expects from the server), you could write your own content, but it would probably take months if your lucky, and years - which is more likely - if you'd have to do it alone.
## Post #383
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-10-24T13:43:50+00:00
- Post Title: 

i still think your over with 'years" i am sure it aint that hard but too bad Ms "Xp" is way too hard to level up and it would be cool to make a server with normal Xp and play with friends.

/:
## Post #384
- Username: ninjalm
- Rank: n00b
- Number of posts: 17
- Joined date: Thu May 03, 2007 1:32 am
- Post datetime: 2007-10-24T13:50:18+00:00
- Post Title: 

The contents of this post was deleted because of possible forum rules violation.
## Post #385
- Username: Nfwu
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Sun Oct 28, 2007 8:35 pm
- Post datetime: 2007-10-31T10:11:15+00:00
- Post Title: 

> Reply from ninjalm
>
> i found alot of these trying to make i am sure most of the pepole here alot more talented then them so it is Possibly no ?
The problem is with the legality of private servers. Private servers are illegal to run. (But apparently that does not stop a few hundred RO private servers springing up.)

> http://aqualinerelics.com/index.php?topic=1606.0
>
> yoyu need to rigestar and you download and kill monster rise Hp or Xp thers no jobs and all but it STILL WORK !

That's not a private server, that's an app that has a maple-like interface and is single-player.
## Post #386
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-16T19:11:58+00:00
- Post Title: 

Note: I am not your tech support. This product comes AS IS with all faults.

Hey guys, it's Fiel from Sleepywood.net

I know you guys like Lambda's extractor. I have taken his extractor and made it better. It now has the following features:

1. Improved version of the directory tree - it's much simpler to navigate
2. Can now search for changed images and index.html files via fast error checking
3. Creates an "Updated" folder that contains all of the changed information from your most recent extraction to your current extraction
4. The first extraction will take several hours, however subsequent extractions are done in less than 25% of the time! On my machine, a subsequent extraction takes only 4 minutes on Character.wz.
5. The ability to dump multiple WZ files in the same extraction. You don't have to edit the extractor every time you want to extract a new WZ file.
6. This extractor will work on all versions of Maplestory except for KMS and KMST.

Unfortunately, the extractor still has a problem working with sub-blocks in the Map.WZ. I suggest you avoid it altogether until I figure out the solution.

Link killed: http://r a p i dshare.com/files/76964471/MapleStory.zip

ZIP file contains:
- Newest (at this time in writing) Python version
- My version of Lambda's extractor
- Maplestory.base (used for making pre-patchers)
- Patchermain (used for making pre-patchers, thanks TEXEL)
- And a file called "dump.txt" which should get you up and running with the new features and programs.

(NOTE: That "under 4 minutes for Character.wz" was done on an Athlon 64 4400+ @ 2.6GHz and 2 GB RAM on Windows XP)
## Post #387
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-12-22T07:21:06+00:00
- Post Title: 

> Reply from Fiel
>
> Note: I am not your tech support. This product comes AS IS with all faults.

Hey guys, it's Fiel from Sleepywood.net

I know you guys like Lambda's extractor. I have taken his extractor and made it better. It now has the following features:

1. Improved version of the directory tree - it's much simpler to navigate
2. Can now search for changed images and index.html files via fast error checking
3. Creates an "Updated" folder that contains all of the changed information from your most recent extraction to your current extraction
4. The first extraction will take several hours, however subsequent extractions are done in less than 25% of the time! On my machine, a subsequent extraction takes only 4 minutes on Character.wz.
5. The ability to dump multiple WZ files in the same extraction. You don't have to edit the extractor every time you want to extract a new WZ file.
6. This extractor will work on all versions of Maplestory except for KMS and KMST.

Unfortunately, the extractor still has a problem working with sub-blocks in the Map.WZ. I suggest you avoid it altogether until I figure out the solution.

http://r a p i dshare.com/files/76964471/MapleStory.zip

ZIP file contains:
- Newest (at this time in writing) Python version
- My version of Lambda's extractor
- Maplestory.base (used for making pre-patchers)
- Patchermain (used for making pre-patchers, thanks TEXEL)
- And a file called "dump.txt" which should get you up and running with the new features and programs.
I haven't looked through the code, but impressive work all the same.  Some interesting mods to the code, and a good package with the most useful programs.
## Post #388
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-23T06:14:52+00:00
- Post Title: 

> Reply from Fiel
>
> 
- Patchermain (used for making pre-patchers, thanks TEXEL)

Mind posting the source for this?
## Post #389
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2007-12-23T16:33:13+00:00
- Post Title: 

> Reply from themoviefund
>
> Fiel wrote:
- Patchermain (used for making pre-patchers, thanks TEXEL)

Mind posting the source for this?
I think that's the code that texel posted a page or two back.  He just compiled it for us.
## Post #390
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-23T20:57:57+00:00
- Post Title: 

Yeah, it's TEXEL's code. All I did was compile it.
## Post #391
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-29T05:28:17+00:00
- Post Title: 

I'm back at it again!

This next version has all of the features in my previous post with the following enhancements:

- Can now extract MP3 files from Sound.wz
- Can extract all files from Map.wz without error

http://r a p i dshare.com/files/79779987/MapleStory.zip

Interestingly enough, in the Sound.wz all of the extractors jump over those 87 hex numbers to get to the actual sound file. I figured out what it was - IDv3 tags. It wasn't worth it to extract them, though. >_>
## Post #392
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-29T07:50:21+00:00
- Post Title: 

Thanks so much for finding a fix to that extremely annoying bug 

.. With only two lines of code xD
## Post #393
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-12-29T22:17:25+00:00
- Post Title: 

Hi Fiel, It is koolk.
I promised to send you fixes to all the bugs but i forgot, sorry.

I see that you fixed two bugs already, nice!
So here is more fixes:
-In other versions(MSEA for example) there is another problem with Map.WZ.
In subBlock, the flag is 0x73. So add this in subBlock before: check(flag, 0x1b, f, "flag")

```
 val = extract73type(f, name, baseOffset, endOfBlock)
 result.append(val)
 i+=1
 flag = rS8(f)

```

Maybe there is more correct way to fix it, but this is working.(I did fast converting to python, can you check if it works with maplesea?)
-Some of the images(in Map.WZ) are already in 32 bits, so you only need to change the order of the RGBA.
So here is the fixed 16to32:

```
  datalen = len(data)
  buf = ""
  for i in range(width*height):
    # Not all images decompress correectly. This makes up for it.
    if(i > datalen/2 - 1):
      p = [0,0]
    elif(width*height*2 == len(data)/2):
     p = struct.unpack("BBBB", data[i*4:i*4+4])
    else:
     p = struct.unpack("BB", data[i*2:i*2+2])
    if(width*height*2 == len(data)/2):
      a = p[3]
      r = p[2]
      g = p[1]
      b = p[0]
    else:
      a = p[1] / 16 ; a = a*16 + a
      r = p[1] % 16 ; r = r*16 + r
      g = p[0] / 16 ; g = g*16 + g
      b = p[0] % 16 ; b = b*16 + b

    if(a >  255): a = 255
    if(r >  255): r = 255
    if(g >  255): g = 255
    if(b >  255): b = 255

    buf += struct.pack("BBBB", r, g, b, a)
  return buf

```

-extract73type doesn't return all the values.
Here is the fix:

```
    space = rU16(f)  ; checkA(space, [0, 256], f)
    if(space == 256):
      nil = rU16(f)
      count = rU8(f)
      for i in range(count):
        qname = dumpBlock(f, name, baseOffset)
        val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
        vals.append([qname, val])
    imgname = name.replace('/', '.') + ".png"
    dumpImage(f, imgname)
    vals.append(['image', imgname])
    return vals

```

-subBlock return x,y
so why not? 

```

```

Did i miss any bug?
## Post #394
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-29T22:49:55+00:00
- Post Title: 

> Reply from kornto
>
> 
-extract73type doesn't return all the values.
Here is the fix:
Code: Select all  if(iname == "Canvas"):
    space = rU16(f)  ; checkA(space, [0, 256], f)
    if(space == 256):
      nil = rU16(f)
      count = rU8(f)
      for i in range(count):
        qname = dumpBlock(f, name, baseOffset)
        val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
        vals.append([qname, val])
    imgname = name.replace('/', '.') + ".png"
    dumpImage(f, imgname)
    vals.append(['image', imgname])
    return vals
What exactly does this do? I see it adds some extra values, but are you sure they are valid? Do you know what these are?

> -subBlock return x,y
>
> so why not? 
>
> Code: Select allresult.append([["x", val1], ["y", val2]])
I can't find this. I think I'm using a different version of code, which function is this in? (can't find it in "subBlock")

Thanks.
## Post #395
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-30T06:04:46+00:00
- Post Title: 

Yeah, there are still more problems... *test post*
## Post #396
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-30T06:15:05+00:00
- Post Title: 

.............
## Post #397
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T06:30:26+00:00
- Post Title: 

As far as I can tell, I see no changes in my extraction o_o

```
  iname = rStr(f)
  if(iname == "Shape2D#Convex2D"):
    count = rPackNum(f)
    return subBlock(f, count, endOfBlock,0, name)
  if(iname == "Shape2D#Vector2D"):
    val1 = rPackNum(f)
    val2 = rPackNum(f)
    return [["x", val1], ["y", val2]]
  if(iname == "Canvas"):
    space = rU16(f)  ; checkA(space, [0, 256], f)
    if(space == 256):
      nil = rU16(f)
      count = rU8(f)
      for i in range(count):
        qname = dumpBlock(f, name, baseOffset)
        val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
        vals.append([name.replace('/','.') + '.' + qname, val])
    imgname = name.replace('/', '.') + ".png"
    dumpImage(f, imgname)
    return ['image', imgname]
  if(iname == "UOL"):
    nil = rU8(f)
    image = dumpBlock(f, name, baseOffset)
    cName = computeName(image, name)
    return ['image*', cName]
  if(iname == "Sound_DX8"):
    nil = rU8(f)
    size = rPackNum(f)
    dumpMp3(f, size, endOfBlock, name.replace('/','.'))
    return ["mp3", name]

```


What does the addition of this line do:
        vals.append([name.replace('/','.') + '.' + qname, val])
vals is not a global in this function, so it doesn't actually affect anything. It's not returned either.
## Post #398
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-12-30T09:36:53+00:00
- Post Title: 

> Reply from Fiel
>
> 
kornto wrote:-extract73type doesn't return all the values.
Here is the fix:
Code: Select all  if(iname == "Canvas"):
    space = rU16(f)  ; checkA(space, [0, 256], f)
    if(space == 256):
      nil = rU16(f)
      count = rU8(f)
      for i in range(count):
        qname = dumpBlock(f, name, baseOffset)
        val = dumpEntryValue(f, name + "/" + str(qname), baseOffset)
        vals.append([qname, val])
    imgname = name.replace('/', '.') + ".png"
    dumpImage(f, imgname)
    vals.append(['image', imgname])
    return vals


This half-worked. The "return vals" at the end actually appends itself to vals, so this would cause things to be double-added. I had to take that out. Also, I changed the "vals.append([qname,val])" so that it would fit a little better with the rest of the extraction.
I don't know, when i extracted it always some of the values of the first image in ".img" were missing(for example delay and origin x/y), becuase it didn't do anything with the val. Are you sure that it works now?

> Reply from Fiel
>
> 

As of this moment, I can only think of one other problem with this python extractor. In UI//UIWindow.img, a file is extracted with the name "Memo.FontTime...png". This causes Windows to not recognize the filename. The actual filename should be "Memo.FontTime.10.png". I looked at the area in the code where this happens and it turns out that the WZ data does have it coming out as a '.' instead of a '10'. This also happens with another file in the WZ, "coconut.fontTime" (prefix). I can't locate the error for this one, but I'm guessing it's a logical error somewhere!

Link: http://r a p i dshare.com/files/80008923/dump.py.html

Oh yea, this is very annoying.
For me it creates file with the name: "Memo.FontTime." and it is impossible to delete it! because there isn't really such a file but I see it. (i found a trick how to delete it).
The problem is that the filename should be Memo.FontTime.:.png(not 10)
But : is an invalid character for a filename.
You can try to replace the ":" to a valid character, I didn't try it yet.

And in subblock, you don't need the check for the 0x73 and 0x1b.
Just add it before the if:

```
flag = rS8(f) ; checkA(flag, [0x1b, 0x73], f)
```
## Post #399
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T18:42:36+00:00
- Post Title: 

> Reply from kornto
>
> 
Fiel wrote:

As of this moment, I can only think of one other problem with this python extractor. In UI//UIWindow.img, a file is extracted with the name "Memo.FontTime...png". This causes Windows to not recognize the filename. The actual filename should be "Memo.FontTime.10.png". I looked at the area in the code where this happens and it turns out that the WZ data does have it coming out as a '.' instead of a '10'. This also happens with another file in the WZ, "coconut.fontTime" (prefix). I can't locate the error for this one, but I'm guessing it's a logical error somewhere!

Oh yea, this is very annoying.
For me it creates file with the name: "Memo.FontTime." and it is impossible to delete it! because there isn't really such a file but I see it. (i found a trick how to delete it).
The problem is that the filename should be Memo.FontTime.:.png(not 10)
But : is an invalid character for a filename.
You can try to replace the ":" to a valid character, I didn't try it yet.
I'm not sure where to fix it, but I know how.

```
    return ord(number) - 48;
   
fix('0') #0
fix('5') #5
fix(':') #10

```
## Post #400
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-12-30T18:48:58+00:00
- Post Title: 

> Reply from themoviefund
>
> kornto wrote:
Fiel wrote:

As of this moment, I can only think of one other problem with this python extractor. In UI//UIWindow.img, a file is extracted with the name "Memo.FontTime...png". This causes Windows to not recognize the filename. The actual filename should be "Memo.FontTime.10.png". I looked at the area in the code where this happens and it turns out that the WZ data does have it coming out as a '.' instead of a '10'. This also happens with another file in the WZ, "coconut.fontTime" (prefix). I can't locate the error for this one, but I'm guessing it's a logical error somewhere!

Oh yea, this is very annoying.
For me it creates file with the name: "Memo.FontTime." and it is impossible to delete it! because there isn't really such a file but I see it. (i found a trick how to delete it).
The problem is that the filename should be Memo.FontTime.:.png(not 10)
But : is an invalid character for a filename.
You can try to replace the ":" to a valid character, I didn't try it yet.
I'm not sure where to fix it, but I know how.
Code: Select alldef fix(number):
    return ord(number) - 48;
   
fix('0') #0
fix('5') #5
fix(':') #10
Why not just use replace(":", something else)?
It should be ':'(in the clock), but you can't name a file with :.
## Post #401
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T18:51:10+00:00
- Post Title: 

If ':' == 10, then ';' could equal 11. That would get to be x.replace(':', '10').replace(etc.)...

For now, it would work, since there are no 11's, but it might fail in the future.
## Post #402
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2007-12-30T20:14:04+00:00
- Post Title: 

> Reply from themoviefund
>
> If ':' == 10, then ';' could equal 11. That would get to be x.replace(':', '10').replace(etc.)...

For now, it would work, since there are no 11's, but it might fail in the future.
It isn't 10!
It is ':'.
the font thing is for the clock.
And there are 11 characters in the clock:
0,1,2,3,4,5,6,7,8,9,:
It is only coincidental thing that ':' come after '9' in ASCII.
## Post #403
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T20:18:40+00:00
- Post Title: 

...The clock? I don't know what your talking about now xD
## Post #404
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-30T20:59:04+00:00
- Post Title: 

You can't do string.replace(':','10') because doing the xor screws up the ASCII table. It's a quick hack fix, and I think it might be too risky to do it.

I'm also glad I'm not the only one with the memo/coconut problem.

Also, using the time function, I did some quick benchmarks:

String.wz: 0 minutes 4 seconds
Base.wz: 0 minutes 0 seconds
Character.wz: 4 minutes 7 seconds
Effect.wz: 0 minutes 0 seconds
Etc.wz: 0 minutes 2 seconds
Item.wz: 0 minutes 5 seconds
Map.wz: 3 minutes 2 seconds
Mob.wz: 0 minutes 9 seconds
Morph.wz: 0 minutes 0 seconds
NPC.wz: 0 minutes 7 seconds
Quest.wz: 0 minutes 4 seconds
Reactor.wz: 0 minutes 0 seconds
Skill.wz: 0 minutes 4 seconds
Sound.wz: 0 minutes 0 seconds
TamingMob.wz: 0 minutes 0 seconds
UI.wz: 0 minutes 1 seconds

Try to beat that on a subsequent extraction! 

> Reply from koolk
>
> 
I don't know, when i extracted it always some of the values of the first image in ".img" were missing(for example delay and origin x/y), becuase it didn't do anything with the val. Are you sure that it works now?

Yeah, go ahead and extract the first directory from accessory. It's there, now.
## Post #405
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T21:02:56+00:00
- Post Title: 

I ported Lambda's code to another language a couple weeks ago, but now I'm interested in your cache technique which clearly yields faster extract times. What exactly do you cache?
## Post #406
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-30T21:08:56+00:00
- Post Title: 

.....................
## Post #407
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-30T21:14:55+00:00
- Post Title: 

Ah, thanks. I'm going to try to implement that.

Which one do you think is more effective, the text caching or the imagesize caching?
## Post #408
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-30T21:16:36+00:00
- Post Title: 

> Reply from themoviefund
>
> Ah, thanks. I'm going to try to implement that.

Which one do you think is more effective, the text caching or the imagesize caching?

bufSize caching will yield the greatest improvement in overall extraction times. The text caching is better for overall accuracy with changed data, but it isn't entirely required.
## Post #409
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-31T02:01:58+00:00
- Post Title: 

On a completely unrelated note...

Fiel, do you still have that ManualPatch.base file that you included with your .zip? Texel's Maplext doesn't seem to include it and you removed yours from Rapidshare.

Could you reupload it here on Xentax as an attachment please? Thanks.
## Post #410
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-31T02:12:56+00:00
- Post Title: 

> Reply from themoviefund
>
> On a completely unrelated note...

Fiel, do you still have that ManualPatch.base file that you included with your .zip? Texel's Maplext doesn't seem to include it and you removed yours from Rapidshare.

Could you reupload it here on Xentax as an attachment please? Thanks.

I didn't delete it. Check the top post on the 27th page.
## Post #411
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2007-12-31T02:14:48+00:00
- Post Title: 

Oh lol, I don't know how I missed that. Thanks.
## Post #412
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-31T02:48:42+00:00
- Post Title: 

Running into some bad glitches now with the 'Updated/' portion of the engine.

It detected Hangul characters in the Map//Obj/HalloweenGL portion of the code. >_<
## Post #413
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2007-12-31T10:19:21+00:00
- Post Title: 

....................
## Post #414
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-01T20:29:42+00:00
- Post Title: 

> Reply from Fiel
>
> 
It took me 3 hours and 30 minutes to extract all of the WZ files from a clean slate. About 75% of the time was spent on extracting Map.WZ. Python's ZLib makes me cry.

That's good compared to the language I'm working with... 10 hours on Map.wz. >.>

By the way, why do you upload your updates to RapidShare? Why not upload them as an attachment here?
## Post #415
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-01T21:09:45+00:00
- Post Title: 

> Reply from themoviefund
>
> Fiel wrote:
It took me 3 hours and 30 minutes to extract all of the WZ files from a clean slate. About 75% of the time was spent on extracting Map.WZ. Python's ZLib makes me cry. 

That's good compared to the language I'm working with... 10 hours on Map.wz. >.>

By the way, why do you upload your updates to RapidShare? Why not upload them as an attachment here?

For some reason, this website no longer accepts files with extensions of .py. I tried uploading it myself and it didn't work. So... Rapidshare is my temporary option.

Also, our computer setup might be different. I have an Athlon 64 4400+ @ 2.6 GHz and 2GB of RAM. That could affect performance, ya know?
## Post #416
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-01T21:16:34+00:00
- Post Title: 

Ah, mine is 1.66 GHz and 2GB RAM. That should explain things.

On an unrelated note... My attempts at a map renderer are going spectacularly, except for some z-ordering.
## Post #417
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-01T22:02:55+00:00
- Post Title: 

> Reply from themoviefund
>
> Ah, mine is 1.66 GHz and 2GB RAM. That should explain things.

On an unrelated note... My attempts at a map renderer are going spectacularly, except for some z-ordering.

Excellent. 

You do know that the z-order for everything is in Base//zmap, right? It should be easy to get things in order from that.

>_>
## Post #418
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-01T22:33:13+00:00
- Post Title: 

> Reply from Fiel
>
> themoviefund wrote:Ah, mine is 1.66 GHz and 2GB RAM. That should explain things.

On an unrelated note... My attempts at a map renderer are going spectacularly, except for some z-ordering.  

Excellent. 

You do know that the z-order for everything is in Base//zmap, right? It should be easy to get things in order from that.

>_>
I don't see any values there related to maps, just the z-ordering on characters.
## Post #419
- Username: phantomzero
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Thu Jan 03, 2008 1:09 am
- Post datetime: 2008-01-03T06:53:00+00:00
- Post Title: 

hi, im new to this forum and i am really really noob at stuff like this. So i have no idea how to do any of this python stuff. I just have a question i hope someone can answer, is it currently possible to extract all the images from mob.wz , map.wz , and the other wz files from kms or kmst? if so can anyone please tell me how? i really really need the images from kms or kmst, i appreciate anyone who helps, thanks!
## Post #420
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-03T14:36:56+00:00
- Post Title: 

...................
## Post #421
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-08T15:29:20+00:00
- Post Title: 

.............
## Post #422
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-13T13:23:13+00:00
- Post Title: 

...........
## Post #423
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-13T19:27:03+00:00
- Post Title: 

What exactly have you changed? I'm too lazy to download an application for that 

Does this make significant changes or minor ones? Is it similar to older versions or completely different? Thanks.
## Post #424
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-13T21:10:57+00:00
- Post Title: 

.......................
## Post #425
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-18T08:49:02+00:00
- Post Title: 

Hi,

I'm also back (I had no internet 3 month because the local telecommunication company is a bit lazy...).
Maybe someone remembers me. I'm the one who coded WZextract, the WZ file browser (look in my signature), that can also create the ManualPatcher.

Soon I will release a new version that will fix a bug in the MP3 extraction (or to be more precice: I rewrote the whole MP3 extraction code).

But this was only the boring news. The real news is the following:
You may know that WZ extract can save the WZ information in xml files to compare it with the new content after a patch was released (it shows additions and changes).
I will remove this function (because it's slow and has some limitations) soon to implement something even better:
WZextract will be able to read the *.patch files directly!
## Post #426
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-18T17:12:45+00:00
- Post Title: 

Interesting. Will you provide code please?
## Post #427
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-19T02:22:41+00:00
- Post Title: 

MapleSEA now has new encryption as of 0.51. They also have a brand new WZ file --> List.wz. Oddly enough, this WZ file contains no header.
## Post #428
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-19T08:02:15+00:00
- Post Title: 

Ahh, I totally forgot about the new encryption... It's also on my todo list. I'm able to decrypt some of it already, but I still did not figured out the whole algorithm.

If it's not to large, could you please post the list.wz? I want to take a look at it.
## Post #429
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-19T12:55:43+00:00
- Post Title: 

The contents of this post was deleted because of possible forum rules violation.
## Post #430
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-19T16:15:23+00:00
- Post Title: 

Thanks.

The list.wz seems to be no wz file. Not only because of the missing header, but I don't find any known structures.
But The number "1A 00 00 00" (26 in decimal system) appears often (in a more or less regular pattern). This seams to be some indicator or separtor.

To come back to the new encryption:
Did someone other also tried to decode it?
The basic function is the same (every char is xor'd).
I found out the first 19 bytes to xor with:
0x01 0xCE 0xE5 0xA8 0xC9 0x62 0xE7 0xBB 0x2A 0xC8 0x33 0xBF 0x5A 0xD2 0xBF 0x32 0x2F 0xCF 0x8A
But I can't find any mathematical relation in this sequence (look at the bold ones, two times the same, but followed by another --> there must be an additional variable, if it's a calculation). A possibility would be to find out all 256 values, store them in an array and run through that array each time a string needs to be decrypted. (if there are even 256, maybe there are more, maybe less)
But I can't imagine that Wizet would use such "unserious" code.

And I don't know the sequence for the Unicode strings, because I can't read korean, so I can't verify if it's right...
## Post #431
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-19T18:46:06+00:00
- Post Title: 

Why don't you disassemble the game exe? Maybe it's a value that is dynamically computed.
## Post #432
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-20T02:38:16+00:00
- Post Title: 

I think you're right. I'm coming up with the same hex numbers. I don't think there's a way around encoding this hex into the program. Chances are that this stream of hex was created using a pseudorandom number generator and encoded as such. See [Vernam ciphers](http://en.wikipedia.org/wiki/Vernam_cipher). It's a method of security one step higher than what they had before, but it's still crackable.

EDIT: I've included my small analysis of the List.wz. Sorry it's in all caps, it's for readability.

1 0X05000000, 12 BYTE BLOCK
38 0X1A000000, 54 BYTE BLOCK
1 0X0F000000, 32 BYTE BLOCK
2 0X1F000000, 64 BYTE BLOCK
2 0X0F000000, 32 BYTE BLOCK
1 0X11000000, FINAL 36 BYTE BLOCK

45 TOTAL BLOCKS

PRIMARY BLOCK:
05 00 00 00 3C 05 0A CD 3A 0A E1 7B 87 0A

1A BLOCKS ARE NEARLY ALL HOMOGENEOUS

NEW BLOCK:
1A 00 00 00 (OFFSET 16)

BLOCK:
C6 65 28 05 17 CD 78 0A F5 7B
E6 0A 9C 65 28 8B F8 74 57 6C
C3 59 1B 5E 8D 59 31 7E 8A 7D
FA 74 A0 53 17 94 28 6F 53 87 
E0 D6 49 1E 82 52 80 52 EF 7A 
79 E8 06 90 

NEW BLOCK:
1A 00 00 00 (OFFSET 74)

BLOCK:
C6 65 28 05 17 CD 78 0A F5 7B
E6 0A 9C 65 28 8B F8 74 57 6C
C3 59 1B 5E 8D 59 31 7E 8A 7D
FB 74 A0 53 14 94 28 6F 53 87 <-- SEE CHANGES
E0 D6 49 1E 82 52 80 52 EF 7A 
79 E8 06 90

IT'S GENERALLY THESE TWO VALUES THAT SWITCH BETWEEN EACH OTHER.

0F BLOCKS ARE INTERESTING. ALL OF THE EVEN OFFSETS CONTAIN THE SAME
HEX NUMBERS AS THE REFERENCE 1A BLOCKS

NEW BLOCK:
0F 00 00 00 (OFFSET 2394)

BLOCK:
DE 65 20 05 48 CD 22 0A F1 7B
F0 0A 85 65 69 8B F1 74 59 6C
C4 59 07 5E CB 59 6E 7E D8 7D
CB 74

1F BLOCKS ALSO FOLLOW THIS SAME PATTERN.

DUE TO THIS PATTERN, IT APPEARS THAT THERE ARE THE 1A, 0F, AND 1F
ARE BLOCK SEPARATORS, AND THUS THEIR CONTENTS ARE SUBBLOCKS.

NEW BLOCK:
1F 00 00 00 (OFFSET 2498)

BLOCK:
C8 65 21 05 06 CD 25 0A F9 7B
E4 0A 98 65 62 8B E7 74 19 6C
C3 59 4C 5E D6 59 66 7E CE 7D
BE 74 F9 53 56 94 37 6F 51 87
E1 D6 41 1E 9C 52 DB 52 B2 7A
2A E8 3E 90 C1 4B 6A FF BE F3
17 4A 39 D3
## Post #433
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-20T04:20:40+00:00
- Post Title: 

Apparently, the whole List.wz repeats a 59-byte sequence, starting from byte 17 (0x0A), where one byte is different every time.


...Beat
## Post #434
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-20T09:29:08+00:00
- Post Title: 

Encryption:
I'll have a look at this encryption scheme.
I also thought about disassembling the exe. But when I tried it, there were errors (the exe itself seems to be packed [UPX could not decompress it] and/or encrypted), and I am not very familiar with assembler (I only know the very basics).

List.wz:
The repeating blocks are a "list" in some way, so the name of the file is justifiable.

To roll this up from another side:
I had no time to take a deeper look into the file (maybe today I'll find some minutes), but does only MSEA has this file? Or do other versions also have it? (I only have GMS, which don't has it). What does MSEA recently got in a patch, that other version don't have yet? Maybe we can then isolate some possibilities (it's easier to figure structures out, if you know some things that could be it).
## Post #435
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-20T12:13:53+00:00
- Post Title: 

> Reply from maststef
>
> I also thought about disassembling the exe. But when I tried it, there were errors (the exe itself seems to be packed [UPX could not decompress it] and/or encrypted), and I am not very familiar with assembler (I only know the very basics).
Well that's something I haven't considered. The exe might indeed be protected to prevent disassembling. Normally you can use No-CDs to disassemble it anyway, cause those fixed exes are usually unpacked. But this is a bit different for online games, it's hard to find cracks for them.

Scan the exe with [PEiD](http://www.peid.info/) and [ProtectionID](http://pid.gamecopyworld.com/) and report the results please.
## Post #436
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-20T12:49:57+00:00
- Post Title: 

> Reply from maststef
>
> 
Scan the exe with PEiD and ProtectionID and report the results please.
[http://img.photobucket.com/albums/v132/ ... 5/PEID.jpg](http://img.photobucket.com/albums/v132/Paulos2005/PEID.jpg)

And it's not detected at all by ProtectionID

EDIT:

[http://forum.cheatengine.org/viewtopic.php?t=85163](http://forum.cheatengine.org/viewtopic.php?t=85163)
## Post #437
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-20T13:08:10+00:00
- Post Title: 

May you upload the exe (and if possible also all dlls)?
## Post #438
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-20T13:24:34+00:00
- Post Title: 

The contents of this post was deleted because of possible forum rules violation.
## Post #439
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-20T15:36:28+00:00
- Post Title: 

The blocks from the new file are encrypted strings. I will check it later.
The new encryption is a crap.
But if you find it, please don't leak it, so they won't change it to an hard encryption.

Anyway, i found the encryption of the packets too(by dissembling), i tried to do a litte server on my computer. Just a little ss, [http://www.2send.us/uploads/32c1ca2113.jpg](http://www.2send.us/uploads/32c1ca2113.jpg)
## Post #440
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-20T16:36:48+00:00
- Post Title: 

> Reply from kornto
>
> But if you find it, please don't leak it, so they won't change it to an hard encryption.
There's always a new challenge
## Post #441
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-20T17:01:58+00:00
- Post Title: 

> Reply from Rheini
>
> There's always a new challenge

Indeed.

I tried to dump the MSEA exe but to no avail. Invalid pointers. I'll keep poking around.
## Post #442
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-20T17:15:14+00:00
- Post Title: 

Yeah strange stuff, the tools detect yoda's cryptor and after unpacking detect ASProtect.
## Post #443
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-20T20:09:04+00:00
- Post Title: 

> Reply from Rheini
>
> kornto wrote:But if you find it, please don't leak it, so they won't change it to an hard encryption.
There's always a new challenge
Disassembling the game to get the packet encryption was enough, I don't want more .
My hint is, that there is a way to figure out the new wz encryption without disassembling.
## Post #444
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-20T21:42:27+00:00
- Post Title: 

I checked one of the strings in list.wz, it is just a name of .img folder in one of the wz files.
Maybe it is a list of the encrypted folders? because not all the folders encrypted.
## Post #445
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-20T22:07:35+00:00
- Post Title: 

> Reply from kornto
>
> I checked one of the strings in list.wz, it is just a name of .img folder in one of the wz files.
Maybe it is a list of the encrypted folders? because not all the folders encrypted.
What do you mean by "not all folders are encrypted"? All the *.img files in all the wz's are packed and encrypted in the same way (if it would be not this way, then my WZextract tool [and also Maplext and the Python script] wouldn't work  ).

And like kornto said: Yes, the new string encryption must be crackable without disassembling (just imagine somone is sending you encrypted strings, but not the tool to decode them).
But again: The question still is, if Wizet used a fixed key (--> trial-and-error on finding all needed bytes) or a fixed calculation (--> finding out the math behind it).
## Post #446
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-20T22:12:26+00:00
- Post Title: 

> Reply from maststef
>
> kornto wrote:I checked one of the strings in list.wz, it is just a name of .img folder in one of the wz files.
Maybe it is a list of the encrypted folders? because not all the folders encrypted.
What do you mean by "not all folders are encrypted"? All the *.img files in all the wz's are packed and encrypted in the same way (if it would be not this way, then my WZextract tool [and also Maplext and the Python script] wouldn't work  ).

And like kornto said: Yes, the new string encryption must be crackable without disassembling (just imagine somone is sending you encrypted strings, but not the tool to decode them).
But again: The question still is, if Wizet used a fixed key (--> trial-and-error on finding all needed bytes) or a fixed calculation (--> finding out the math behind it).

No.
In msea only some of the folders are encrypted.
For example in UI.wz, the images in WindowUI are encrypted but in another folders not.

I figured out the encryption of kmst some months ago, and i said that i did it without disassembling.
The encryption is still a crap. I keep it private because I don't want that they will change it.
## Post #447
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-20T22:46:09+00:00
- Post Title: 

> Reply from kornto
>
> No.
In msea only some of the folders are encrypted.
For example in UI.wz, the images in WindowUI are encrypted but in another folders not.

I figured out the encryption of kmst some months ago, and i said that i did it without disassembling.
The encryption is still a crap. I keep it private because I don't want that they will change it.

Yes, but how long did it take you to figure out the encryption, and is the encryption overly difficult or relatively simple (both for KMS[T] and MSEA)?

EDIT: Oh wow... I think I just figured out some of the encryption. Koolk, check your PM's on Sleepywood.

EDIT2: Yeah, I just checked. What we're working with is KMST encryption. It's the exact same.
## Post #448
- Username: Rheini
- Rank: Moderator
- Number of posts: 652
- Joined date: Thu Oct 19, 2006 4:48 am
- Post datetime: 2008-01-21T07:22:17+00:00
- Post Title: 

> Reply from kornto
>
> Disassembling the game to get the packet encryption was enough, I don't want more .
My hint is, that there is a way to figure out the new wz encryption without disassembling.
Did you unpack the exe before doing so? If so, may you tell me what protection it is? The tools detect yoda and after unpacking AsProtect, but that can't be cause of CRC checks and so on.
## Post #449
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-21T07:52:47+00:00
- Post Title: 

> Reply from Fiel
>
> kornto wrote:No.
In msea only some of the folders are encrypted.
For example in UI.wz, the images in WindowUI are encrypted but in another folders not.

I figured out the encryption of kmst some months ago, and i said that i did it without disassembling.
The encryption is still a crap. I keep it private because I don't want that they will change it.

Yes, but how long did it take you to figure out the encryption, and is the encryption overly difficult or relatively simple (both for KMS[T] and MSEA)?

EDIT: Oh wow... I think I just figured out some of the encryption. Koolk, check your PM's on Sleepywood.

EDIT2: Yeah, I just checked. What we're working with is KMST encryption. It's the exact same.

That what i said from start.

The long part was to understand that the images are just encrpyted with XOR. But than it was very fast.

> Did you unpack the exe before doing so? If so, may you tell me what protection it is? The tools detect yoda and after unpacking AsProtect, but that can't be cause of CRC checks and so on.

No, I took an unpacked exe.(from GMS, not SEA)
And i think that it can be yoda and AsProtect
## Post #450
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-21T08:49:29+00:00
- Post Title: 

Are we talking about the same thing?
We talk about decrypting the text strings. They are simply XOR'd, yes, but that was known like already 2 years.
Our problem now is to find out  what they changed from old to new encryption.
Old one was: Every character was XOR'd with another value. The calculation of this "key" was "old_key + 1", starting with the key 0xAA.
New one is: Every character is XOR'd, key starts with 0x01, calculation of the following keys unknown.

Can you PM me, if you don't want to make your ideas public?
## Post #451
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-21T09:43:29+00:00
- Post Title: 

> Reply from maststef
>
> Are we talking about the same thing?
We talk about decrypting the text strings. They are simply XOR'd, yes, but that was known like already 2 years.
Our problem now is to find out  what they changed from old to new encryption.
Old one was: Every character was XOR'd with another value. The calculation of this "key" was "old_key + 1", starting with the key 0xAA.
New one is: Every character is XOR'd, key starts with 0x01, calculation of the following keys unknown.

Can you PM me, if you don't want to make your ideas public?

I know what is your problem, but they didn't encrpyt only the text.
They encrypted the images too.

And i already made a working extractor with this encrpytion.
## Post #452
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-21T17:05:58+00:00
- Post Title: 

> Reply from kornto
>
> maststef wrote:Are we talking about the same thing?
We talk about decrypting the text strings. They are simply XOR'd, yes, but that was known like already 2 years.
Our problem now is to find out  what they changed from old to new encryption.
Old one was: Every character was XOR'd with another value. The calculation of this "key" was "old_key + 1", starting with the key 0xAA.
New one is: Every character is XOR'd, key starts with 0x01, calculation of the following keys unknown.

Can you PM me, if you don't want to make your ideas public?

I know what is your problem, but they didn't encrpyt only the text.
They encrypted the images too.

And i already made a working extractor with this encrpytion.
I wrote an extractor, too (see my sig). That's why I don't get this discussion... 

Or wait, what do you mean by "images"? The pictures or the *.img files?

The only problem right now is the new string encryption.

Or did you mean they changed the way how the pictures are stored wz files? (the pictures are not really encrypted, just , let's say, "packed" to keep the file size small)
## Post #453
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-21T17:18:40+00:00
- Post Title: 

> Reply from maststef
>
> kornto wrote:maststef wrote:Are we talking about the same thing?
We talk about decrypting the text strings. They are simply XOR'd, yes, but that was known like already 2 years.
Our problem now is to find out  what they changed from old to new encryption.
Old one was: Every character was XOR'd with another value. The calculation of this "key" was "old_key + 1", starting with the key 0xAA.
New one is: Every character is XOR'd, key starts with 0x01, calculation of the following keys unknown.

Can you PM me, if you don't want to make your ideas public?

I know what is your problem, but they didn't encrpyt only the text.
They encrypted the images too.

And i already made a working extractor with this encrpytion.
I wrote an extractor, too (see my sig). That's why I don't get this discussion... 

Or wait, what do you mean by "images"? The pictures or the *.img files?

The only problem right now is the new string encryption.

Or did you mean they changed the way how the pictures are stored wz files? (the pictures are not really encrypted, just , let's say, "packed" to keep the file size small)
My extractor is working with KMS. I know what i am talking about.
## Post #454
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-21T17:58:58+00:00
- Post Title: 

Well, that's fine if you know what you are talking about.  But not telling these actual facts has no use in a forum that wants to discover the file structure.

Don't get me wrong, I don't want to be offensive. But the only thing you write here is, that you can extract it. But that doesn't help us.
## Post #455
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2008-01-23T05:42:23+00:00
- Post Title: 

To summarize:
The exe file is encrypted for sure.  It used to be ASprotect, but I haven't checked since before we even started this.

The new text encryption was easy to decode for the regular ASCII strings.  The unicode stuff took a bit more work and just comparing string between GMS and KTMS.  From what I found, the decryption string was different for ascii and for unicode, but they looked fairly similar so I'd assume it just has to do with the character location and the byte ("more different" as you progress through the string)

They also redid the way images are stored.  Before there was a clear zlib stream with the magic word stored at the beginning of the string.  The magic word is no longer there (or it's encrypted somehow).  Comparing the length of the images between the GMS/KTMS files showed that they were different lengths (at least the ones I checked...could have been those images were modified....I didn't really look into that much)

As for a complex encryption scheme, I doubt they would overcomplicate it.  The more encryption they add, the longer it takes to load.  XOR is used since it is super fast to do.
## Post #456
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-23T17:22:34+00:00
- Post Title: 

The same way I did decode the ASCII strings. But did you found out the math behind the new key? Or do you think there is no math (--> only random bytes in an array)?

With "magic word" do you mean the "0x78 0x9C" bytes? These are not needed for the decompression. The plain deflate algorithm (that's used in many programming libraries, so without all the additional zLib stuff) does not need them. For example, my tool is written in C#.Net, I also use the deflate algorithm from it. And it only works if I skip the first two zLib bytes (because they don't really belong to the stream, they are just saying "Here come's zLib with this or that compression level", but as stated above this is not needed to run the deflate algorithm on it).
Maybe Nexon did throw away their zLib library and switched to another deflate routine.

If you want, you can send me one of these new compressed blocks (copy and paste it in a new file) than I can check, if it is still a deflate block. (I'm not downloading KMSt, because I focus on GMS [and I can't read Korean])
## Post #457
- Username: Rusty_le_Cyborg
- Rank: advanced
- Number of posts: 48
- Joined date: Tue Jan 11, 2005 1:12 am
- Post datetime: 2008-01-23T18:06:07+00:00
- Post Title: 

> Reply from maststef
>
> Maybe Nexon did throw away their zLib library and switched to another deflate routine.

I've just posted a file from another Nexon game in [this](http://forum.xentax.com/viewtopic.php?t=2903) thread.

It's only 100kb, so it might be useful for you to find if they have changed things generally at Nexon. Though it also might not help at all! 

Cheers for now
## Post #458
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-23T19:06:53+00:00
- Post Title: 

Oh cool, Nexon works together with Valve. I didn't knew that.  
On the first view this has nothing to do with the file structure that MapleStory uses.
And in all games I saw from Nexon the file structure was different each time.
## Post #459
- Username: Rusty_le_Cyborg
- Rank: advanced
- Number of posts: 48
- Joined date: Tue Jan 11, 2005 1:12 am
- Post datetime: 2008-01-23T20:08:17+00:00
- Post Title: 

Ah, okay. I suppose it depends on the development house etc.

I suppose it was worth a look anyway!

I'll keep my fingers crossed for help with the other files, I looked through the tutorial for archive research etc, but it really is just a bunch of numbers and letters to me.. I just don't "get it".

Cheers for now
## Post #460
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-01-27T02:13:12+00:00
- Post Title: 

Hmm. I have a question, is the KMST encryption the same as MapleSEA's new encryption?
## Post #461
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-27T18:27:12+00:00
- Post Title: 

> Reply from themoviefund
>
> Hmm. I have a question, is the KMST encryption the same as MapleSEA's new encryption?

Yes, but the MapleSEA is more of a selective encryption where it's only used on certain folders as according to List.wz.
## Post #462
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-27T18:28:31+00:00
- Post Title: 

> Reply from themoviefund
>
> Hmm. I have a question, is the KMST encryption the same as MapleSEA's new encryption?
I think it is. I can not imagine that Nexon would use three different encryptions at the same time. Knowing how they mess up several things each patch or server check, they would completly mess up the wz files, too. 
This is no fact, it's just how I see it, because I have no MSEA wz file to check it, if someone has a MSEA file I could check it!

I ask my question again: Anyone already figured out some math behind the new encryption (KMSt)? I only have all the bytes needed to decrypt, found out by trial-and-error decrypting. But I can't tell where this byte order does come from...
## Post #463
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-01-31T05:53:21+00:00
- Post Title: 

Anyone got a map renderer?
## Post #464
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-01-31T12:16:30+00:00
- Post Title: 

> Reply from Tiger
>
> Anyone got a map renderer?
As far as I know, there's no public one out yet.

But I will implement one in my WZextract tool. But to do so, I will have to rewrite some parts of it. But because I'm busy with studies this may take a while (weeks or months).
## Post #465
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-01-31T20:43:21+00:00
- Post Title: 

........................
## Post #466
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-01-31T22:27:08+00:00
- Post Title: 

maststef, do you know who i'm?
## Post #467
- Username: kornto
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 24, 2007 4:53 am
- Post datetime: 2008-01-31T23:20:04+00:00
- Post Title: 

> Reply from Tiger
>
> Anyone got a map renderer?
There isn't any public map renderer.
I made one long time ago, I didn't scripted it very good, but at least it works.
## Post #468
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-02-01T00:41:51+00:00
- Post Title: 

do you think you can post it?
## Post #469
- Username: themoviefund
- Rank: advanced
- Number of posts: 61
- Joined date: Sun Jun 04, 2006 10:27 am
- Post datetime: 2008-02-01T05:24:46+00:00
- Post Title: 

Same here, kornto. I made one, but it's very buggy and some maps are completely messed up.
## Post #470
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-02-01T06:28:29+00:00
- Post Title: 

..............
## Post #471
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-02-01T08:53:13+00:00
- Post Title: 

> Reply from Tiger
>
> maststef, do you know who i'm?
Umh, what? I know you from these forums, yes. What does it have to do with this thread?

Ontopic:
Any news from the new MSEA/KMS encryption?
## Post #472
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-02-01T16:21:51+00:00
- Post Title: 

I'm the one on ur msn. jasonyip33 xD
## Post #473
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-02-16T03:25:34+00:00
- Post Title: 

Fiel, do you have any tuts on using ur NXWatch?? Cause it doesnt' work for me when I ran it.
## Post #474
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-02-18T03:47:39+00:00
- Post Title: 

This is not the place to be asking about NXWatch.

Also, I figured out the 1B blocks. They don't have "random" x/y value pairs based upon the flag. The flag is a pointer.

Flag + baseOffset points to a string. The string can be 'Property' or any of the strings found in 0x73 type. That's a hell of a lot simpler than what Lambda has.
## Post #475
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-02-18T18:12:23+00:00
- Post Title: 

JMST has moved to List.wz encryption. It wouldn't surprise me in the least if they moved that encryption to JMS as well.
## Post #476
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-02-19T01:31:38+00:00
- Post Title: 

I don't know why I can't post on sleepywood!
## Post #477
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-02-21T13:02:52+00:00
- Post Title: 

> Reply from Fiel
>
> This is not the place to be asking about NXWatch.

Also, I figured out the 1B blocks. They don't have "random" x/y value pairs based upon the flag. The flag is a pointer.

Flag + baseOffset points to a string. The string can be 'Property' or any of the strings found in 0x73 type. That's a hell of a lot simpler than what Lambda has.
0x1B is the same as 0x73. There's only one small difference, the same as it is for strings.
0x73 means "read type string here".
0x1B means "read type string at offset xxx and after this come back here and proceed like 0x73"

It just says where to read the identifier strings, so it's basically the same like with the 0x00 and 0x01 string types.
## Post #478
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-02-25T02:00:00+00:00
- Post Title: 

about the earlier scripts about map rendering, can anyone teach me how to use it?
## Post #479
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-01T01:04:53+00:00
- Post Title: 

.................
## Post #480
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-01T05:55:53+00:00
- Post Title: 

Maybe you should incorporate NXWatch with the script too?

EDIT: There is no Config.txt in ur zip file
## Post #481
- Username: Mr.Mouse
- Rank: Site Admin
- Number of posts: 4073
- Joined date: Thu Jan 16, 2003 1:45 am
- Post datetime: 2008-03-01T20:13:10+00:00
- Post Title: Re: .wz archive

Just wanted to say you guys are doing great work on this format! Keep it up!
## Post #482
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-05T01:06:37+00:00
- Post Title: Re: .wz archive

maststef, GRATZ to getting the map renderer done!!


EDIT: I suggest seperating the rendering tool so it can be used for mass render.
## Post #483
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-03-05T08:20:13+00:00
- Post Title: Re: .wz archive

> Reply from Tiger
>
> maststef, GRATZ to getting the map renderer done!!


EDIT: I suggest seperating the rendering tool so it can be used for mass render.
No. WZextract is built to be a browser. Means: view only the pictures and information you need, without need to extract everything.
Why do you need every Map anyway?
## Post #484
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-06T06:36:56+00:00
- Post Title: Re: .wz archive

Cause some people like to put their own stuff on the maps and make a manga xD
## Post #485
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-03-06T17:59:09+00:00
- Post Title: Re: .wz archive

> Reply from Tiger
>
> Cause some people like to put their own stuff on the maps and make a manga xD
You won't need all and every map at once. You may need 3 or 4 Maps. And it's not to hard to do 2 clicks for each Map to render them
## Post #486
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-09T21:53:27+00:00
- Post Title: Re: .wz archive

Then how about a whole section render?? Under map, there's map 1, 2,3,4, or soemthign like that. And under the section there are different maps. How about whole section render?
## Post #487
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-03-09T22:56:28+00:00
- Post Title: Re: .wz archive

> Reply from Tiger
>
> Then how about a whole section render?? Under map, there's map 1, 2,3,4, or soemthign like that. And under the section there are different maps. How about whole section render?No. It would basically be the same code. If I'd implement that, then I could directly integrate a full batch renderer.

Be happy with what others provide you for free. Or learn to code your own.
## Post #488
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-10T02:29:46+00:00
- Post Title: Re: .wz archive

fine fine
## Post #489
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-10T20:04:26+00:00
- Post Title: Re: .wz archive

Well, I actually figured out list.wz encryption. These encryption methods are crap.

And I didn't just use brute force switching methods throughout the WZ files. In other words, I didn't just try one encryption, if that one failed switch to the other. I mean I actually figured out list.wz.
## Post #490
- Username: AngelSL
- Rank: beginner
- Number of posts: 29
- Joined date: Mon May 07, 2007 9:06 pm
- Post datetime: 2008-03-11T08:03:53+00:00
- Post Title: Re: .wz archive

> Reply from Fiel
>
> Well, I actually figured out list.wz encryption. These encryption methods are crap.

And I didn't just use brute force switching methods throughout the WZ files. In other words, I didn't just try one encryption, if that one failed switch to the other. I mean I actually figured out list.wz.

Grats to Maststef for completing his map renderer..

Grats to Fiel for cracking KMS(t) encryption!

BTW, Maststef, I'm AngelSL from Sleepywood.
## Post #491
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-15T01:22:29+00:00
- Post Title: Re: .wz archive

.................
## Post #492
- Username: Rick
- Rank: Moderator
- Number of posts: 388
- Joined date: Wed Aug 10, 2005 5:10 am
- Post datetime: 2008-03-15T09:32:33+00:00
- Post Title: Re: .wz archive

I'm fairly certain that python supports bitshifting, why aren't you taking advantage of it?
## Post #493
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-03-15T10:11:11+00:00
- Post Title: Re: .wz archive

> Reply from Fiel
>
> I'm not going to bother to code for a Format_BIN picture unless Wizet begins using this format for their pictures. I hope this helps you guys with your extractors!
There it is:
Map/midForest.img/back.0.png Format_BIN

I wrote you a PM on SW with the Python code.

edit: I adviced him Bitshifting as well, in the PM.  

edit2: I just saw your guess on the logo: Yes, you are right. This is exactly the reason why the Python script does not get it right.
## Post #494
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-15T16:07:01+00:00
- Post Title: Re: .wz archive

Yes, Rick, Python does support bitshifting, but I wasn't aware of this until just yesterday.

As it is, Lambda's code is really weird. He adds in RG to R and then reduces to 255 and... there's no need for modulo calculations here either. It's all a little crazy.

Just by implementing the code in my previous post, I managed to slice 10 minutes off of each core on a fresh extraction when using the dual core approach. I'd say that's plenty of time saved going through needless if-statements.

Furthermore, I have to make a change to the way that the cache works in the python script. At the moment, the cache isn't working properly. I'll be submitting a fix for this soon enough.
## Post #495
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-03-16T06:57:20+00:00
- Post Title: Re: .wz archive

Maststef, that's a great update on your viewer!
## Post #496
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-20T16:28:52+00:00
- Post Title: Re: .wz archive

.................
## Post #497
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2008-03-21T20:45:17+00:00
- Post Title: Re: .wz archive

I would highly recommend not including the python installer in each release since that's easily available from the website and that's what's taking most of the space in the download (instead of 10 seconds, it takes 2-3 minutes).
## Post #498
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-03-26T20:12:14+00:00
- Post Title: Re: .wz archive

I've been going over the extraction files, and I can only find few optimizations now.

The important thing to remember in optimizing this script is that struct calls are computationally expensive and should be done in batch calls rather than unpacking one by one. The only other things I could find to increase speed would be to reduce the zlib compression (nine is too extreme, five or six is just fine).

Any other optimization would come from using different modules for Python, such as NumPy. For example, this module would allow you to change the string decryption function to the following:

```
  keys = arange(0xAA, 0xAA + len(encStr)) & 0xFF
  keys ^= encStr
  return keys.astype(int8).tostring()

```


The inner loops in this function are using C, so the speed increase comes from not having an interpreted Python loop.

As far as the memory consumption, that comes from the inherent weakness of the Python tuple. A programmer can store anything in a tuple from an int to a float, from a simple string to a Harvard graduate dissertation. Python doesn't care. However, the inherent flaw is that Python creates each single character of a string or each number as a float or longlong, and that's memory expensive. I could create an array (using the array module) to make all numbers unsigned bytes, however that's computationally expensive (it shouldn't be so, but alas it is). So, there has to be something in between that I haven't found yet. 

I'll have to look into this a little bit more before I give up on it.
## Post #499
- Username: Omega
- Rank: advanced
- Number of posts: 56
- Joined date: Wed Aug 23, 2006 12:15 am
- Post datetime: 2008-03-28T00:47:42+00:00
- Post Title: Re: .wz archive

You might want to try pushing some of the functions out to a C DLL and just calling them directly.  The string decryption routine and the image data conversion routines may be useful to pull out.
## Post #500
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-04-12T16:20:44+00:00
- Post Title: Re: .wz archive

Okay, I've completely figured out KMST Unicode. You do not need to know Korean to decrypt it, but it's a PITA regardless.

I've been working on pushing certain functions out to a C DLL. It's going to take me a while if I can only do this in my spare time.
## Post #501
- Username: tabletop
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 27, 2008 6:58 am
- Post datetime: 2008-05-27T15:38:58+00:00
- Post Title: Re: .wz archive

> Reply from Fiel
>
> Okay, I've completely figured out KMST Unicode. You do not need to know Korean to decrypt it, but it's a PITA regardless.

Sorry for the long bump, but I am curious about this.

So, how exactly you figured it out? I made a python scrypt based on Alan Horne's Maplext (for the sake to practice python   and since its much cleaner than Lambda's scrypt) and I just don't know how this new encryption works. All I have read over here is that the unicode key starts in another offset other than 0xaaaa..
## Post #502
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-05-28T07:15:41+00:00
- Post Title: Re: .wz archive

We'd like to keep this private. When the whole extraction thing was widely spread, Nexon changed the encryption. We don't want this to happen again.

But it's not like it just starts on another value than 0xAA. There's a whole new algorithm that is way harder to crack than just the old incremental XORing.
## Post #503
- Username: tabletop
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 27, 2008 6:58 am
- Post datetime: 2008-05-29T20:31:40+00:00
- Post Title: Re: .wz archive

> Reply from maststef
>
> We'd like to keep this private. When the whole extraction thing was widely spread, Nexon changed the encryption. We don't want this to happen again.

I totally understand your reason to keep it private, in fact I don't share my current extractor for the same reason as yours. All I am asking is for a small insight of how to start, I can figure out the rest.
## Post #504
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-05-30T06:34:24+00:00
- Post Title: Re: .wz archive

> Reply from tabletop
>
> I totally understand your reason to keep it private, in fact I don't share my current extractor for the same reason as yours. All I am asking is for a small insight of how to start, I can figure out the rest.
Where to start? Learn about encyrption algorithms. Take the encrypted text, compare it with the old, try some things with different algorithms.
That's how it always works.
## Post #505
- Username: tabletop
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Tue May 27, 2008 6:58 am
- Post datetime: 2008-05-30T19:34:12+00:00
- Post Title: Re: .wz archive

> Reply from maststef
>
> tabletop wrote:I totally understand your reason to keep it private, in fact I don't share my current extractor for the same reason as yours. All I am asking is for a small insight of how to start, I can figure out the rest.
Where to start? Learn about encyrption algorithms. Take the encrypted text, compare it with the old, try some things with different algorithms.
That's how it always works.

Hmm.. I think I found something, but I am not quite sure about it. If it's ok with you, can I discuss this with you through pms?
## Post #506
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-06-04T00:27:02+00:00
- Post Title: Re: .wz archive

Just a heads up, Nexon will probably change the encryption because of the hacking in maplestory using wz edit.
## Post #507
- Username: Mirage
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Fri Jun 06, 2008 1:44 pm
- Post datetime: 2008-06-09T04:02:49+00:00
- Post Title: Re: .wz archive

It doesn't work on the newest JMS Client ver 1.44.
Could someone make it available for JMS wz file ?

Because I know PHP,
I can figure out the structure of this extractor vaguely.
But I don't know Python well.
It is a little bit difficult for me to edit dump.py file.

I have managed JMS database web site since a few years ago.
If dump.py works normally, it will be a big help.

I am waiting for someone's reply.
Thank you.
## Post #508
- Username: rako
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Tue Apr 08, 2008 6:34 pm
- Post datetime: 2008-06-15T00:52:55+00:00
- Post Title: Re: .wz archive

has anyone taken a look at the new tespia encryption? they completely changed the encryption of everything. it doesn't use list.wz but it is very similar to what they implemented on some of mob.wz
## Post #509
- Username: Fiel
- Rank: advanced
- Number of posts: 46
- Joined date: Mon Dec 17, 2007 1:29 am
- Post datetime: 2008-06-18T11:15:24+00:00
- Post Title: Re: .wz archive

> Reply from rako
>
> has anyone taken a look at the new tespia encryption? they completely changed the encryption of everything. it doesn't use list.wz but it is very similar to what they implemented on some of mob.wz

It does use List.wz. Anyone who says otherwise is a bumbling idiot.

I've decrypted it myself.
## Post #510
- Username: rako
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Tue Apr 08, 2008 6:34 pm
- Post datetime: 2008-06-21T13:40:21+00:00
- Post Title: Re: .wz archive

> Reply from Fiel
>
> rako wrote:has anyone taken a look at the new tespia encryption? they completely changed the encryption of everything. it doesn't use list.wz but it is very similar to what they implemented on some of mob.wz

It does use List.wz. Anyone who says otherwise is a bumbling idiot.

I've decrypted it myself.

sorry I am a bit silly I haven't downloaded the new tespia but I thought my source was reliable (I'll check before I say anything next time). 

Anyway I'm completely stuck on the new v.56 encryption. list.wz has been changed and doesn't want to operate the way it used to. any help would be great if you have any info. list.wz dosen't seem that different then it used to i think thay may have just changed around a few characters but I never fully cracked it.
## Post #511
- Username: mapletip
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Wed Aug 29, 2007 1:28 am
- Post datetime: 2008-06-21T19:27:20+00:00
- Post Title: Re: .wz archive

You're not missing much, here's the new List.wz

```
mob/0100100.img
mob/0100101.img
mob/0120100.img
mob/0130100.img
mob/0130101.img
mob/0210100.img
mob/1110100.img
mob/1110101.img
mob/1120100.img
mob/1130100.img
mob/1140100.img
mob/1210100.img
mob/1210101.img
mob/1210102.img
mob/1210103.img
mob/2100100.img
mob/2100101.img
mob/2100102.img
mob/2100103.img
mob/2100104.img
mob/2100105.img
mob/2100106.img
mob/2100107.img
mob/2100108.img
mob/2110200.img
mob/2110300.img
mob/2110301.img
mob/2130100.img
mob/2130103.img
mob/2220000.img
mob/2220100.img
mob/2230100.img
mob/2230101.img
mob/2230102.img
mob/2230103.img
mob/2230104.img
mob/2230105.img
mob/2230106.img
mob/2230107.img
mob/2230108.img
mob/2230109.img
mob/2230110.img
mob/2230111.img
mob/2230200.img
mob/2300100.img
mob/3000000.img
mob/3000001.img
mob/3000002.img
mob/3000003.img
mob/3000004.img
mob/3000005.img
mob/3000006.img
mob/3100101.img
mob/3100102.img
mob/3110100.img
mob/3110101.img
mob/3110102.img
mob/3110300.img
mob/3110301.img
mob/3110302.img
mob/3110303.img
mob/3210100.img
mob/3210200.img
mob/3210201.img
mob/3210202.img
mob/3210203.img
mob/3210204.img
mob/3210205.img
mob/3210206.img
mob/3210207.img
mob/3210208.img
mob/3210450.img
mob/3210800.img
mob/3220000.img
mob/3230100.img
mob/3230101.img
mob/3230102.img
mob/3230103.img
mob/3230104.img
mob/3230200.img
mob/3230300.img
mob/3230301.img
mob/3230302.img
mob/3230303.img
mob/3230304.img
mob/3230305.img
mob/3230306.img
mob/3230307.img
mob/3230308.img
mob/3230400.img
mob/3230405.img
mob/4090000.img
mob/4110300.img
mob/4110301.img
mob/4110302.img
mob/4130100.img
mob/4130101.img
mob/4130102.img
mob/4130103.img
mob/4130104.img
mob/4230100.img
mob/4230101.img
mob/4230102.img
mob/4230103.img
mob/4230104.img
mob/4230105.img
mob/4230106.img
mob/4230107.img
mob/4230108.img
mob/4230109.img
mob/4230110.img
mob/4230111.img
mob/4230112.img
mob/4230113.img
mob/4230114.img
mob/4230115.img
mob/4230116.img
mob/4230117.img
mob/4230118.img
mob/4230119.img
mob/4230120.img
mob/4230121.img
mob/4230122.img
mob/4230123.img
mob/4230124.img
mob/4230125.img
mob/4230126.img
mob/4230200.img
mob/4230201.img
mob/4230300.img
mob/4230400.img
mob/4230500.img
mob/4230501.img
mob/4230502.img
mob/4230503.img
mob/4230504.img
mob/4230505.img
mob/4230506.img
mob/4230600.img
mob/4240000.img
mob/5100000.img
mob/5100001.img
mob/5100002.img
mob/5100003.img
mob/5100004.img
mob/5100005.img
mob/5110300.img
mob/5110301.img
mob/5110302.img
mob/5120000.img
mob/5120001.img
mob/5120002.img
mob/5120003.img
mob/5120100.img
mob/5120500.img
mob/5120501.img
mob/5120502.img
mob/5120503.img
mob/5120504.img
mob/5120505.img
mob/5120506.img
mob/5130100.img
mob/5130101.img
mob/5130102.img
mob/5130103.img
mob/5130104.img
mob/5130105.img
mob/5130106.img
mob/5130107.img
mob/5130108.img
mob/5140000.img
mob/5150000.img
mob/5150001.img
mob/5200000.img
mob/5200001.img
mob/5200002.img
mob/5220000.img
mob/5220001.img
mob/5300000.img
mob/5300001.img
mob/5300100.img
mob/5400000.img
mob/6090000.img
mob/6110300.img
mob/6110301.img
mob/6130100.img
mob/6130101.img
mob/6130102.img
mob/6130103.img
mob/6130104.img
mob/6130200.img
mob/6130201.img
mob/6130202.img
mob/6130203.img
mob/6130204.img
mob/6130207.img
mob/6130208.img
mob/6130209.img
mob/6230100.img
mob/6230101.img
mob/6230200.img
mob/6230201.img
mob/6230300.img
mob/6230400.img
mob/6230401.img
mob/6230500.img
mob/6230600.img
mob/6230601.img
mob/6230602.img
mob/6300000.img
mob/6300001.img
mob/6300002.img
mob/6300003.img
mob/6300004.img
mob/6300005.img
mob/6300100.img
mob/6400000.img
mob/6400001.img
mob/6400002.img
mob/6400003.img
mob/6400004.img
mob/6400100.img
mob/7110300.img
mob/7110301.img
mob/7130000.img
mob/7130001.img
mob/7130002.img
mob/7130003.img
mob/7130004.img
mob/7130010.img
mob/7130020.img
mob/7130100.img
mob/7130101.img
mob/7130102.img
mob/7130103.img
mob/7130104.img
mob/7130200.img
mob/7130300.img
mob/9300129.img
mob/9300130.img
mob/9300131.img
mob/9300132.img
mob/9300133.img
mob/9300134.img
mob/9300135.img
mob/9300136.img
mob/9300137.img
mob/9300138.img
mob/9300139.img
mob/9300140.img
mob/9300141.img
mob/9300142.img
mob/9300143.img
mob/9300144.img
mob/9300145.img
mob/9300146.img
mob/9300147.img
mob/9300148.img
mob/9300149.img
mob/9300150.img
mob/9300151.img
mob/9300152.img
mob/9300153.img
mob/9300154.img
mob/9300155.img
mob/9300156.img
mob/9300157.img
mob/9300158.img
mob/9300159.img
mob/9300160.img
mob/9300161.img
mob/9300162.img
mob/9300163.img
mob/9300164.img
mob/9300165.img
mob/9300166.img
mob/9300169.img
mob/9300170.img
mob/9300171.img
mob/9300172.img
mob/9300173.img
mob/9300174.img
mob/9300175.img
mob/9300176.img
mob/9300177.img
mob/9300178.img
mob/9300179.img
mob/9300180.img
mob/9300181.img
mob/9300182.img
mob/9300183.img
mob/9300184.img
mob/9300185.img
mob/9300186.img
mob/9300187.img
mob/9300188.img
mob/9300189.img
mob/9300190.img
mob/9300191.img
mob/9300192.img
mob/9300193.img
mob/9300194.img
mob/9300195.img
mob/9410000.img
mob/9410001.img
mob/9410002.img
mob/9410003.img
mob/9410004.img
mob/9410005.img
mob/9410006.img
mob/9410007.img
mob/9410008.img
mob/9410009.img
mob/9410010.img
mob/9410011.img
mob/9410012.img
mob/9410013.img
mob/9410014.img
mob/9500184.img
mob/9500185.img
mob/9500186.img
mob/9500187.img
mob/9500188.img
mob/9500189.img
mob/9500190.img
mob/9500191.img
mob/9500192.img
mob/9500193.img
mob/9500194.img
mob/9500195.img
mob/9500196.img
mob/9500197.img
mob/9500198.img
mob/9500199.img
mob/9500300.img
mob/9500301.img
mob/9500302.img
mob/9500303.img
mob/9500304.img
mob/9500305.img
mob/9500306.img
mob/9500307.img
mob/9500308.img
mob/9500309.img
mob/9500310.img
mob/9500311.img
mob/9500312.img
mob/9500313.img
mob/9500314.img
mob/9500315.img
mob/9500316.img
mob/9500317.img
mob/9500318.img
mob/9500319.img
mob/9500320.img
mob/9500321.img
mob/9500322.img
mob/9500323.img
mob/9500324.img
mob/9500325.img
mob/9500326.img
mob/9500327.img
mob/9500328.img
mob/9500329.img
mob/9500330.img
mob/9500331.img
mob/9500332.img
mob/9500333.img
mob/9500334.img
mob/9500335.im/
```
## Post #512
- Username: Tiger
- Rank: beginner
- Number of posts: 34
- Joined date: Thu Aug 02, 2007 11:43 pm
- Post datetime: 2008-06-26T19:10:02+00:00
- Post Title: Re: .wz archive

The contents of this post was deleted because of possible forum rules violation.
## Post #513
- Username: maststef
- Rank: beginner
- Number of posts: 37
- Joined date: Thu Aug 30, 2007 3:19 pm
- Post datetime: 2008-09-09T12:25:55+00:00
- Post Title: Re: .wz archive

I just wanted to ask, if someone else is still working on the format?

Or are Fiel and I the last two people on this planet working on reverse engeneering the wz files?
## Post #514
- Username: jenyip
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Thu Sep 18, 2008 1:27 pm
- Post datetime: 2008-09-18T06:14:35+00:00
- Post Title: Re: .wz archive

You guys are probably the last ones. However, i really want to learn how to do it. Can you personally help me, like give some step by step directions? I seriously won't release to the public, I know how it is. I know when something of your hard work get's leaked, it feels really bad. I know, cause i have had a pserver source, but it got leaked by one of the admins, so I decided to close it down. I really wanna learn about the wz and the encryptions!
## Post #515
- Username: Darkfox
- Rank: VVIP member
- Number of posts: 688
- Joined date: Sat Jul 05, 2003 1:11 am
- Post datetime: 2008-09-18T12:07:07+00:00
- Post Title: Re: .wz archive

It is more like... program goes everywhere... BAM, new encryption.

Edit: Though this may not be a good show on the developer's part. I mean, lately, instead of worrying about making their game better they just focus on what extractor/decrypter programs are out there. Tsk tsk. If I was making an MMO, that'd be my primary focus, the game itself.
## Post #516
- Username: hyperviper
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Sat Mar 27, 2010 12:15 am
- Post datetime: 2010-08-28T12:51:25+00:00
- Post Title: Re: .wz archive

hello,

this is a program that exact all Data out all Wz works witch al wz
All Data out map.wz all data out Character.wz

i think you all can use it but i want That anybody its edit for my because:
he exact it literal 
for example:
MAp.wz\obj\acc1_img\darkwood\artificiality\0\0\PNG
MAp.wz\obj\acc1_img\darkwood\artificiality\1\1\PNG
MAp.wz\obj\acc1_img\darkwood\artificiality\2\2\PNG
etc.

i want it so:

MAp.wz\obj\acc1_img\darkwood\artificiality\0.PNG
MAp.wz\obj\acc1_img\darkwood\artificiality\1.PNG
MAp.wz\obj\acc1_img\darkwood\artificiality\2.PNG
or
MAp.wz\obj\acc1_img\darkwood\art 0.PNG

How to program works:

when you run it he say:
Please enter the maplestory folder location <or just press enter if you are running this application from maplestory folder>

It don't work that you can press enter when you are running this application from maplestory folder
you need always type where it is For my is it
C:\nexon\maplestory

then he say:
Please enter a filter for the files ( he meens the wz)
example: map.wz or Data.wz

Then wait you can see where he is with exacting


Sorry for my bad english
[Extractor.rar](https://xentaxbackup.github.io/file/3379_Extractor.rar)
