## Post #1
- Username: pceengied
- Rank: beginner
- Number of posts: 30
- Joined date: Sat Jan 23, 2010 2:55 am
- Post datetime: 2010-12-28T08:11:21+00:00
- Post Title: Soul Calibur 3  Modding

For current work on this game, please see the [Soul Calibur 3 megathread](https://forum.xentax.com/viewtopic.php?f=29&t=22497).
## Post #2
- Username: pceengied
- Rank: beginner
- Number of posts: 30
- Joined date: Sat Jan 23, 2010 2:55 am
- Post datetime: 2010-12-28T08:47:30+00:00
- Post Title: Soul Calibur 3  Modding

sc3

File7.olk:
1 - 4
9 - 315 Standard Model data
319 - 368
369 - 576 cas model
577 - 626 Standard Animation 
627 - 1181 Bonus Model
1182, 1183
1184 - 1259
1260 - 1391
1392 - 1413 Bonus Animation

///////////////////////////////////////////////////////////////////////////////
// Standard Model data
///////////////////////////////////////////////////////////////////////////////

9 10 Mitsurugi
17 18 Mitsurugi Edit

21 22 Seung Mina
29 30 Seung Mina Edit

33 34 Taki
41 42 Taki Edit

45 46 Maxi
53 54 Maxi Edit

57 58 Voldo
65 66 Voldo Edit

69 70 Sophitia
77 78 Sophitia Edit

81 82 Siegfried
89 90 Siegfried Edit

93 94 Rock
101 102 Rock Edit

105 106 Ivy
113 114 Ivy Edit

117 118 Kilik
125 126 Kilik Edit

129 130 Xianghua
137 138 Xianghua Edit

141 142 Lizardman
149 150 Lizardman Edit

153 154 Yoshimitsu
161 162 Yoshimitsu Edit

165 166 Nightmare
173 174 Nightmare Edit

177 178 Astaroth 
185 186 Astaroth  Edit

189 190 Cervantes 
197 198 Cervantes Edit

201 202 Raphael 
209 210 Raphael Edit

213 214 Talim
221 222 Talim Edit

225 226 Cassandra 
233 234 Cassandra Edit

237 238 Yun Seong
245 246 Yun Seong Edit


249 SC2 Lizardmen (red)

255 256 Setsuka
263 264 Setsuka Edit

267 268 Tira
275 276 Tira Edit

279 280 Zasalamel
287 288 Zasalamel Edit

291 292 Olcadan
299 300 Olcadan Edit

303 304 Abyss
311 312 Abyss Edit

315 Night Terror

///////////////////////////////////////////////////////////////////////////////
// Standard Animation data
///////////////////////////////////////////////////////////////////////////////

577 Mitsurugi Moveset
578 Mitsurugi Exhibition

579 Seong Mina Moveset
580 Seong Mina Exhibition

581 Taki Moveset
582 Taki Exhibition

583 Maxi Moveset
584 Maxi Exhibition

585 Voldo Moveset
586 Voldo Exhibition

587 Sophitia Moveset
588 Sophitia Exhibition

589 Siegfried Moveset
590 Siegfried Exhibition

591 Rock Moveset
592 Rock Exhibition

593 Ivy Moveset
594 Ivy Exhibition

595 Kilik Moveset
596 Kilik Exhibition

597 Xianghua Moveset
598 Xianghua Exhibition

599 Lizardman Moveset
600 Lizardman Exhibition

601 Yoshimitsu Moveset
602 Yoshimitsu Exhibition

603 Nightmare Moveset
604 Nightmare Exhibition

605 Astaroth Moveset
606 Astaroth Exhibition

607 Cervantes Moveset
608 Cervantes Exhibition

609 Raphael Moveset
610 Raphael Exhibition

611 Talim Moveset
612 Talim Exhibition

613 Cassandra Moveset
614 Cassandra Exhibition

615 Yun Seong Moveset
616 Yun Seon Exhibition

617 Setsuka Moveset
618 Setsuka Exhibition

619 Tira Moveset
620 Tira Exhibition

621 Zasalamel Moveset
622 Zasalamel Exhibition

623 Olcadan Moveset

624 Abyss Moveset
625 Abyss Exhibition

626 NightTerror Moveset

///////////////////////////////////////////////////////////////////////////////
// Bonus Model data
///////////////////////////////////////////////////////////////////////////////

627 628 Charade

629 630 Charade Legs

631 632 Charade Eyeball

633 634 Will' o' the' wisp (red)
635 Will' o' the' wisp Green
636 Seong Mina

637 638 Doppleganger

639 640 ShadowMaster

641 642 Amy

643 644 Colossus

647 648 Zasalamel (Old Man)
655 656 Zasalamel (Old Man) Edit

645 646 SC2 Lizardmen (yellow)

659 660 Lizardman (w/ Crown)
667 668 Lizardman Edit (w/ Crown)

671 Lizardman (w/ Voldo's mask)

681 Colorful Lizardman w/ no tail

682 Red/Green Lizardman w/ no tail

705 706 Miser

709 710 Greed

713 714 Arthur

717 718 Hwang

721 722 Luna

725 726 Valeria

729 730 Hualin

733 734 Girardo

737 738 Demuth

741 742 Arelia

745 746 Chester

749 750 Strife

753 754 Abelia

757 758 Lynette

761 762 Li Long

765 766 Revenant

769 Lynette

771 Valeria

773 Hualin

775 Berzerker

777 778 Samurai

781 785 Gladiator

789 793 797 Unknown Soul

801 805 806 809 810 811 812 FumaNinja

813 817 818 Bandit

821 Thief

825 Thief

829 830 831 833 836 Pirate

837 Assassin

841 Swordsman

845 FootSoldier

849 840 General

853 Sentrey

857 Kares

861 Dragon

865 868 872 878 Ninja

881 883 905 923 Assassin

897 899 913 Samurai

937 Sage

983 Night

1073 Dancer

1107 Gladiator

1114 Assassin

1123 Night

1124 1125 1126 Pirate

1129 1130 1131 Night

1137 1138 Abelia

1139 Abelia in Pink Dress

1140 Unused Female CaS model

1144 Unused Male CaS model (has female voice)

1146 Girardo

1148 Unused female CaS model (has male voice)

1151 Thief

1154 Demuth

1158 

1163 

1165 Ella

1171 Rellen

1172 Rowan

1174 Keerkes

1178 Mooncalf

1180 Ende

1181 Scrapped CotS character model

///////////////////////////////////////////////////////////////////////////////
// Bonus Animation data
///////////////////////////////////////////////////////////////////////////////

1392 Amy moveset

1393 Collossus Moveset

1394 Lizardman Prototype Moveset

1395 Hovering in the air (unplayable)

1396 Revenant Prototype (unplayable)

1397 Miser Moveset

1398 Greed Moveset

1399 Arthur Moveset

1400 Hwang Moveset

1401 Luna Moveset

1402 Valeria Moveset

1403 Hualin Moveset

1404 Girardot Moveset

1405 Demuth Moveset

1406 Aurelia Moveset

1407 Chester Moveset

1408 Stife Moveset

1409 Abelia Moveset

1410 Lynette Moveset

1411 Li Long Moveset

1412 Revenant Moveset

1413 Standing Stance

///////////////////////////////////////////////////////////////////////////////
// Stage data (incomplete)
///////////////////////////////////////////////////////////////////////////////

File 5.olk:

1 - Mountain Top
15 - Egyptian Temple Ruin
22 - Egyptian Temple (Minimum)
29 - Egyptian Temple (Minimum & Cage)
41 - Clock Tower

239 - Underground Buddhist Sanctum

273 - Grand Labyrinth
280 - Grand Labyrinth (Darkness)
287 - Grand Labyrinth (Corridor)
299 - Sacred Mt. Fuji - Lava bed
313 - Lost Cathedral - Ruin
327 - Pirate Raid
341 - Jyurakudai Villa
355 - Romanian Valley - Castle Siege
369 - Lotus Garden
383 - Old Toledo Burning Gallery
397 - Silk Road Ruin
411 - Chaos - Spiritual Realm

425 - Weapons & Armor Room

432 - Weapons Shop
439 - Armor Shop
446 - Items Shop

747 - Game Menu 'Water'
761 - Start Screen 'Soul Calibur 3 Logo'
775 - CaS Mode 'Blue Flying Rocks'
## Post #3
- Username: mariokart64n
- Rank: ultra-veteran
- Number of posts: 586
- Joined date: Sun Jun 05, 2005 7:00 pm
- Post datetime: 2010-12-28T09:32:08+00:00
- Post Title: Soul Calibur 3  Modding

SC2 is easier to mod, I was trying to get the models from SC3, but they're stored funny
## Post #4
- Username: pringerx
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jan 07, 2011 2:18 am
- Post datetime: 2011-01-06T20:18:42+00:00
- Post Title: Soul Calibur 3  Modding

I'm very interested in getting my hands on SC3 models as well, and I could barely found anything about its model format, so I've been cracking at it for the last few days.  Here's what I've documented so far... (massive infodump incoming)

At the start of each model file is some unknown data, then shader/material data which are float arrays, then more unknown data, then the start of the mesh data, which takes up the majority of the file.

Mesh data:
01010001 = Start of object

There are 2 different types of mesh data.

TYPE 1:
Type 1 has multiple sets of data separated by data type as follows:

0380xx6C = Vertices (xx = Number of entries of the specified type)
0480xx68 = Normals

0280xx6C
 -or-	         =  ? (xx is the same as the number of verts and normals)
0280xx60

0180xx64 = Texture coords

With the 0280xx60 type, all entries are 00000043 (just 4 bytes).
With the 0280xx6C type, entries are 16 bytes and always end with 00000043, but the preceding three sets of 4 bytes are 
 a. Always identical
 b. Either 00000043 OR
    xxxxxxyy
	where xxxxxx a value like 000080, CDCCCC, 9A9999, etc.
	and yy is either 42 or 41.

The complete header is as follows:

01010001 0080016C xx800000 00403E30 12040000 yy000000 04010001 DataType

xx is some non-unique integer; my initial guess was that it's a shader/texture reference, but changing it either had no result or created strange rendering glitches, so I'm not sure.
yy is either 0F or 0E. Not sure if it's significant.
DataType is one of the various 0x80yy6z formats above.

TYPE 2:
Type 2 objects always have the data type 0080xx6C.

Type 2 is used for the majority of mesh data, and puts the normal, texture, bone index, and bone weight data together with each vertex in chunks like so (each line is 16 bytes):

VertX   VertY   VertZ   Weight
NormX NormY NormZ BoneIndex? [ChunkEnd]
TexX	   TexY    1.0     Connection
00000043 00000043 00000043 00000043

BoneIndex is weird. At first glance it appears to be a one-byte int bone index, however the values are always multiples of four; knowing this I figured it might actually be a 6-bit integer just shifted left. However, changing this to non-multiples of 4 resulted in the vertices attaching to other, valid bones, so it must be getting translated somehow. Also, there aren't enough indices being used versus the number of bones in the model; for example, in Tira's model there are only 28 different indices used, which is maybe enough for one complete arm.

(ChunkEnd explained in a second)

The texture coordinates are always followed by a 0000803f, and then either a 00 or 01. This is simply connection data; polygons are connected in order for vertices (i-1,i,i+1) except when the connection data for i+1 is 01. (Vertices with 01 as connection data always come in pairs.)

Each chunk simply ends with 00000043 00000043 00000043 00000043.

It would be nice and simple if it stuck to this format, but when multiple bone weights are defined per vertex, suddenly the chunks have multiple vertex/normal line pairs, like so:

VertLine
NrmLine
[VertLine
NrmLine]...
TexLine
(Terminator)

In this case, the vertices and normals are actually different in each line pair. This is really bizarre, but looking at the weight data it's apparent that they always add up to one for each chunk. So, the different vertices and normals must somehow be relational to the bones they reference. From what I can tell from tweaking these positions, each vertex position is actually local to the bone referenced, using the bone's local coordinate space as well; this was obvious since modifying the x value of each coordinate resulted in different movements in world space. This is pretty much verified if you try to read the verts as being in world space, as you end up with a mass that's twisted and curled in on itself around the origin:



(That's Tira's torso.) But look, the UVs are perfect!



Finally, ChunkEnd simply notes the end of the vert/normal pairs in each chunk; it is 80 on the last pair, otherwise it is 00.

The complete header for this type of object is shorter than the first:

01010001 DataType xx800000 00403E30 12040000 yy000000

xx is presumably the same as in the header for the first object type (whatever it is).
yy, instead of 0F or 0E, is either 00 or 01.


Joint/Skeleton data

Here's where stuff gets hazy. First of all, the bone data starts immediately after the model data without any apparent header, so I'm not sure if there's something that tells how many mesh pieces there are or what. As for the joint format… I have no idea what most of this stuff is, so here's an example of one joint's data chunk:

F90609B3 CA9100B3 1F03B3B1 0000803F
00000000 00000000 04ADC08A 0000803F
00000000 00000080 0000803E xxxx1400
0000803F 0000803F 00000000 ??aabbcc

Line 1: Don't know.
Line 2: Position in local coordinate space
Line 3: Don't know.  xxxxxx is some non-unique integer, generally counts upward over length of bone data
Line 4: This is bone bb, whose parent is aa. Root bones have a parent of FF. It seems that if this bone is physics-enabled, ?? is filled with another integer. cc appears to be some sort of group value, as related joints have the same value here (eg. 02 = hands, 03 = face).

After the bone data there's some more unknown data (more increasing integers), and then what I assume is texture data.

*Phew*

OK, so what's really stumping me right now is how the bone indices given in the model data are related to the skeleton. If anyone has ideas, I'm all ears. I'm pretty sure this is the only (big) thing left to solve before I can take a stab at writing a proper translator for the meshes. (I already wrote a crappy one, which is how I obtained the mess above.) Also this is the first time I've ever done this sort of stuff, so there's a good chance I'm missing some really obvious things :)
## Post #5
- Username: mariokart64n
- Rank: ultra-veteran
- Number of posts: 586
- Joined date: Sun Jun 05, 2005 7:00 pm
- Post datetime: 2011-01-06T22:09:36+00:00
- Post Title: Soul Calibur 3  Modding

when I asked fatduck to look into it, his attempt looked imploded.. something appeared to be influencing the mesh positions.

is that what your seeing aswell? or are they whole parts, just the parts are rotated and centered to origin. guess we need to figure out bones and weights :\ soo close ^,^

good work by the way.
## Post #6
- Username: pringerx
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jan 07, 2011 2:18 am
- Post datetime: 2011-01-06T23:53:41+00:00
- Post Title: Soul Calibur 3  Modding

Yeah, it was like all the individual vertices were imploded around the origin.  From messing around with vertex and joint positions my best guess is that the joints are oriented with the x-axis forward (toward the next joint), and then the vertex positions use the bone's local coordinate space.
Basically, I figured out where a vertex was on the model, and then by looking at other nearby vertices, made a guess as to what each of the bones listed were (spine,shoulder,whatever).  Then, whenever I tweaked the x position of the vertex, it would always move forward along the bone, and tweaking the y position always resulted in vertex moving tangent to the bone.  So I'm pretty confident that this is how they're stored.
## Post #7
- Username: falconcool
- Rank: veteran
- Number of posts: 105
- Joined date: Tue Jun 16, 2009 11:41 am
- Post datetime: 2011-01-18T11:21:53+00:00
- Post Title: Soul Calibur 3  Modding

TYPE 2:
Type 2 objects always have the data type 0080xx6C.

Type 2 is used for the majority of mesh data, and puts the normal, texture, bone index, and bone weight data together with each vertex in chunks like so (each line is 16 bytes):

VertX   VertY   VertZ   Weight
NormX NormY NormZ BoneIndex? [ChunkEnd]
TexX	   TexY    1.0     Connection
00000043 00000043 00000043 00000043


(ChunkEnd explained in a second)

The texture coordinates are always followed by a 0000803f, and then either a 00 or 01. This is simply connection data; polygons are connected in order for vertices (i-1,i,i+1) except when the connection data for i+1 is 01. (Vertices with 01 as connection data always come in pairs.)

> Do you mean mutiple vertex share same uv coordinate data here?

Each chunk simply ends with 00000043 00000043 00000043 00000043.

> It changes a lot in this part,not always 00000043

It would be nice and simple if it stuck to this format, but when multiple bone weights are defined per vertex, suddenly the chunks have multiple vertex/normal line pairs, like so:

VertLine
NrmLine
[VertLine
NrmLine]...
TexLine
(Terminator)

In this case, the vertices and normals are actually different in each line pair. This is really bizarre, but looking at the weight data it's apparent that they always add up to one for each chunk. So, the different vertices and normals must somehow be relational to the bones they reference. From what I can tell from tweaking these positions, each vertex position is actually local to the bone referenced, using the bone's local coordinate space as well; this was obvious since modifying the x value of each coordinate resulted in different movements in world space. This is pretty much verified if you try to read the verts as being in world space, as you end up with a mass that's twisted and curled in on itself around the origin:

Finally, ChunkEnd simply notes the end of the vert/normal pairs in each chunk; it is 80 on the last pair, otherwise it is 00.

The complete header for this type of object is shorter than the first:

01010001 DataType xx800000 00403E30 12040000 yy000000

xx is presumably the same as in the header for the first object type (whatever it is).

> xx likely uv coordnate numbers in this chunck, but have no idea about yy[/quote]
yy, instead of 0F or 0E, is either 00 or 01.



Great job,,i'm glad someone is still digging SC3's models:)
## Post #8
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2011-01-18T13:31:55+00:00
- Post Title: Soul Calibur 3  Modding

As far as I can remember, the struct of the mesh chunk ??010001 ??80???? is like this

```
  byte          numData
  byte          ukn02         //01
  byte          ukn03         //00
  byte          ukn04         //01
  struct Data {
    byte        DataType      //1 = UV, 3 = coordinate, 4 = normal
    byte        Const0x80
    byte        DataCount
    byte        BytesPerData  //0x60 = 4-bytes, 0x64 = 8-bytes, 68 = 12-bytes, 0x6C = 16-bytes
    <Data>
  }
}
```


and the coordinates are base one bone reference. You need to use "matrix palette skinning" to transform the coordinate back to the proper position(I was stuck on this)!
Unfortunately, I lost 90% of work on this game, so I can't help!

a picture for your reference:


Clipboard01.jpg (148.51 KiB) Viewed 1000 times
## Post #9
- Username: falconcool
- Rank: veteran
- Number of posts: 105
- Joined date: Tue Jun 16, 2009 11:41 am
- Post datetime: 2011-01-19T23:33:30+00:00
- Post Title: Soul Calibur 3  Modding

The texture coordinates are always followed by a 0000803f, and then either a 00 or 01. This is simply connection data; polygons are connected in order for vertices (i-1,i,i+1) except when the connection data for i+1 is 01. (Vertices with 01 as connection data always come in pairs.)

> Do you mean mutiple vertex share same uv coordinate data here?

I've extracted vertices data,but can't figure out how to draw polygons.
here is an example picture,would you please draw triangle to show how these vertices with 01 marked
been connected,TYVM
## Post #10
- Username: pringerx
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Fri Jan 07, 2011 2:18 am
- Post datetime: 2011-01-20T21:53:16+00:00
- Post Title: Soul Calibur 3  Modding

> Reply from falconcool
>
> Do you mean mutiple vertex share same uv coordinate data here?
The chunks with "multiple" vertices in fact represent one single vertex; each coordinate is local to the bone indexed in the second line (with the normal data). I have no idea why it's stored this way though... 

So for the polygons, just connect them as described previously: For any vertex i, make a polygon with vertices i-1 and i+1 except when the connection data for vertex i+1 is set to 1.  Actually, this isn't the exact solution, since half of the polys come out with their normals reversed, but this is easily correctable in pretty much any modelling software so it's pretty low priority 

> Reply from falconcool
>
> It changes a lot in this part,not always 00000043
I totally forgot about that when I was writing it.  That's another thing I haven't figured out yet.

> Reply from fatduck
>
> Unfortunately, I lost 90% of work on this game, so I can't help!
That sucks... it looks like you were really close, too!

> Reply from fatduck
>
> and the coordinates are base one bone reference.
Could you clarify this?  I'm currently stumped by how the mesh data references the bones, both in this type of mesh data and the other.

As for the matrix transformations, I understand how they work in principle but I can't figure out how (what I'm assuming are) the matrices are stored in the bone data.  There doesn't seem to be any pattern consistent with how matrix transforms are normally represented, and then there are these totally random (extremely large) numbers thrown in sometimes...

Also, while I haven't really made any progress with decoding the joint data, I did find some other useful data in the model files (mostly pointers to where various groups of data are located), which makes it possible to simply process the whole model file at once.  I'll post that as soon as I get the info organized...

Edit:
OK, the model file header looks like this:
090E1C0B 00000201 aa00bb00 cccc0000

aa - unknown
bb - the total bone count for the model (odd that it's up here, but handy)
cccc - unknown integer, though it seems to correlate directly to the file size (probably unimportant)

- After that, 16 empty bytes.
- Then, a 4-byte offset where the joint information begins (yay, useful!)
- Then another 4-byte offset to the (unknown) information immediately following the joints
- Then 00010000
- Then another 4-byte offset to some more unknown data near the beginning of the file.

Then there are several more offsets like these, all pointing to various data sets in the file, which seem unimportant.  I also found that the list before the model data points to every individual mesh piece in the file.
## Post #11
- Username: zombiemkii
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Sat Sep 05, 2009 4:40 am
- Post datetime: 2011-09-13T12:28:02+00:00
- Post Title: Soul Calibur 3  Modding

:?:Any progress ?
## Post #12
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-08T14:00:34+00:00
- Post Title: Soul Calibur 3  Modding

Hi guys! Always was a fan of Soul Calibur series. So, decided to try this awful and complex format. I already obtained some meshes, and tried to import bones. Almost all, is understandable here, but for some reason - I can get proper skeleton. Here's the pic



Need some help now, maybe someone could help me with this  Here couple samples and script to import bones into 3ds max

[https://www.mediafire.com/?rg2z78g8im6cnbd](https://www.mediafire.com/?rg2z78g8im6cnbd)
## Post #13
- Username: mariokart64n
- Rank: ultra-veteran
- Number of posts: 586
- Joined date: Sun Jun 05, 2005 7:00 pm
- Post datetime: 2014-09-08T17:09:22+00:00
- Post Title: Soul Calibur 3  Modding

Lol i figured out the skeleton format last month then was struggling to parse the mesh data... 

... And omg here is the mesh format lol

I'd complete my importer but looks like all the info is here now  

good luck guys
## Post #14
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2014-09-08T20:23:35+00:00
- Post Title: Soul Calibur 3  Modding

zaramot, I had a quick look on your maxscript.
your bone rotation is not correct!!!

> c31 = ReadFloat f*3.0; c32 = ReadFloat f*5; c33 = ReadFloat f*4.0; 
>
> ...
>
> tfm = (quat c31 c32 c33 -1) as matrix3

it should be:
c31 = ReadFloat f*360 ; c32 = ReadFloat f*360 ; c33 = ReadFloat f*360; 
...
tfm =  (eulerToQuat (eulerAngles c31 c32 c33) ) as matrix3
## Post #15
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-08T20:34:35+00:00
- Post Title: Soul Calibur 3  Modding

Thanks a lot Fatduck! How could I miss this, I knew rotation was wrong, but I couldn't even imagine they were euler
## Post #16
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-09T08:10:57+00:00
- Post Title: Re: Soul Calibur 3  Modding

Some news about progress. So, now I'm importing meshes, all geometry data with bones at once. But, as you see all parts are lying on the floor, now we moved to next part of model import  As sir Fatduck said, the game is using "matrix palette skinning" so we need to figure out this somehow  I'm asking about help with this, how it's implemented? What should we do, to transform vertices to proper position?
## Post #17
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2014-09-09T12:46:40+00:00
- Post Title: Re: Soul Calibur 3  Modding

I don't have any file or 3dsmax atm so I can't check the BoneID things.
But the use of "matrix palette skinning" is to minimum the use of bones.
So each mesh part possibly had it's own bones group!
Try to see if you can found any "Mesh info" of different parts!?
## Post #18
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-10T13:42:34+00:00
- Post Title: Re: Soul Calibur 3  Modding

Don't know about "Mesh info" and it's own bone group for each mesh, can't find anything like a bone-map inside model file. But it would be much more easier if we knew how to turn bone indices like this 0x54/0x58 to correct ones (for example 0x54 it's bone index 4). Then, I'm sure we could find bone groups, if only game is using them
## Post #19
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-11T08:52:40+00:00
- Post Title: Re: Soul Calibur 3  Modding

Hi guys! I have progress with skinned meshes   SC3 is using bonemap, and those bone id's is almost solved now
[SC__3.jpg](https://xentaxbackup.github.io/file/7797_SC__3.jpg)
## Post #20
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2014-09-13T07:23:00+00:00
- Post Title: Re: Soul Calibur 3  Modding

Here is some info for the file format:

```
  dword                 Resource_ID             //0x0B1C0E09
  word                  unknowm                 //Ver Minor ?
  word                  Version                 //0x102
  word                  num_Bone_Group
  word                  num_Bone
  dword                 offset_0_4              //I name it as offset row 0 column 4
  dword                 offset_1_1
  dword                 offset_1_2
  ...
  dword                 offset_4_2
  dword                 offset_4_3
}

Max bones for skinning is 32
```


It seems like there are 2 pieces of "Mesh info" in the .unk format!
your way to the Bones-Group /Bone-map(whatever you call it) seem to be missing something.
And you have no way to map the geometry-part with these bone-map! Right?

Your way:
offset_3_1 is offset_Bone_Map

```
  byte                  ID
  byte                  Count
  byte                  Extra1
  byte                  Extra2
  <data>
)
struct Bone_Map_block {
  dword                 Unknown
  dword                 Unknown
  dword                 Offset
  dword                 Offset
  struct Bone_Map_Info {
    struct Info {                               //Loop until Block-end
      byte              ID                      //1 = Block-end, 7 = Bone indices, 5 = group? without offset data
      byte              Count
      byte              Extra1
      byte              Extra2
      *dword            offset_data
    }
  }
}
```

eg: in sig2.unk(Total 23 info) first bone-map info @ 0x770
Type 5 ??
Type 1 block end: 0x7C8
Type 4 offset:0xF0C
Type 7 28 bone indices(use up 32 byte)
Type 6 offset:0x13C0
Type 8 offset:0x1400
Type 9 offset:0x1440
Type B offset:0x2580

Second bone-map info @ 0x7C8
Type 5 ??
Type 1 block end: 0x7FC
Type 4 offset:0xF38
Type 6 offset:0x1450
Type 8 offset:0x1490
Type 9 offset:0x14D0
Type B offset:0x2600
But then you don't know the bone-map for this one? 


Now my way:

```
struct Group_Offset {
  dword                 offset_Bone_Info
}
struct Bone_Info {
  byte                  Type
  byte                  num_ofs
  byte                  unknown
  byte                  Index                   // for type 0, this is bone index, type 1  act as num_bone_index
  <bone_index>
  <Info_offset>
}
struct Info {
  dword                 type?
  dword                 offset
}
struct Info2 {
  byte                  type
  byte                  block_size
  byte                  unknown
  byte                  unknown
  <data>
  ...                   //until a data 0x0805 was found, the next one is offset_Mesh_List
}
struct Mesh_List {
  byte                  unknown
  byte                  unknown
  byte                  unknown
  byte                  Type                 //0x30 mesh, 0x60 end list
  dword                 offset_MeshData
  dword                 unknown
  dword                 unknown
  dword                 unknown
  dword                 unknown
  dword                 unknown
  dword                 unknown
}
```


see my log file.(Not 100% correct, something skipped)
[sig2_unk_log.rar](https://xentaxbackup.github.io/file/7804_sig2_unk_log.rar)
## Post #21
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-14T07:45:40+00:00
- Post Title: Re: Soul Calibur 3  Modding

Some news, now I'm parsing at once entire character's models, with all meshes+in correct position. But, still have issues with some parts - now I'm almost at 100% sure, some bones should be transformed in different way than others. That's why they are divided into bone-groups in skeleton section!? So, now main issue is skeleton!
[SC_3x.jpg](https://xentaxbackup.github.io/file/7809_SC_3x.jpg)
## Post #22
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2014-09-16T12:41:38+00:00
- Post Title: Re: Soul Calibur 3  Modding

I think I found the reason why some the meshes don't look right(deformed)!
It's because the bone's rotation is not right!!!



error2.jpg (159.76 KiB) Viewed 652 times



you see those meshes in red color, they should be eye-ball and the jaw
and they are kind of 90 degree rotated!

Now is the time back to basic to figure out the bones structure again!
## Post #23
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-16T14:46:23+00:00
- Post Title: Re: Soul Calibur 3  Modding

Yes,we need to figure out bone structure  All bones are divided into groups (last byte of each bone), 03 it's face, 07 chest, clavicle rolls etc. I rotated jaw and eyes, by adding to base rotation, first 3 floats in bone section! It appears those values matters, some kind of end position, or bind pose?!
[scc.jpg](https://xentaxbackup.github.io/file/7824_scc.jpg)
## Post #24
- Username: fatduck
- Rank: mega-veteran
- Number of posts: 315
- Joined date: Thu Aug 03, 2006 5:07 am
- Post datetime: 2014-09-16T19:54:34+00:00
- Post Title: Re: Soul Calibur 3  Modding

Got it right, finally.

the vertex position should be:
accumulated = pos0 * matrix0 * weight0; 
accumulated += pos1 * matrix1 * weight1; 
accumulated += pos2 * matrix2 * weight2;
...

Now my problem is tri-strip face'S direction and missing geometries(Can't found all then mesh info)

zaramot, are you still your using "offset_Bone_Map" method to get all the geometries!
[sc3.jpg](https://xentaxbackup.github.io/file/7826_sc3.jpg)
## Post #25
- Username: zaramot
- Rank: double-veteran
- Number of posts: 783
- Joined date: Wed Jan 05, 2011 7:41 pm
- Post datetime: 2014-09-18T11:35:13+00:00
- Post Title: Re: Soul Calibur 3  Modding

Last four bytes of each bone, contain info about bone groups, bone id, bone parent and first byte is often just 0, but for some bone groups - this first byte is bone-child. I think, those bone groups should be multiplied to bone child matrix,rotation or position, I think that this solve the issue.
So, for now we have two major problems:
1) Face direction, models needs more time to fix
2) Some bone groups transformation (main ones:0x07 - chest/boobs rolls/twists, 0x0B-hair)
But, despite all of this, now we have fully rigged SC3 models

Thanks A LOT to Fatduck, without his help this wouldn't be possible!
## Post #26
- Username: porimac
- Rank: VIP member
- Number of posts: 109
- Joined date: Wed Sep 08, 2010 11:46 pm
- Post datetime: 2014-09-19T16:08:52+00:00
- Post Title: Re: Soul Calibur 3  Modding

deleted
## Post #27
- Username: Doronetty
- Rank: advanced
- Number of posts: 54
- Joined date: Thu Jun 03, 2010 6:05 pm
- Post datetime: 2014-09-24T12:44:34+00:00
- Post Title: Re: Soul Calibur 3  Modding

Please make script!
P.S: Or (better) tool like Greed Xplorer with SC3 support and models converter
## Post #28
- Username: Byros
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sun Jun 12, 2016 9:10 am
- Post datetime: 2016-08-29T01:37:56+00:00
- Post Title: Re: Soul Calibur 3  Modding

This thread is absolutely great!

You can use this updated version of OLK Explorer (V 0.04), as it tries to detect additional file types
within Soulcalibur III for PlayStation 2:

[https://8wayrun.com/attachments/ps2-sc3 ... zip.46681/](https://8wayrun.com/attachments/ps2-sc3-olkexplorer-004-zip.46681/)

OLK - Container file, same as version 0.02
PKG - Package file, same as version 0.02
VMP - Most character, weapon & stage 3D models are detected.
VXT - Texture bundle (Images)
MMP- PS2 sound container.
UNK - Any other file type.

Notes:
When used for PS2 Soulcalibur II game assets, most files will be detected as .UNK just as OLK Explorer version 0.02
VMP - Detects most 3D models that contain the header (09 0E 1C), might still miss some others.
MMP - Seems to properly detect MMP sound container files among PS2 Soulcalibur II & Soulcalibur III versions. (No playback)
VXT - Seems to detect images that contain the header (03 04 04), still missing those with (02 04 04) or any other header.

It should enable to identify file types much faster within ROOT.OLK

Image files within ROOT.OLK > File 3
Stage files within ROOT.OLK > File 5
Character & weapon files within ROOT.OLK > File 7
## Post #29
- Username: duduric
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Tue Aug 09, 2016 11:08 am
- Post datetime: 2016-08-29T15:52:07+00:00
- Post Title: Re: Soul Calibur 3  Modding

Awesome... is the source code of this tool / format specification for .OLX files available somewhere?

I have been trying to parse SC3 models but I'm rather new at this and got stuck , only managing to get some random armor parts from the .vmps . The file format is very complex. I PMed zaramot and FatDuck but got no answer...   
I'll try getting back at this someday
## Post #30
- Username: Byros
- Rank: ultra-n00b
- Number of posts: 2
- Joined date: Sun Jun 12, 2016 9:10 am
- Post datetime: 2016-08-30T02:10:39+00:00
- Post Title: Re: Soul Calibur 3  Modding

I've haven't found the source code for OLK Explorer, I guess it would be most helpful.
the original coder Cypher35 is nowhere to be found 

And just as you say, the format from Soulcalibur III seems different and more
complex than the one in Soulcalibur II.

I also tried to reach via PM some members of this thread, but as of yet I haven't been successful. 

Hopefully as time goes by someone will notice, and perhaps more information will be shared regarding the format for
characters, weapons, and stages.

If I find anything on *.OLX files I'll let you know,
There also seem to be within ROOT.OLK, other still unidentified file types such as *.vtb & *.lpb
## Post #31
- Username: mariokart64n
- Rank: ultra-veteran
- Number of posts: 586
- Joined date: Sun Jun 05, 2005 7:00 pm
- Post datetime: 2020-04-17T16:04:51+00:00
- Post Title: Re: Soul Calibur 3  Modding

Sorry for the bump;

Recently I dusted off my old script for SC3 and realized alot more work was required for me to import models correctly

So I spent a week documenting as much as possible of the mesh binary so that I might have a better chance identifying the mesh info.

I created this flow charted to outline an overview of the blocks and there order presented throughout the model binary.
*The Arrows indicate a offset within a block that jumps to another block



Here is my structure for the header block;

```
	uint32	filetype;
	uint8	unk001;
	uint8	unk002;
	uint8	unk003;
	uint8	unk004;
	uint16	table1_count;
	uint16	bone_count;
	uint32	unk005;
	uint32	unk006;
	uint32	unk007;
	uint32	unk008;
	uint32	unk009;
	uint32	bone_addr;
	uint32	tex_file_addr;
	uint32	table1a_addr;
	uint32	table5_addr;
	uint32	table4_addr;
	uint32	table7_addr;
	uint32	unk016;
	uint32	table1_addr;
	uint32	table2_addr;
	uint32	table3_addr;
	uint32	table6_addr;
	}

```


To give a broader overview; table1 is the mesh table, and it does a typical thing that SC2 did which it presents mesh data as either static or skinned.
Skinned data requiring local bone indices of course which are important for deforming the mesh back to world space.

Theres a lot of ridiculous jumping from table1 to to geometry block, alot of the table subs, table1a - table1d mostly just contain a single offset to the next table.... anyways my maxscript is VERY messy lol

But here is the current script (it needs fixing)


 [maxscript]_vmp_imp__by_mariokart64n.zip
(8.61 KiB) Downloaded 46 times



I'm having 2 problems at the moment that I've been unable to resolve;
1.) direction of the mesh faces cause the mesh to have flipped cases all over
2.) for some reason the lips are distorted



*(manually corrected flipped faces to emphasize the lip issue)


I can live with the flipped face issue, but the face being distorted is a real problem, and looking at zaramot and fatducks screenshots I'm thinking my method of transforming the mesh to world space is flawed.

If anyones still interested in this game, please have a look at the script and give your thoughts

line #1205 in my maxscript shows how I'm transforming the vertices to world space, it works for everything except the lips on the face

```
tfm.row4 = vert2 / wt
tfm*=boneArray[table1a[mesh_object].indices[(bit.shift bi -2) + 1] + 1].transform
vert+= tfm.row4  * wt

```
## Post #32
- Username: Scorpio21
- Rank: ultra-n00b
- Number of posts: 1
- Joined date: Sat Apr 25, 2020 11:08 pm
- Post datetime: 2020-04-25T15:11:10+00:00
- Post Title: Re: Soul Calibur 3  Modding

nice it'll be cool if kratos was in sc3
## Post #33
- Username: JohnBarleycorn
- Rank: n00b
- Number of posts: 11
- Joined date: Sat May 30, 2015 12:42 am
- Post datetime: 2020-08-06T09:54:12+00:00
- Post Title: Re: Soul Calibur 3  Modding

You should say most of the thread continues in another section lol
Anyway i guess you fixed the problem in the end, becouse using the other plugin it gives me absolutely no issue
## Post #34
- Username: mariokart64n
- Rank: ultra-veteran
- Number of posts: 586
- Joined date: Sun Jun 05, 2005 7:00 pm
- Post datetime: 2020-08-06T11:38:19+00:00
- Post Title: Re: Soul Calibur 3  Modding

To clarify;

I had posted my findings and concerns here because I needed help with developing and fixing the script.

After several months of no response I had decided to release a second version of the script in which I attempt to "work around" specific problems and made a GUI. On my deviant art page you can find the new script and a video walk through on how individuals can import meshes themselves.
[https://www.deviantart.com/mariokart64n ... -848567537](https://www.deviantart.com/mariokart64n/art/MaxScript-Soul-Calibur-III-Model-Importer-848567537)

[](https://youtu.be/WZrS_o8tKYI)



Its worth noting that those problems I had discussed in my last post still remain, and some models may not import correctly.

Since I had posted my revised script on deviant art I have received a bit attention and was asked to share my knowledge of the SC3 mesh binary format in a different topic here;
[viewtopic.php?f=29&t=22497](https://forum.xentax.com/viewtopic.php?f=29&t=22497)


I was also asked by another person on deviant art if I could port all the girls from SC3 for them. It took me months but I had provided the models to this user, they claimed that they will release them at some point..
[https://www.deviantart.com/junk-hoes](https://www.deviantart.com/junk-hoes)
[https://www.pixiv.net/en/users/42364003/illustrations](https://www.pixiv.net/en/users/42364003/illustrations)
## Post #35
- Username: JohnBarleycorn
- Rank: n00b
- Number of posts: 11
- Joined date: Sat May 30, 2015 12:42 am
- Post datetime: 2020-08-09T07:10:19+00:00
- Post Title: Re: Soul Calibur 3  Modding

Must be in models i did not try to extract then. The only thing weird i noticed is that when i extract a model, and i collapse the edit normals, if i export the model the faces loose their smoothing group. Even if i try to reset it does not fix that. But as other games (like champions of norrath) that seems to be a common issue... Or maybe in this case there should be a different step i should do. Don't know.
## Post #36
- Username: JohnBarleycorn
- Rank: n00b
- Number of posts: 11
- Joined date: Sat May 30, 2015 12:42 am
- Post datetime: 2020-08-11T11:27:34+00:00
- Post Title: Re: Soul Calibur 3  Modding

Wait, scratch that, with the right combination of export & reimport i fixed that as well. I will put some screenshots on my deviantart page.
## Post #37
- Username: OPStellar
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Thu Nov 10, 2022 8:01 am
- Post datetime: 2022-11-10T00:08:21+00:00
- Post Title: Re: Soul Calibur 3  Modding

> Reply from mariokart64n ↑Thu Aug 06, 2020 7:38 pm at Thu Aug 06, 2020 7:38 pm
>
> 
I was also asked by another person on deviant art if I could port all the girls from SC3 for them. It took me months but I had provided the models to this user, they claimed that they will release them at some point.

They made them [available for download](https://www.deviantart.com/junk-hoes/art/MMD-Soul-Calibur-3-FEMALES-DL-859299787) (in October 2020)!
## Post #38
- Username: OPStellar
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Thu Nov 10, 2022 8:01 am
- Post datetime: 2022-11-10T00:42:16+00:00
- Post Title: Re: Soul Calibur 3  Modding

It noted that the characters it ripped included KOS-MOS, the guest character only obtainable through the Create-a-Soul feature.
I'm just looking to rip custom characters I made in SC3 so that I can work with them in a higher resolution and more portable environment than PCSX2.
How did you get it to pull the textures for the X-series equipment?

Since I'm running primarily in macOS Mojave, I've put together a basic workflow running through Wine for texture scraping, but I haven't been able to test it yet (because I would need to figure out PCSX2 in Wine since TexMod and uMod don't have Mac ports, and I don't have time to set up PCSX2 in Wine).
That aside, I'd still like to know the process for generating models that wear customized equipment sets, if possible– even if the process is entirely Windows-based.
## Post #39
- Username: OPStellar
- Rank: ultra-n00b
- Number of posts: 3
- Joined date: Thu Nov 10, 2022 8:01 am
- Post datetime: 2022-11-10T01:22:37+00:00
- Post Title: Re: Soul Calibur 3  Modding

> Reply from mariokart64n ↑Sat Apr 18, 2020 12:04 am at Sat Apr 18, 2020 12:04 am
>
> So I spent a week documenting as much as possible of the mesh binary so that I might have a better chance identifying the mesh info.
Skinned data requiring local bone indices of course which are important for deforming the mesh back to world space.

I'm having 2 problems at the moment that I've been unable to resolve;
2.) for some reason the lips are distorted

*(manually corrected flipped faces to emphasize the lip issue)
…the face being distorted is a real problem, and looking at zaramot and fatducks screenshots I'm thinking my method of transforming the mesh to world space is flawed.

This is just a hypothesis and not based on much, but I think it's worth sharing:
Since models actually have lip movements, blinking eyelids, etc. and it's only the lips that move, is it possible that the correct shapes for the lips are determined by animation data?
If my guess is accurate, then correcting the mesh shapes would be a matter of using a script to interpret the first frame from any of the respective model's animation data and apply it to the model.

However, if this is indeed the case, then the necessity for making animation data interpretable just increased.
